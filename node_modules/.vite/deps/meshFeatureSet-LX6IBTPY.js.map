{
  "version": 3,
  "sources": ["../../../../node_modules/@arcgis/core/rest/support/meshFeatureSet.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport e from\"../../Graphic.js\";import t from\"../../core/Logger.js\";import{getOrCreateMapValue as r}from\"../../core/MapUtils.js\";import o from\"../../geometry/Extent.js\";import n from\"../../geometry/Mesh.js\";import s from\"../../geometry/Point.js\";import a from\"../../geometry/SpatialReference.js\";import i from\"../../geometry/support/MeshTransform.js\";import{ServiceAssetPart as u,ServiceAsset as f}from\"../../geometry/support/meshUtils/External.js\";import{getFormatIdMimeType as c}from\"../../layers/support/infoFor3D.js\";import l from\"./FeatureSet.js\";const m=()=>t.getLogger(\"esri.rest.support.meshFeatureSet\");function p(t,r,o){const n=o.features;o.features=[],delete o.geometryType;const s=l.fromJSON(o);if(s.geometryType=\"mesh\",!o.assetMaps)return s;const i=d(r,o.assetMaps),u=t.sourceSpatialReference??a.WGS84,f=o.globalIdFieldName,{outFields:c}=t,m=null!=c&&c.length>0?g(c.includes(\"*\")?null:new Set(c)):()=>({});for(const a of n){const t=y(a,f,u,r,i);s.features.push(new e({geometry:t,attributes:m(a)}))}return s}function g(e){return({attributes:t})=>{if(!t)return{};if(!e)return t;for(const r in t)e.has(r)||delete t[r];return t}}function y(e,t,r,s,a){const i=e.attributes[t],u=a.get(i);if(null==u||!e.geometry)return null;const f=E(e,r,s),c=o.fromJSON(e.geometry);c.spatialReference=r;const l=h(e.attributes,s),m=r.isGeographic?\"local\":\"georeferenced\",p=D(u);return p?n.createWithExternalSource(f,p,{extent:c,transform:l,vertexSpace:m}):n.createIncomplete(f,{extent:c,transform:l,vertexSpace:m})}function E({attributes:e},t,{transformFieldRoles:r}){const o=e[r.originX],n=e[r.originY],a=e[r.originZ];return new s({x:o,y:n,z:a,spatialReference:t})}function h(e,{transformFieldRoles:t}){return new i({translation:[e[t.translationX],-e[t.translationZ],e[t.translationY]],rotationAxis:[e[t.rotationX],-e[t.rotationZ],e[t.rotationY]],rotationAngle:e[t.rotationDeg],scale:[e[t.scaleX],e[t.scaleZ],e[t.scaleY]]})}var S;function d(e,t){const o=new Map;for(const n of t){const t=n.parentGlobalId;if(null==t)continue;const s=n.assetName,a=n.assetType,i=n.assetHash,u=n.assetURL,f=n.conversionStatus,l=n.seqNo,p=c(a,e.supportedFormats);if(!p){m().error(\"mesh-feature-set:unknown-format\",`Service returned an asset of type ${a}, but it does not list it as a supported type`);continue}const g=r(o,t,(()=>({files:new Map})));r(g.files,s,(()=>({name:s,type:a,mimeType:p,status:M(f),parts:[]}))).parts[l]={hash:i,url:u}}return o}function D(e){const t=Array.from(e.files.values()),r=new Array;for(const o of t){if(o.status!==S.COMPLETED)return null;const e=new Array;for(const t of o.parts){if(!t)return null;e.push(new u(t.url,t.hash))}r.push(new f(o.name,o.mimeType,e))}return r}function M(e){switch(e){case\"COMPLETED\":case\"SUBMITTED\":return S.COMPLETED;case\"INPROGRESS\":return S.PENDING;default:return S.FAILED}}!function(e){e[e.FAILED=0]=\"FAILED\",e[e.PENDING=1]=\"PENDING\",e[e.COMPLETED=2]=\"COMPLETED\"}(S||(S={}));export{d as assetMapFromAssetMapsJSON,y as extractMesh,p as meshFeatureSetFromJSON};\n"],
  "mappings": "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",
  "names": ["r", "o", "n", "s", "i", "d", "f", "m", "t", "p", "g", "e"]
}

import {
  s as s5
} from "./chunk-5QK3TRYR.js";
import {
  T,
  r as r3
} from "./chunk-WDAANELG.js";
import {
  l as l3,
  o as o2
} from "./chunk-6RHMAIR4.js";
import {
  m as m3
} from "./chunk-UOIKTJMB.js";
import {
  $
} from "./chunk-VR7WVNO3.js";
import {
  ot
} from "./chunk-F54TE5DA.js";
import {
  e as e4
} from "./chunk-5YPRHJQA.js";
import {
  c as c2,
  p as p2
} from "./chunk-KW3Q5OC2.js";
import {
  c as c3,
  p as p3
} from "./chunk-MUYRQ7CH.js";
import {
  c,
  p
} from "./chunk-U6JPKU6C.js";
import {
  s as s4
} from "./chunk-AMKKU676.js";
import {
  C,
  l as l5
} from "./chunk-QBW6ZJYD.js";
import {
  m as m2,
  t as t2
} from "./chunk-S7J6OTBX.js";
import {
  f as f4,
  l as l4
} from "./chunk-CSCLMZ7J.js";
import {
  p as p4
} from "./chunk-FTURJXD3.js";
import {
  d
} from "./chunk-647CGSDX.js";
import {
  f as f3
} from "./chunk-CFIKP7ET.js";
import {
  a as a3,
  l,
  s as s2
} from "./chunk-VEAHCP5W.js";
import {
  t
} from "./chunk-HNXXFTFZ.js";
import {
  j as j2,
  l as l2,
  s as s3,
  u,
  w as w2,
  y as y4
} from "./chunk-NSXZC33R.js";
import {
  S as S2
} from "./chunk-E7HFITKU.js";
import {
  E
} from "./chunk-JJIIUFER.js";
import {
  b
} from "./chunk-LLJZCFHW.js";
import {
  y as y3
} from "./chunk-TXIL3QUC.js";
import {
  f as f2
} from "./chunk-EA74CF7B.js";
import {
  K,
  N
} from "./chunk-RTULPMO3.js";
import {
  k
} from "./chunk-IJUFAIOF.js";
import {
  p as p5
} from "./chunk-CAC7FEOV.js";
import {
  e as e3
} from "./chunk-KK4UI5LV.js";
import {
  o
} from "./chunk-NYWHVRZC.js";
import {
  y as y2
} from "./chunk-ZH4RVBER.js";
import {
  m
} from "./chunk-RS5OZZZ5.js";
import {
  j
} from "./chunk-VRHSV3YE.js";
import {
  w
} from "./chunk-66KCMKB5.js";
import {
  f,
  r as r2
} from "./chunk-F4OBDVPS.js";
import {
  g
} from "./chunk-X3IFQMC4.js";
import {
  U
} from "./chunk-WC4SPMPL.js";
import {
  S,
  e as e2,
  y
} from "./chunk-TJUEGVVG.js";
import {
  a3 as a2,
  r
} from "./chunk-GEH2VXFC.js";
import {
  e
} from "./chunk-BJY5ADVY.js";
import {
  a,
  n2 as n,
  s2 as s
} from "./chunk-YNL57W4I.js";

// ../node_modules/@arcgis/core/rest/knowledgeGraph/ProtoFeatureCollection.js
var T2;
!function(s8) {
  s8.ELEMENTUID = "ELEMENTUID", s8.TYPENAME = "TYPENAME";
}(T2 || (T2 = {}));
var m4 = [T2.ELEMENTUID, T2.TYPENAME];
var d2;
var p6;
!function(s8) {
  s8[s8.ELEMENTUID = 0] = "ELEMENTUID", s8[s8.TYPENAME = 1] = "TYPENAME";
}(d2 || (d2 = {})), function(s8) {
  s8[s8.ELEMENTUID = 0] = "ELEMENTUID", s8[s8.TYPENAME = 1] = "TYPENAME", s8[s8.FROMUID = 2] = "FROMUID", s8[s8.TOUID = 3] = "TOUID";
}(p6 || (p6 = {}));

// ../node_modules/@arcgis/core/rest/knowledgeGraph/wasmInterface/WasmSerializedLayerData.js
var e5;
var l6;
var s6;
var T3;
!function(e7) {
  e7[e7.featureResult = 0] = "featureResult", e7[e7.countResult = 1] = "countResult", e7[e7.idsResult = 2] = "idsResult";
}(e5 || (e5 = {})), function(e7) {
  e7[e7.upperLeft = 0] = "upperLeft", e7[e7.lowerLeft = 1] = "lowerLeft";
}(l6 || (l6 = {})), function(e7) {
  e7[e7.sqlTypeBigInt = 0] = "sqlTypeBigInt", e7[e7.sqlTypeBinary = 1] = "sqlTypeBinary", e7[e7.sqlTypeBit = 2] = "sqlTypeBit", e7[e7.sqlTypeChar = 3] = "sqlTypeChar", e7[e7.sqlTypeDate = 4] = "sqlTypeDate", e7[e7.sqlTypeDecimal = 5] = "sqlTypeDecimal", e7[e7.sqlTypeDouble = 6] = "sqlTypeDouble", e7[e7.sqlTypeFloat = 7] = "sqlTypeFloat", e7[e7.sqlTypeGeometry = 8] = "sqlTypeGeometry", e7[e7.sqlTypeGUID = 9] = "sqlTypeGUID", e7[e7.sqlTypeInteger = 10] = "sqlTypeInteger", e7[e7.sqlTypeLongNVarchar = 11] = "sqlTypeLongNVarchar", e7[e7.sqlTypeLongVarbinary = 12] = "sqlTypeLongVarbinary", e7[e7.sqlTypeLongVarchar = 13] = "sqlTypeLongVarchar", e7[e7.sqlTypeNChar = 14] = "sqlTypeNChar", e7[e7.sqlTypeNVarChar = 15] = "sqlTypeNVarChar", e7[e7.sqlTypeOther = 16] = "sqlTypeOther", e7[e7.sqlTypeReal = 17] = "sqlTypeReal", e7[e7.sqlTypeSmallInt = 18] = "sqlTypeSmallInt", e7[e7.sqlTypeSqlXml = 19] = "sqlTypeSqlXml", e7[e7.sqlTypeTime = 20] = "sqlTypeTime", e7[e7.sqlTypeTimestamp = 21] = "sqlTypeTimestamp", e7[e7.sqlTypeTimestamp2 = 22] = "sqlTypeTimestamp2", e7[e7.sqlTypeTinyInt = 23] = "sqlTypeTinyInt", e7[e7.sqlTypeVarbinary = 24] = "sqlTypeVarbinary", e7[e7.sqlTypeVarchar = 25] = "sqlTypeVarchar";
}(s6 || (s6 = {})), function(e7) {
  e7[e7.OID_ARRAY = 0] = "OID_ARRAY", e7[e7.GLOBALID_ARRAY = 1] = "GLOBALID_ARRAY", e7[e7.STRING_ARRAY = 2] = "STRING_ARRAY", e7[e7.IDENTIFIER_ARRAY = 3] = "IDENTIFIER_ARRAY";
}(T3 || (T3 = {}));

// ../node_modules/@arcgis/core/layers/knowledgeGraph/supportUtils.js
function w3(e7) {
  if (!e7.spatialReference.isWGS84) throw new s("knowledge-graph:layer-support-utils", "The extentToInBoundsRings function only supports WGS84 spatial references.");
  return e7.clone().normalize().map((e8) => [[e8.xmin, e8.ymin], [e8.xmin, e8.ymax], [e8.xmax, e8.ymax], [e8.xmax, e8.ymin], [e8.xmin, e8.ymin]]);
}
async function h2(e7, t5) {
  var _a, _b;
  const r5 = [], n2 = /* @__PURE__ */ new Map(), s8 = [];
  if ((_a = t5.dataModel) == null ? void 0 : _a.relationshipTypes) for (const i3 of t5.dataModel.relationshipTypes) i3.name && n2.set(i3.name, []);
  for (const i3 of e7) n2.has(i3.typeName) && ((_b = n2.get(i3.typeName)) == null ? void 0 : _b.push(i3.id));
  for (const [o4, l8] of n2) {
    if (l8.length < 1) continue;
    const e8 = new s5({ openCypherQuery: `MATCH (n)-[r:${o4}]->(m) WHERE id(r) in $ids RETURN id(n), labels(n)[0], id(m), labels(m)[0]`, bindParameters: { ids: l8 } });
    s8.push(T(t5, e8).then(async (e9) => {
      const t6 = e9.resultRowsStream.getReader();
      for (; ; ) {
        const { done: e10, value: n3 } = await t6.read();
        if (e10) break;
        for (const t7 of n3) r5.push({ id: t7[0], typeName: t7[1] }), r5.push({ id: t7[2], typeName: t7[3] });
      }
    }));
  }
  return await Promise.all(s8), r5;
}
async function T4(e7, t5) {
  t5 ?? (t5 = false);
  const r5 = { generateAllSublayers: t5, namedTypeDefinitions: /* @__PURE__ */ new Map() };
  return await I(e7).then((e8) => {
    D(e8, r5);
  }), r5;
}
async function E3(e7) {
  const r5 = await r3(), n2 = new r5.MapOfObjectIdentifierSets();
  M(n2, r5, e7);
  const s8 = new r5.MapOfObjectIdentifierSetsEncoder();
  try {
    s8.set_map_of_identifier_sets(n2), s8.encode();
    const e8 = s8.get_encoding_result();
    if (0 !== e8.error.error_code) throw new s("knowledge-graph:layer-support-utils", e8.error.error_message);
    const r6 = structuredClone(e8.get_byte_buffer());
    return s8.delete(), r6;
  } finally {
    n2.delete();
  }
}
function M(e7, t5, r5) {
  for (const [n2, s8] of r5.namedTypeDefinitions) {
    if (!s8.members || s8.useAllData) continue;
    const r6 = s8.members.keys(), i3 = new t5.GlobalIdArray(), a4 = new t5.ObjectIdentifierSet();
    for (const e8 of r6) i3.add_globalid(e8);
    a4.set_globalid_array(i3), i3.delete(), e7.put_identifier_set(n2, a4), a4.delete();
  }
  return e7;
}
async function I(t5) {
  const r5 = await U(t5, { responseType: "array-buffer" }), n2 = await r5.data;
  return A(new Uint8Array(n2));
}
async function A(e7) {
  const r5 = new (await r3()).MapOfObjectIdentifierSetsDecoder(), n2 = r5.decode(new Uint8Array(e7)), s8 = /* @__PURE__ */ new Map();
  if (0 !== n2.error_code) throw new s("knowledge-graph:layer-support-utils", n2.error_message);
  const i3 = r5.get_map_of_identifier_sets(), a4 = i3.keys, o4 = a4.size();
  for (let l8 = 0; l8 < o4; l8++) {
    const e8 = a4.get(l8), r6 = i3.query_identifier_set(e8), n3 = [];
    if (r6.id_array_type.value === T3.GLOBALID_ARRAY) {
      const e9 = r6.get_globalid_array(), t5 = e9.count();
      for (let r7 = 0; r7 < t5; r7++) n3.push(e9.get_globalid_at(r7));
    } else {
      if (r6.id_array_type.value !== T3.IDENTIFIER_ARRAY) throw new s("knowledge-graph:layer-support-utils", "Tried to encode an unexpected ID Array type.");
      {
        const e9 = r6.get_identifier_array(), t5 = e9.count();
        for (let r7 = 0; r7 < t5; r7++) n3.push(e9.get_identifier_at(r7).toString());
      }
    }
    s8.set(e8, n3);
  }
  return r5.delete(), s8;
}
function D(e7, t5) {
  for (const [n2, s8] of e7) {
    const e8 = r(t5.namedTypeDefinitions, n2, () => ({ useAllData: false, members: /* @__PURE__ */ new Map() }));
    for (const t6 of s8) e8.members.has(t6) || e8.members.set(t6, { id: t6 });
  }
  return t5;
}

// ../node_modules/@arcgis/core/layers/knowledgeGraph/SessionMemoryStorage.js
var i2 = "ESRI__DESTINATION_ID";
var s7 = "ESRI__ORIGIN_ID";
var o3 = class _o {
  constructor() {
    this._featureLookup = /* @__PURE__ */ new Map();
  }
  static getInstance() {
    return _o.instance || (_o.instance = new _o()), _o.instance;
  }
  static resetInstance() {
    _o.instance && (_o.instance = null);
  }
  deleteFromStore(e7) {
    e7.forEach((e8) => {
      this._featureLookup.delete(e8);
    });
  }
  readFromStoreByList(e7) {
    const t5 = [];
    return e7.forEach((e8) => {
      const r5 = this.readFromStoreById(e8);
      r5 && t5.push(r5);
    }), t5;
  }
  readFromStoreById(e7) {
    return this._featureLookup.get(e7) ?? null;
  }
  writeToStore(o4, n2, p8) {
    const a4 = [];
    return o4.forEach((o5) => {
      if (!(o5 == null ? void 0 : o5.id)) return;
      o5.properties || (o5.properties = []);
      let u2, c5 = null;
      if (p8 && o5.properties[p8] && (c5 = ot(o5.properties[p8])), "originId" in o5 && "destinationId" in o5 && (o5.properties[s7] = o5.originId, o5.properties[i2] = o5.destinationId), o5.properties[n2] = o5.id, o5.id && this._featureLookup.has(o5.id) && this._featureLookup.get(o5.id).attributes) {
        const e7 = this._featureLookup.get(o5.id), i3 = JSON.parse(JSON.stringify(Object.assign(e7.attributes, o5.properties)));
        p8 && o5.properties[p8] && (i3[p8] = y2(o5.properties[p8])), u2 = new e4(c5 ? JSON.parse(JSON.stringify(c5)) : (e7 == null ? void 0 : e7.geometry) ? JSON.parse(JSON.stringify(e7.geometry)) : null, i3, null, o5.properties[n2]);
      } else u2 = new e4(c5 ? JSON.parse(JSON.stringify(c5)) : null, o5.properties, null, o5.properties[n2]);
      this._featureLookup.set(o5.id, u2), a4.push(u2);
    }), a4;
  }
};

// ../node_modules/@arcgis/core/layers/knowledgeGraph/KnowledgeGraphLayerDataManager.js
var w4 = "ESRI__ID";
var b2 = "ESRI__ORIGIN_ID";
var T5 = "ESRI__DESTINATION_ID";
var D2 = "ESRI__LAYOUT_GEOMETRY";
var I2 = "ESRI__AGGREGATION_COUNT";
var M2 = class extends S {
  constructor(e7) {
    var _a, _b, _c;
    super(e7), this._processingCacheUpdatesLookup = /* @__PURE__ */ new Map(), this.knowledgeGraph = null, this.inclusionModeDefinition = { generateAllSublayers: true, namedTypeDefinitions: /* @__PURE__ */ new Map() }, this.entityTypeNames = /* @__PURE__ */ new Set(), this.relationshipTypeNames = /* @__PURE__ */ new Set(), this.geographicLookup = /* @__PURE__ */ new Map(), this.sublayerCaches = /* @__PURE__ */ new Map(), this.nodeConnectionsLookup = /* @__PURE__ */ new Map(), this.relationshipConnectionsLookup = /* @__PURE__ */ new Map(), this.memberIdTypeLookup = /* @__PURE__ */ new Map();
    const t5 = /* @__PURE__ */ new Map();
    (_a = e7.knowledgeGraph.dataModel.entityTypes) == null ? void 0 : _a.forEach((i3) => {
      var _a2, _b2;
      i3.name && (t5.set(i3.name, "entity"), this._processingCacheUpdatesLookup.set(i3.name, []), e7.inclusionModeDefinition && !((_a2 = e7.inclusionModeDefinition) == null ? void 0 : _a2.generateAllSublayers) || this.entityTypeNames.add(i3.name), (_b2 = i3.properties) == null ? void 0 : _b2.forEach((e8) => {
        e8.geometryType && "esriGeometryNull" !== e8.geometryType && this.geographicLookup.set(i3.name, { name: e8.name ?? "", geometryType: e8.geometryType });
      }));
    }), (_b = e7.knowledgeGraph.dataModel.relationshipTypes) == null ? void 0 : _b.forEach((i3) => {
      var _a2, _b2;
      i3.name && (t5.set(i3.name, "relationship"), this._processingCacheUpdatesLookup.set(i3.name, []), e7.inclusionModeDefinition && !((_a2 = e7.inclusionModeDefinition) == null ? void 0 : _a2.generateAllSublayers) || this.relationshipTypeNames.add(i3.name), (_b2 = i3.properties) == null ? void 0 : _b2.forEach((e8) => {
        e8.geometryType && "esriGeometryNull" !== e8.geometryType && this.geographicLookup.set(i3.name, { name: e8.name ?? "", geometryType: e8.geometryType });
      }));
    }), (_c = e7.inclusionModeDefinition) == null ? void 0 : _c.namedTypeDefinitions.forEach((i3, s8) => {
      var _a2, _b2;
      if ("entity" === t5.get(s8)) this.entityTypeNames.add(s8);
      else {
        if ("relationship" !== t5.get(s8)) return n.getLogger(this).warn(`A named type, ${s8}, was in the inclusion list that wasn't in the data model and will be removed`), void ((_a2 = e7.inclusionModeDefinition) == null ? void 0 : _a2.namedTypeDefinitions.delete(s8));
        this.relationshipTypeNames.add(s8);
      }
      const r5 = /* @__PURE__ */ new Map();
      (_b2 = i3.members) == null ? void 0 : _b2.forEach((e8) => {
        r(this.memberIdTypeLookup, e8.id, () => /* @__PURE__ */ new Set()).add(s8);
        const t6 = this.getById(e8.id);
        t6 && r5.set(e8.id, t6);
      }), this.sublayerCaches.set(s8, r5);
    });
  }
  addToLayer(e7) {
    e7.forEach(({ typeName: e8, id: t5 }) => {
      if (!this.inclusionModeDefinition) throw new s("knowledge-graph:layer-data-manager", "You cannot add to a layer's exclusion list if it was not created with an exclusion list originally");
      if (this.inclusionModeDefinition.namedTypeDefinitions.has(e8)) {
        if (this.inclusionModeDefinition.namedTypeDefinitions.has(e8)) {
          const i3 = this.inclusionModeDefinition.namedTypeDefinitions.get(e8);
          i3.members || (i3.members = /* @__PURE__ */ new Map()), i3.members.set(t5, { id: t5 }), r(this.memberIdTypeLookup, t5, () => /* @__PURE__ */ new Set()).add(e8);
        }
      } else {
        const i3 = /* @__PURE__ */ new Map();
        i3.set(t5, { id: t5 }), this.inclusionModeDefinition.namedTypeDefinitions.set(e8, { useAllData: false, members: i3 }), r(this.memberIdTypeLookup, t5, () => /* @__PURE__ */ new Set()).add(e8);
      }
    });
  }
  getById(e7) {
    return o3.getInstance().readFromStoreById(e7);
  }
  async getData(e7, t5, i3) {
    var _a, _b;
    if (t5.objectType.name && ((_a = this.inclusionModeDefinition) == null ? void 0 : _a.namedTypeDefinitions) && this.inclusionModeDefinition.namedTypeDefinitions.size > 0 && !this.inclusionModeDefinition.namedTypeDefinitions.has(t5.objectType.name)) return [];
    let n2;
    if (n2 = e7 || new b({ where: "1=1", outFields: ["*"] }), "link-chart" === t5.parentCompositeLayer.type) {
      const e8 = t5.parentCompositeLayer, i4 = this._processingCacheUpdatesLookup.get(t5.objectType.name ?? ""), o4 = n2.outFields;
      o4 && 1 === o4.length && o4[0] === w4 && "1=1" === n2.where || await Promise.all(i4 ?? []);
      const s8 = this.sublayerCaches.has(t5.objectType.name ?? "") ? Array.from((_b = this.sublayerCaches.get(t5.objectType.name)) == null ? void 0 : _b.values()) : [], r5 = [];
      return s8.forEach((i5) => {
        this.relationshipTypeNames.has(t5.objectType.name) ? i5.geometry = e8.relationshipLinkChartDiagramLookup.get(i5.attributes[t5.objectIdField]) : i5.geometry = e8.entityLinkChartDiagramLookup.get(i5.attributes[t5.objectIdField]), i5.attributes[D2] = i5.geometry, r5.push(i5);
      }), r5;
    }
    return this.retrieveDataFromService(n2, t5, i3);
  }
  async getConnectedRecordIds(e7, t5) {
    const i3 = [];
    let o4 = "";
    const s8 = [], r5 = /* @__PURE__ */ new Map();
    if (e7.forEach((e8) => {
      var _a;
      if (this.memberIdTypeLookup.has(e8)) for (const t6 of this.memberIdTypeLookup.get(e8)) {
        if (!this.entityTypeNames.has(t6)) return;
        r5.has(t6) ? (_a = r5.get(t6)) == null ? void 0 : _a.push(e8) : r5.set(t6, [e8]);
      }
    }), t5 && 0 !== (t5 == null ? void 0 : t5.length)) {
      for (const e8 of t5) o4 = o4 + e8 + "|";
      o4 = o4.slice(0, -1);
    }
    return r5.forEach((e8, r6) => {
      let a4;
      a4 = t5 && 0 !== (t5 == null ? void 0 : t5.length) ? `MATCH (n:${r6})-[r:${o4}]-(m) WHERE id(n) IN $ids RETURN id(r), type(r), id(m), labels(m)[0]` : `MATCH (n:${r6})-[r]-(m) WHERE id(n) IN $ids RETURN id(r), type(r), id(m), labels(m)[0]`;
      const p8 = new Promise((t6) => {
        (async () => {
          const t7 = (await T(this.knowledgeGraph, new s5({ openCypherQuery: a4, bindParameters: { ids: e8 } }))).resultRowsStream.getReader();
          try {
            for (; ; ) {
              const { done: e9, value: n2 } = await t7.read();
              if (e9) break;
              for (let t8 = 0; t8 < n2.length; t8++) {
                const e10 = n2[t8];
                i3.push({ id: e10[0], typeName: e10[1] }), i3.push({ id: e10[2], typeName: e10[3] });
              }
            }
          } catch (o5) {
            if ("AbortError" !== o5.name) throw o5;
            n.getLogger(this).info("Request aborted as expected");
          }
        })().then(() => {
          t6();
        });
      });
      s8.push(p8);
    }), this.refreshCacheContent(), await Promise.all(s8), i3;
  }
  async getAttachedRelationships(e7, t5) {
    const i3 = [], o4 = "MATCH (n)-[r]->(m) WHERE id(n) IN $nodeIds AND id(m) in $nodeIds AND NOT id(r) IN $relationshipExclusionIds return id(r), type(r)", s8 = (await T(this.knowledgeGraph, new s5({ openCypherQuery: o4, bindParameters: { nodeIds: e7, relationshipExclusionIds: t5 } }))).resultRowsStream.getReader();
    try {
      for (; ; ) {
        const { done: e8, value: t6 } = await s8.read();
        if (e8) break;
        for (let n2 = 0; n2 < t6.length; n2++) {
          const e9 = t6[n2];
          i3.push({ id: e9[0], typeName: e9[1] });
        }
      }
    } catch (r5) {
      if ("AbortError" !== r5.name) throw r5;
      n.getLogger(this).info("Request aborted as expected");
    }
    return i3;
  }
  async refreshCacheContent(e7, t5, n2, s8 = true) {
    var _a, _b, _c, _d, _e, _f, _g;
    const r5 = o3.getInstance(), a4 = [], p8 = /* @__PURE__ */ new Map(), d4 = /* @__PURE__ */ new Map();
    (_a = this.knowledgeGraph.dataModel.entityTypes) == null ? void 0 : _a.forEach((e8) => {
      e8.name && d4.set(e8.name, e8);
    }), (_b = this.knowledgeGraph.dataModel.relationshipTypes) == null ? void 0 : _b.forEach((e8) => {
      e8.name && d4.set(e8.name, e8);
    }), e7 || this.inclusionModeDefinition ? e7 ? e7.forEach((e8) => {
      var _a2;
      if (this.memberIdTypeLookup.has(e8)) for (const t6 of this.memberIdTypeLookup.get(e8)) p8.has(t6) ? (_a2 = p8.get(t6)) == null ? void 0 : _a2.push(e8) : p8.set(t6, [e8]);
    }) : (_d = (_c = this.inclusionModeDefinition) == null ? void 0 : _c.namedTypeDefinitions) == null ? void 0 : _d.forEach((e8, t6) => {
      e8.useAllData ? p8.set(t6, null) : e8.members && e8.members.forEach((e9) => {
        var _a2;
        p8.has(t6) && null !== p8.get(t6) ? (_a2 = p8.get(t6)) == null ? void 0 : _a2.push(e9.id) : p8.set(t6, [e9.id]);
      });
    }) : ((_e = this.knowledgeGraph.dataModel.entityTypes) == null ? void 0 : _e.forEach((e8) => {
      e8.name && p8.set(e8.name, null);
    }), (_f = this.knowledgeGraph.dataModel.entityTypes) == null ? void 0 : _f.forEach((e8) => {
      e8.name && p8.set(e8.name, null);
    }));
    for (const [m5, l8] of p8) {
      const e8 = new Promise((e9) => {
        const a5 = async () => {
          var _a2, _b2, _c2, _d2, _e2, _f2, _g2;
          const e10 = /* @__PURE__ */ new Set(), a6 = [];
          let p9, h3 = "", c5 = false;
          if (t5 || ((_b2 = (_a2 = d4.get(m5)) == null ? void 0 : _a2.properties) == null ? void 0 : _b2.forEach((t6) => {
            t6.name && e10.add(t6.name);
          })), n2 && this.geographicLookup.has(m5)) {
            const t6 = (_c2 = this.geographicLookup.get(m5)) == null ? void 0 : _c2.name;
            t6 && e10.add(t6);
          }
          if (this.entityTypeNames.has(m5)) h3 = `MATCH (n:${m5}) ${l8 ? "WHERE id(n) IN $ids " : ""}return ID(n)`, e10.forEach((e11) => {
            h3 += `, n.${e11}`, a6.push(e11);
          });
          else {
            if (!this.relationshipTypeNames.has(m5)) throw new s("knowledge-graph:layer-data-manager", `The graph type of ${m5} could not be determined. Was this type set in the KG data model and inclusion definition?`);
            c5 = true, h3 = `MATCH ()-[n:${m5}]->() ${l8 ? "WHERE id(n) IN $ids " : ""}return ID(n), id(startNode(n)), id(endNode(n))`, e10.forEach((e11) => {
              h3 += `, n.${e11}`, a6.push(e11);
            });
          }
          p9 = new s5(l8 ? { openCypherQuery: h3, bindParameters: { ids: l8 } } : { openCypherQuery: h3 });
          const f5 = (await T(this.knowledgeGraph, p9)).resultRowsStream.getReader();
          for (; ; ) {
            const { done: e11, value: t6 } = await f5.read();
            if (e11) break;
            const i3 = [];
            for (let s9 = 0; s9 < t6.length; s9++) {
              const e12 = t6[s9];
              let n4 = 0, r6 = 0;
              const p11 = { properties: {} };
              for (p11.id = e12[n4], n4++, r6++, c5 && (p11.originId = e12[n4], n4++, r6++, p11.destinationId = e12[n4], n4++, r6++, r(this.nodeConnectionsLookup, p11.originId, () => /* @__PURE__ */ new Set()).add(p11.id), r(this.nodeConnectionsLookup, p11.destinationId, () => /* @__PURE__ */ new Set()).add(p11.id), r(this.relationshipConnectionsLookup, p11.id, () => [p11.originId, p11.destinationId])); n4 < e12.length; n4++) p11.properties[a6[n4 - r6]] = e12[n4];
              i3.push(p11);
            }
            const n3 = r5.writeToStore(i3, w4, (_d2 = this.geographicLookup.get(m5)) == null ? void 0 : _d2.name);
            this.sublayerCaches.has(m5) || this.sublayerCaches.set(m5, /* @__PURE__ */ new Map()), s8 && !((_e2 = this.inclusionModeDefinition) == null ? void 0 : _e2.namedTypeDefinitions.has(m5)) && ((_f2 = this.inclusionModeDefinition) == null ? void 0 : _f2.namedTypeDefinitions.set(m5, { useAllData: false, members: /* @__PURE__ */ new Map() })), s8 && !((_g2 = this.inclusionModeDefinition) == null ? void 0 : _g2.namedTypeDefinitions.get(m5).members) && (this.inclusionModeDefinition.namedTypeDefinitions.get(m5).members = /* @__PURE__ */ new Map());
            const p10 = this.sublayerCaches.get(m5);
            n3.forEach((e12) => {
              var _a3, _b3;
              p10 == null ? void 0 : p10.set(e12.attributes[w4], e12), s8 && !((_a3 = this.inclusionModeDefinition) == null ? void 0 : _a3.namedTypeDefinitions.get(m5).members.has(e12.attributes[w4])) && ((_b3 = this.inclusionModeDefinition) == null ? void 0 : _b3.namedTypeDefinitions.get(m5).members.set(e12.attributes[w4], { id: e12.attributes[w4] }), r(this.memberIdTypeLookup, e12.attributes[w4], () => /* @__PURE__ */ new Set()).add(m5));
            });
          }
        };
        a5().then(() => {
          e9(null);
        });
      });
      a4.push(e8), (_g = this._processingCacheUpdatesLookup.get(m5)) == null ? void 0 : _g.push(e8);
    }
    await Promise.all(a4);
  }
  removeFromLayer(e7) {
    var _a, _b, _c;
    const t5 = /* @__PURE__ */ new Set(), i3 = new Set(e7.map((e8) => e8.id));
    for (const n2 of e7) t5.add(n2.typeName), 1 === ((_a = this.memberIdTypeLookup.get(n2.id)) == null ? void 0 : _a.size) ? this.memberIdTypeLookup.delete(n2.id) : (_b = this.memberIdTypeLookup.get(n2.id)) == null ? void 0 : _b.delete(n2.typeName), (_c = this.inclusionModeDefinition) == null ? void 0 : _c.namedTypeDefinitions.forEach((e8, t6) => {
      var _a2;
      t6 === n2.typeName && ((_a2 = e8.members) == null ? void 0 : _a2.has(n2.id)) && e8.members.delete(n2.id);
    });
    t5.forEach((e8) => {
      var _a2;
      (_a2 = this.sublayerCaches.get(e8)) == null ? void 0 : _a2.forEach((t6, n2) => {
        var _a3;
        i3.has(n2) && ((_a3 = this.sublayerCaches.get(e8)) == null ? void 0 : _a3.delete(n2));
      });
    });
  }
  async retrieveDataFromService(e7, t5, n2) {
    var _a, _b, _c, _d, _e, _f, _g, _h, _i, _j, _k, _l, _m, _n, _o, _p, _q;
    const o4 = o3.getInstance(), r5 = /* @__PURE__ */ new Set(), a4 = [];
    let f5, b3 = "", T6 = [];
    const D3 = "relationship" === t5.graphType, I3 = (_c = (_b = (_a = this.inclusionModeDefinition) == null ? void 0 : _a.namedTypeDefinitions) == null ? void 0 : _b.get(t5.objectType.name)) == null ? void 0 : _c.useAllData, M3 = t5.parentCompositeLayer.sublayerIdsCache.get(t5.objectType.name);
    let E4 = !I3 && M3 ? Array.from(M3).sort() : null;
    if ((_f = (_e = (_d = this.inclusionModeDefinition) == null ? void 0 : _d.namedTypeDefinitions) == null ? void 0 : _e.get(t5.objectType.name)) == null ? void 0 : _f.useAllData) ((_i = (_h = (_g = this.inclusionModeDefinition) == null ? void 0 : _g.namedTypeDefinitions) == null ? void 0 : _h.get(t5.objectType.name)) == null ? void 0 : _i.useAllData) && null != e7.objectIds && (E4 = e7.objectIds);
    else if (null != e7.objectIds && E4 && E4.length > 0) {
      const t6 = e7.objectIds;
      e7.objectIds = E4.filter((e8) => t6.includes(e8));
    } else if (null != e7.objectIds) E4 = e7.objectIds;
    else {
      if (((_j = this.inclusionModeDefinition) == null ? void 0 : _j.namedTypeDefinitions.has(t5.objectType.name)) && (!((_k = this.inclusionModeDefinition.namedTypeDefinitions.get(t5.objectType.name)) == null ? void 0 : _k.members) || ((_m = (_l = this.inclusionModeDefinition.namedTypeDefinitions.get(t5.objectType.name)) == null ? void 0 : _l.members) == null ? void 0 : _m.size) < 1)) return e7.objectIds = [], [];
      e7.objectIds = E4;
    }
    if (null != e7.outFields) {
      const i3 = e7.outFields;
      i3.includes("*") ? t5.fields.forEach((e8) => {
        r5.add(e8.name);
      }) : i3.forEach((e8) => {
        e8 !== w4 && e8 !== t5.geometryFieldName && r5.add(e8);
      });
    }
    if (null != e7.geometry) {
      const n3 = e7.geometry;
      let o5;
      const h3 = t5.parentCompositeLayer.dataManager.knowledgeGraph.serviceDefinition, y5 = h3 == null ? void 0 : h3.spatialReference, w5 = (_n = h3 == null ? void 0 : h3.serviceCapabilities) == null ? void 0 : _n.geometryCapabilities;
      let T7 = w5 == null ? void 0 : w5.geometryMaxBoundingRectangleSizeX, I4 = w5 == null ? void 0 : w5.geometryMaxBoundingRectangleSizeY;
      if (((_o = n3 == null ? void 0 : n3.extent) == null ? void 0 : _o.spatialReference) && !((_p = n3.spatialReference) == null ? void 0 : _p.isWGS84) ? (await N(n3.extent.spatialReference, g), o5 = K(n3.extent, g)) : o5 = n3.extent, T7 && I4 && y5) {
        if (4326 !== y5.wkid) {
          const e8 = new w({ spatialReference: y5, xmax: T7, ymax: I4 }), t6 = K(e8, g);
          T7 = t6.xmax, I4 = t6.ymax;
        }
        if (o5.xmax - o5.xmin > T7) throw new s("knowledge-graph:layer-data-manager", `Extent x bounds should be within ${T7}° latitude, limit exceeded`);
        if (o5.ymax - o5.ymin > I4) throw new s("knowledge-graph:layer-data-manager", `Extent y bounds should be within ${I4}° longitude, limit exceeded`);
      }
      if (null != e7.where && "1=1" !== e7.where) {
        const i3 = await e3(e7.where.toUpperCase(), t5.fieldsIndex);
        t5.fields.forEach((e8) => {
          i3.fieldNames.includes(e8.name) && r5.add(e8.name);
        });
      }
      b3 = D3 ? `Match ()-[n:${t5.objectType.name}]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t5.geometryFieldName}) return ID(n), id(startNode(r)), id(endNode(r))` : `Match (n:${t5.objectType.name}) WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t5.geometryFieldName}) return ID(n)`, t5.geometryFieldName && r5.add(t5.geometryFieldName), r5.forEach((e8) => {
        b3 += `, n.${e8}`, a4.push(e8);
      }), f5 = new s5({ openCypherQuery: b3, bindParameters: { param_filter_geom: new j({ rings: w3(o5) }) } });
    } else {
      let i3 = "";
      if (null != e7.where && "1=1" !== e7.where) {
        const n4 = await e3(e7.where, t5.fieldsIndex);
        t5.fields.forEach((e8) => {
          n4.fieldNames.includes(e8.name) && r5.add(e8.name);
        });
        const o6 = /* @__PURE__ */ new Set(["column-reference", "string", "number", "binary-expression"]), a5 = /* @__PURE__ */ new Set(["=", "<", "<=", "<>", ">", ">=", "AND", "OR", "LIKE"]);
        let p8 = false;
        const d4 = (e8) => {
          if ("column-reference" === e8.type) return `n.${e8.column}`;
          if ("string" === e8.type) return `'${e8.value}'`;
          if ("number" === e8.type) return `${e8.value}`;
          if ("binary-expression" === e8.type && o6.has(e8.left.type) && o6.has(e8.right.type) && a5.has(e8.operator)) return `${d4(e8.left)} ${e8.operator} ${d4(e8.right)}`;
          if ("binary-expression" === e8.type && "LIKE" === e8.operator) {
            let t6 = "";
            if ("function" === e8.left.type && "column-reference" === e8.left.args.value[0].type) t6 += `lower(n.${e8.left.args.value[0].column})`;
            else {
              if ("column-reference" !== e8.left.type) return p8 = true, "";
              t6 += `lower(n.${e8.left.column})`;
            }
            if (t6 += " CONTAINS (", "string" !== e8.right.type) return p8 = true, "";
            {
              let i4 = e8.right.value;
              "%" === i4.charAt(0) && (i4 = i4.slice(1)), "%" === i4.charAt(i4.length - 1) && (i4 = i4.slice(0, -1)), t6 += `'${i4.toLowerCase()}')`;
            }
            return t6;
          }
          return p8 = true, "";
        };
        i3 = d4(n4.parseTree), p8 && (i3 = "");
      }
      let n3 = "";
      n3 = D3 ? `Match ()-[n:${t5.objectType.name}]->()` : `Match (n:${t5.objectType.name})`;
      let o5 = false;
      E4 && (o5 = true, n3 += " WHERE ID(n) IN $ids"), i3 && (n3 += o5 ? " AND" : " WHERE", n3 += ` ${i3}`), n3 += " return ID(n)", D3 && (n3 += ", id(startNode(n)), id(endNode(n))"), e7.returnGeometry && t5.geometryFieldName && r5.add(t5.geometryFieldName), r5.forEach((e8) => {
        n3 += `, n.${e8}`, a4.push(e8);
      }), f5 = new s5(E4 ? { openCypherQuery: n3, bindParameters: { ids: E4 } } : { openCypherQuery: n3 });
    }
    const k2 = (await T(t5.parentCompositeLayer.dataManager.knowledgeGraph, f5, n2)).resultRowsStream.getReader();
    for (; ; ) {
      const { done: e8, value: i3 } = await k2.read();
      if (e8) break;
      const n3 = [];
      for (let t6 = 0; t6 < i3.length; t6++) {
        const e9 = i3[t6];
        let o5 = 0, s8 = 0;
        const r6 = { properties: {} };
        for (r6.id = e9[o5], o5++, s8++, D3 && (r6.originId = e9[o5], o5++, s8++, r6.destinationId = e9[o5], o5++, s8++); o5 < e9.length; o5++) r6.properties[a4[o5 - s8]] = e9[o5];
        n3.push(r6);
      }
      T6 = T6.concat(o4.writeToStore(n3, w4, (_q = t5.parentCompositeLayer.dataManager.geographicLookup.get(t5.objectType.name)) == null ? void 0 : _q.name));
    }
    return T6;
  }
};
e([y()], M2.prototype, "knowledgeGraph", void 0), e([y()], M2.prototype, "inclusionModeDefinition", void 0), e([y()], M2.prototype, "entityTypeNames", void 0), e([y()], M2.prototype, "relationshipTypeNames", void 0), e([y()], M2.prototype, "geographicLookup", void 0), e([y()], M2.prototype, "sublayerCaches", void 0), e([y()], M2.prototype, "nodeConnectionsLookup", void 0), e([y()], M2.prototype, "relationshipConnectionsLookup", void 0), e([y()], M2.prototype, "memberIdTypeLookup", void 0), M2 = e([a2("esri.layers.knowledgeGraph.KnowledgeGraphLayerDataManager")], M2);

// ../node_modules/@arcgis/core/layers/knowledgeGraph/KnowledgeGraphSublayerBase.js
var t4 = s4();
var p7 = (s8) => {
  let p8 = class extends s8 {
    constructor() {
      super(...arguments), this.fields = [], this.fieldsIndex = null;
    }
  };
  return e([y(t4.fields)], p8.prototype, "fields", void 0), e([y(t4.fieldsIndex)], p8.prototype, "fieldsIndex", void 0), p8 = e([a2("esri.layers.knowledgeGraph.KnowledgeGraphSublayerBase")], p8), p8;
};

// ../node_modules/@arcgis/core/layers/knowledgeGraph/KnowledgeGraphSublayer.js
function ee(e7) {
  if (!e7.json) return e7;
  e7.json.write = te(e7.json.write);
  const t5 = e7.json.origins;
  if (!t5) return e7;
  let r5;
  for (r5 in t5) {
    const e8 = t5[r5];
    e8 && (e8.write = te(e8.write));
  }
  return e7;
}
function te(e7) {
  return "object" == typeof e7 && e7 ? (false !== e7.enabled && (e7.overridePolicy = re(e7)), e7) : true === e7 ? oe() : e7;
}
function re(e7) {
  const { target: t5, writer: r5, overridePolicy: o4, ...i3 } = e7;
  return function(e8, t6) {
    const r6 = ie.call(this, e8, t6);
    return r6.enabled ? { ...i3, ...r6 } : r6;
  };
}
function oe() {
  return { overridePolicy: ie };
}
function ie(e7, t5) {
  const r5 = !!this.geometryType;
  let o4 = { enabled: r5 };
  return r5 && (o4 = { ...o4, ...ne.call(this, e7, t5) }), o4;
}
function ne(e7, t5) {
  return { ignoreOrigin: this.originIdOf(t5) > e2.DEFAULTS };
}
var se = class extends p7(c2(c(l(p3(l4(t(f3(S2(f2))))))))) {
  constructor(e7) {
    super(e7), this.blendMode = "normal", this.capabilities = l3(false, false), this.charts = null, this.definitionExpression = null, this.displayField = "", this.effect = null, this.elevationInfo = null, this.featureEffect = null, this.graphType = null, this.labelsVisible = true, this.labelingInfo = null, this.layerType = null, this.legendEnabled = true, this.maxScale = 0, this.minScale = 0, this.objectIdField = w4, this.objectType = null, this.opacity = 1, this.orderBy = null, this.parentCompositeLayer = null, this.persistenceEnabled = true, this.popupEnabled = true, this.popupTemplate = null, this.refreshInterval = 0, this.source = { openPorts: () => this.load().then(() => {
      const e8 = new MessageChannel();
      return new E(e8.port1, { channel: e8, client: { queryFeatures: (e9, t5 = {}) => {
        const r5 = b.fromJSON(e9);
        return this.queryFeaturesJSON(r5, t5);
      } } }), [e8.port2];
    }) }, this.title = null, this.type = "knowledge-graph-sublayer", this.useViewTime = true, this.visible = true;
  }
  get defaultPopupTemplate() {
    return this.createPopupTemplate();
  }
  set featureReduction(e7) {
    const t5 = this._normalizeFeatureReduction(e7);
    this._set("featureReduction", t5);
  }
  get fields() {
    var _a, _b;
    const e7 = [];
    return (_b = (_a = this.objectType) == null ? void 0 : _a.properties) == null ? void 0 : _b.forEach((t5) => {
      const r5 = "esriFieldTypeOID" === t5.fieldType ? "esriFieldTypeInteger" : t5.fieldType;
      e7.push(y3.fromJSON({ name: t5.name, type: r5, alias: t5.alias, defaultValue: t5.defaultValue, editable: t5.editable, nullable: t5.nullable }));
    }), e7.push(y3.fromJSON({ name: this.objectIdField, type: "esriFieldTypeString", alias: this.objectIdField, editable: false }), y3.fromJSON({ name: I2, type: "esriFieldTypeInteger", alias: I2, editable: false })), e7;
  }
  get geometryType() {
    var _a, _b, _c;
    if ("link-chart" === ((_a = this.parentCompositeLayer) == null ? void 0 : _a.type)) return "relationship" === this.graphType ? "polyline" : "point";
    const e7 = (_c = this.parentCompositeLayer) == null ? void 0 : _c.dataManager.geographicLookup.get((_b = this.objectType) == null ? void 0 : _b.name), t5 = e7 == null ? void 0 : e7.geometryType;
    return t5 && "esriGeometryNull" !== t5 ? o.fromJSON(t5) : null;
  }
  get geometryFieldName() {
    var _a, _b, _c;
    if ("link-chart" === ((_a = this.parentCompositeLayer) == null ? void 0 : _a.type)) return D2;
    const e7 = (_c = this.parentCompositeLayer) == null ? void 0 : _c.dataManager.geographicLookup.get((_b = this.objectType) == null ? void 0 : _b.name);
    return (e7 == null ? void 0 : e7.name) ?? null;
  }
  get graphTypeName() {
    var _a;
    return (_a = this.objectType) == null ? void 0 : _a.name;
  }
  get hasM() {
    var _a, _b, _c, _d;
    const e7 = (_b = this.parentCompositeLayer) == null ? void 0 : _b.dataManager.geographicLookup.get((_a = this.objectType) == null ? void 0 : _a.name), t5 = e7 == null ? void 0 : e7.name, r5 = t5 ? (_d = (_c = this.objectType) == null ? void 0 : _c.properties) == null ? void 0 : _d[t5] : null;
    return (r5 == null ? void 0 : r5.hasM) ?? false;
  }
  get hasZ() {
    var _a, _b, _c, _d;
    const e7 = (_b = this.parentCompositeLayer) == null ? void 0 : _b.dataManager.geographicLookup.get((_a = this.objectType) == null ? void 0 : _a.name), t5 = e7 == null ? void 0 : e7.name, r5 = t5 ? (_d = (_c = this.objectType) == null ? void 0 : _c.properties) == null ? void 0 : _d[t5] : null;
    return (r5 == null ? void 0 : r5.hasZ) ?? false;
  }
  set renderer(e7) {
    p5(e7, this.fieldsIndex), this._set("renderer", e7);
  }
  get renderer() {
    var _a;
    return this._isOverridden("renderer") ? this._get("renderer") : "link-chart" === ((_a = this.parentCompositeLayer) == null ? void 0 : _a.type) ? "relationship" === this.graphType ? t2(o2(o.toJSON("polyline")).renderer) : t2(o2(o.toJSON("point")).renderer) : t2(o2(o.toJSON(this.geometryType)).renderer);
  }
  get spatialReference() {
    var _a, _b, _c, _d;
    return ((_d = (_c = (_b = (_a = this.parentCompositeLayer) == null ? void 0 : _a.dataManager) == null ? void 0 : _b.knowledgeGraph) == null ? void 0 : _c.dataModel) == null ? void 0 : _d.spatialReference) ?? f.WGS84;
  }
  writeTitle(e7, t5) {
    t5.title = e7 ?? "Layer";
  }
  createPopupTemplate(e7) {
    return p4(this, e7);
  }
  createQuery() {
    return new b({ where: "1=1", outFields: ["*"] });
  }
  getField(e7) {
    for (let t5 = 0; t5 < this.fields.length; t5++) if (this.fields[t5].name === e7) return this.fields[t5];
    return null;
  }
  getFieldDomain(e7, t5) {
    return null;
  }
  async queryFeatures(e7, t5) {
    const { resolvedQuery: r5, queryEngine: o4 } = await this._setupQueryObjects(e7), i3 = d.fromJSON(await o4.executeQuery(r5.toJSON(), t5 == null ? void 0 : t5.signal));
    return i3.features.forEach((e8) => {
      e8.sourceLayer = this;
    }), i3;
  }
  async queryFeaturesJSON(e7, t5) {
    const { resolvedQuery: r5, queryEngine: o4 } = await this._setupQueryObjects(e7);
    return await o4.executeQuery(r5.toJSON(), t5 == null ? void 0 : t5.signal);
  }
  async queryFeatureCount(e7, t5) {
    const { resolvedQuery: r5, queryEngine: o4 } = await this._setupQueryObjects(e7);
    return o4.executeQueryForCount(r5.toJSON(), t5 == null ? void 0 : t5.signal);
  }
  async queryExtent(e7 = {}, t5) {
    var _a, _b, _c, _d;
    const r5 = { ...e7, returnGeometry: true }, { resolvedQuery: o4, queryEngine: i3 } = await this._setupQueryObjects(r5), n2 = await i3.executeQueryForExtent(o4.toJSON(), t5 == null ? void 0 : t5.signal);
    let s8;
    return s8 = null != ((_a = n2.extent) == null ? void 0 : _a.xmin) && null != ((_b = n2.extent) == null ? void 0 : _b.xmax) && null != ((_c = n2.extent) == null ? void 0 : _c.ymin) && null != ((_d = n2.extent) == null ? void 0 : _d.ymax) ? new w(n2.extent) : new w(), { count: n2.count, extent: s8 };
  }
  async queryObjectIds(e7, t5) {
    const r5 = b.from(e7);
    let o4;
    if ("link-chart" === this.parentCompositeLayer.type && this._cachedQueryEngine) o4 = this._cachedQueryEngine;
    else {
      const e8 = await this.parentCompositeLayer.dataManager.getData(r5, this, t5);
      o4 = this.loadQueryEngine(e8);
    }
    return o4.executeQueryForIds(r5.toJSON(), t5 == null ? void 0 : t5.signal);
  }
  loadQueryEngine(e7) {
    const t5 = new m3({ geometryType: o.toJSON(this.geometryType), hasM: this.hasM, hasZ: this.hasZ }), r5 = new $({ fieldsIndex: this.fieldsIndex.toJSON(), geometryType: o.toJSON(this.geometryType), hasM: this.hasM, hasZ: this.hasZ, objectIdField: this.objectIdField, spatialReference: this.spatialReference.toJSON(), timeInfo: null, featureStore: t5 });
    return r5.featureStore.addMany(e7), r5;
  }
  async refreshCachedQueryEngine() {
    const e7 = await this.parentCompositeLayer.dataManager.getData(new b({ where: "1=1", outFields: [w4] }), this);
    this._cachedQueryEngine = this.loadQueryEngine(e7);
  }
  async _setupQueryObjects(e7, t5) {
    var _a;
    const r5 = b.from(e7), o4 = r5.geometry;
    let i3;
    if (o4 && !((_a = o4.spatialReference) == null ? void 0 : _a.isWGS84) && (await N(o4.spatialReference, g), r5.geometry = K(o4 instanceof j || o4 instanceof m ? o4 : o4.extent, g)), "link-chart" === this.parentCompositeLayer.type && this._cachedQueryEngine) i3 = this._cachedQueryEngine;
    else {
      const e8 = await this.parentCompositeLayer.dataManager.getData(r5, this, t5);
      i3 = this.loadQueryEngine(e8);
    }
    return { resolvedQuery: r5, queryEngine: i3 };
  }
};
e([y(ee(a(s2)))], se.prototype, "blendMode", void 0), e([y()], se.prototype, "capabilities", void 0), e([y({ json: { origins: { "web-scene": { write: false } }, write: oe() } })], se.prototype, "charts", void 0), e([y({ readOnly: true })], se.prototype, "defaultPopupTemplate", null), e([y({ type: String, json: { origins: { service: { read: false } }, name: "layerDefinition.definitionExpression", write: { ignoreOrigin: true } } })], se.prototype, "definitionExpression", void 0), e([y()], se.prototype, "displayField", void 0), e([y(ee(a(a3)))], se.prototype, "effect", void 0), e([y()], se.prototype, "elevationInfo", void 0), e([y(ee(a(p)))], se.prototype, "featureEffect", void 0), e([y(ee(a(p2)))], se.prototype, "featureReduction", null), e([y()], se.prototype, "fields", null), e([y()], se.prototype, "geometryType", null), e([y()], se.prototype, "geometryFieldName", null), e([y({ type: ["entity", "relationship"], nonNullable: true, json: { write: { isRequired: true, ignoreOrigin: true } } })], se.prototype, "graphType", void 0), e([y({ type: String, nonNullable: true, json: { write: { isRequired: true, ignoreOrigin: true } } })], se.prototype, "graphTypeName", null), e([y()], se.prototype, "hasM", null), e([y()], se.prototype, "hasZ", null), e([y({ type: String, json: { origins: { service: { read: false }, "portal-item": { read: false } }, write: { ignoreOrigin: true } } })], se.prototype, "id", void 0), e([y(ee(a(l2)))], se.prototype, "labelsVisible", void 0), e([y({ type: [C], json: { name: "layerDefinition.drawingInfo.labelingInfo", read: l5, write: oe() } })], se.prototype, "labelingInfo", void 0), e([y({ readOnly: true, json: { read: false, write: { writer(e7, t5) {
  t5.layerType = this.geometryType ? "KnowledgeGraphSubLayer" : "KnowledgeGraphSubTable";
}, isRequired: true, ignoreOrigin: true, writerEnsuresNonNull: true } } })], se.prototype, "layerType", void 0), e([y(ee(a(y4)))], se.prototype, "legendEnabled", void 0), e([y(ee(a(j2)))], se.prototype, "maxScale", void 0), e([y(ee(a(u)))], se.prototype, "minScale", void 0), e([y()], se.prototype, "objectIdField", void 0), e([y()], se.prototype, "objectType", void 0), e([y(ee(a(w2)))], se.prototype, "opacity", void 0), e([y(ee(a(c3)))], se.prototype, "orderBy", void 0), e([y()], se.prototype, "parentCompositeLayer", void 0), e([y(ee(a(s3)))], se.prototype, "popupEnabled", void 0), e([y({ type: k, json: { name: "popupInfo", write: { ignoreOrigin: true } } })], se.prototype, "popupTemplate", void 0), e([y({ type: Number, json: { write: { overridePolicy: ne } } })], se.prototype, "refreshInterval", void 0), e([y({ types: m2, json: { name: "layerDefinition.drawingInfo.renderer", write: oe() } })], se.prototype, "renderer", null), e([y()], se.prototype, "source", void 0), e([y()], se.prototype, "spatialReference", null), e([y({ type: String, json: { write: { isRequired: true, ignoreOrigin: true, writerEnsuresNonNull: true } } })], se.prototype, "title", void 0), e([r2("title")], se.prototype, "writeTitle", null), e([y({ json: { read: false } })], se.prototype, "type", void 0), e([y(ee(a(f4)))], se.prototype, "useViewTime", void 0), e([y({ type: Boolean, json: { name: "visibility", write: oe() } })], se.prototype, "visible", void 0), se = e([a2("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")], se);
var ae = se;

export {
  h2 as h,
  T4 as T,
  E3 as E,
  w4 as w,
  b2 as b,
  T5 as T2,
  D2 as D,
  I2 as I,
  M2 as M,
  ae
};
//# sourceMappingURL=chunk-B5LY3L7P.js.map

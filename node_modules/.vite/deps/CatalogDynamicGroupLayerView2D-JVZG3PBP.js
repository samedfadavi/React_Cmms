import {
  f,
  y as y2
} from "./chunk-ZCZQCHTP.js";
import "./chunk-SB76Q4D6.js";
import "./chunk-55VZQ2O4.js";
import "./chunk-TLURKUXV.js";
import "./chunk-4ZTHXCOS.js";
import "./chunk-TCGVPS3X.js";
import "./chunk-POOHJZAR.js";
import "./chunk-XMJZJ562.js";
import "./chunk-GQ3ZCFNN.js";
import "./chunk-6V4RA3W6.js";
import "./chunk-QUNQAVSE.js";
import "./chunk-YUQFVZCH.js";
import "./chunk-T4EIRKFE.js";
import "./chunk-JQIB7GFW.js";
import "./chunk-MNMU4ARP.js";
import "./chunk-4AGGGL2W.js";
import "./chunk-TW7VY7XV.js";
import {
  n as n2
} from "./chunk-KK4UI5LV.js";
import "./chunk-BL2UGYYZ.js";
import "./chunk-Q4D7WYWB.js";
import "./chunk-NYWHVRZC.js";
import "./chunk-ZH4RVBER.js";
import "./chunk-UGXIDNPX.js";
import "./chunk-7PMYO342.js";
import {
  V
} from "./chunk-3DBICPHD.js";
import "./chunk-7R5XEKR3.js";
import "./chunk-ZK4LSXOH.js";
import "./chunk-XFBTC3BA.js";
import "./chunk-XFU3BDEI.js";
import "./chunk-RS5OZZZ5.js";
import "./chunk-VRHSV3YE.js";
import "./chunk-OVORXUCO.js";
import "./chunk-WLUQPLAY.js";
import "./chunk-BTSZKQPH.js";
import "./chunk-AL3F322A.js";
import "./chunk-6N5YXCNN.js";
import "./chunk-MJ2NSPP7.js";
import "./chunk-6YSPJNLC.js";
import "./chunk-66KCMKB5.js";
import "./chunk-ZART2Y5J.js";
import "./chunk-F4OBDVPS.js";
import "./chunk-X3IFQMC4.js";
import "./chunk-4ZEH5SNV.js";
import "./chunk-Z6R2SP3D.js";
import "./chunk-K4UOG562.js";
import "./chunk-WC4SPMPL.js";
import {
  y
} from "./chunk-TJUEGVVG.js";
import "./chunk-FXNOKZ3B.js";
import {
  a3 as a
} from "./chunk-GEH2VXFC.js";
import {
  e
} from "./chunk-BJY5ADVY.js";
import {
  d,
  e as e2,
  k,
  o
} from "./chunk-VMWKLHJD.js";
import "./chunk-5AEITAWU.js";
import "./chunk-G36SOMYZ.js";
import {
  n2 as n
} from "./chunk-YNL57W4I.js";
import "./chunk-2PA5UPTB.js";
import "./chunk-XZXEUADC.js";

// ../node_modules/@arcgis/core/views/layers/CatalogDynamicGroupLayerView.js
var l = Symbol();
var u = (u2) => {
  let y3 = class extends u2 {
    constructor() {
      super(...arguments), this.layerViews = new V(), this._debouncedUpdate = k(async () => {
        const { layer: e3, parent: r } = this, t = r == null ? void 0 : r.footprintLayerView;
        let s = [];
        const i2 = this._createQuery();
        if (i2 && t) {
          const { features: r2 } = await t.queryFeatures(i2);
          this.suspended || (s = r2.map((r3) => e3.acquireLayer(r3)));
        }
        this.removeHandles(l), this.addHandles(s, l);
      });
    }
    get creatingLayerViews() {
      var _a;
      return ((_a = this.view) == null ? void 0 : _a.layerViewManager.isCreatingLayerViewsForLayer(this.layer)) ?? false;
    }
    isUpdating() {
      return this.creatingLayerViews || this.layer.updating || this.layerViews.some((e3) => e3.updating);
    }
    enableLayerUpdates() {
      return o([this._updatingHandles.addWhen(() => {
        var _a, _b;
        return false === ((_b = (_a = this.parent) == null ? void 0 : _a.footprintLayerView) == null ? void 0 : _b.dataUpdating);
      }, () => this.updateLayers()), this._updatingHandles.add(() => {
        var _a, _b, _c, _d, _e;
        return [this.layer.maximumVisibleSublayers, (_a = this.layer.parent) == null ? void 0 : _a.orderBy, (_c = (_b = this.parent) == null ? void 0 : _b.footprintLayerView) == null ? void 0 : _c.filter, (_e = (_d = this.parent) == null ? void 0 : _d.footprintLayerView) == null ? void 0 : _e.timeExtent, this.suspended];
      }, () => this.updateLayers()), e2(() => this.removeHandles(l))]);
    }
    updateLayers() {
      this.suspended ? this.removeHandles(l) : this._updatingHandles.addPromise(d(this._debouncedUpdate()).catch((e3) => {
        n.getLogger(this).error(e3);
      }));
    }
    _createQuery() {
      var _a, _b;
      const e3 = (_a = this.parent) == null ? void 0 : _a.footprintLayerView, r = (_b = this.layer) == null ? void 0 : _b.parent;
      if (!e3 || !r || r.destroyed) return null;
      const { layer: { maximumVisibleSublayers: t }, view: { scale: s } } = this;
      if (!t) return null;
      const { itemTypeField: i2, itemSourceField: a2, itemNameField: o2, minScaleField: d2, maxScaleField: p, objectIdField: l2, orderBy: u3 } = r, y4 = n2(`${d2} IS NULL OR ${s} <= ${d2} OR ${d2} = 0`, `${p} IS NULL OR ${s} >= ${p}`), c2 = u3 == null ? void 0 : u3.find((e4) => e4.field && !e4.valueExpression), m = e3.createQuery();
      if (m.returnGeometry = false, m.num = t, m.outFields = [l2, a2, o2], m.where = n2(m.where, y4), null != this.unsupportedItemTypes) {
        const e4 = `${i2} NOT IN (${this.unsupportedItemTypes.map((e5) => `'${e5}'`)})`;
        m.where = n2(m.where, e4);
      }
      return (c2 == null ? void 0 : c2.field) && (m.orderByFields = [`${c2.field} ${"descending" === c2.order ? "DESC" : "ASC"}`], m.outFields.push(c2.field)), m;
    }
  };
  return e([y({ readOnly: true })], y3.prototype, "creatingLayerViews", null), e([y()], y3.prototype, "layer", void 0), e([y()], y3.prototype, "layerViews", void 0), e([y({ readOnly: true })], y3.prototype, "unsupportedItemTypes", void 0), e([y()], y3.prototype, "parent", void 0), e([y({ readOnly: true })], y3.prototype, "isUpdating", null), y3 = e([a("esri.views.layers.CatalogDynamicGroupLayerView")], y3), y3;
};

// ../node_modules/@arcgis/core/views/2d/layers/CatalogDynamicGroupLayerView2D.js
var i = class extends u(f(y2)) {
  constructor() {
    super(...arguments), this.unsupportedItemTypes = ["Scene Service"], this.layerViews = new V();
  }
  attach() {
    this.addAttachHandles([this.layerViews.on("after-changes", () => this._updateStageChildren()), this.enableLayerUpdates()]);
  }
  detach() {
    this.container.removeAllChildren();
  }
  update(e3) {
    this.updateLayers();
  }
  viewChange() {
  }
  moveEnd() {
    this.requestUpdate();
  }
  _updateStageChildren() {
    this.container.removeAllChildren(), this.layerViews.forEach((e3, r) => this.container.addChildAt(e3.container, r));
  }
};
i = e([a("esri.views.2d.layers.CatalogDynamicGroupLayerView2D")], i);
var c = i;
export {
  c as default
};
//# sourceMappingURL=CatalogDynamicGroupLayerView2D-JVZG3PBP.js.map

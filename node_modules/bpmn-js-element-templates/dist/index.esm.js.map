{"version":3,"file":"index.esm.js","sources":["../src/cloud-element-templates/util/FeelUtil.js","../src/cloud-element-templates/Helper.js","../src/element-templates/Helper.js","../src/element-templates/ElementTemplates.js","../src/cloud-element-templates/ElementTemplates.js","../src/element-templates/Validator.js","../src/cloud-element-templates/Validator.js","../src/element-templates/ElementTemplatesLoader.js","../src/cloud-element-templates/ElementTemplatesLoader.js","../src/utils/ElementUtil.js","../src/cloud-element-templates/CreateHelper.js","../src/cloud-element-templates/util/bindingTypes.js","../src/cloud-element-templates/util/taskDefinition.js","../src/cloud-element-templates/util/rootElementUtil.js","../src/cloud-element-templates/cmd/ChangeElementTemplateHandler.js","../src/cloud-element-templates/cmd/RemoveElementTemplateHandler.js","../src/element-templates/cmd/MultiCommandHandler.js","../src/cloud-element-templates/cmd/ElementTemplateCommands.js","../src/cloud-element-templates/cmd/index.js","../src/cloud-element-templates/create/PropertyBindingProvider.js","../src/cloud-element-templates/create/TaskDefinitionBindingProvider.js","../src/cloud-element-templates/create/InputBindingProvider.js","../src/cloud-element-templates/create/OutputBindingProvider.js","../src/cloud-element-templates/create/TaskHeaderBindingProvider.js","../src/cloud-element-templates/create/ZeebePropertiesProvider.js","../src/cloud-element-templates/create/MessagePropertyBindingProvider.js","../src/cloud-element-templates/create/MessageZeebeSubscriptionBindingProvider.js","../src/cloud-element-templates/create/CalledElementBindingProvider.js","../src/cloud-element-templates/create/LinkedResourceProvider.js","../src/cloud-element-templates/util/propertyUtil.js","../src/cloud-element-templates/Condition.js","../src/cloud-element-templates/create/TemplateElementFactory.js","../src/cloud-element-templates/create/index.js","../src/cloud-element-templates/behavior/ConditionalBehavior.js","../src/cloud-element-templates/behavior/ReplaceBehavior.js","../src/cloud-element-templates/behavior/UpdatePropertiesOrderBehavior.js","../src/cloud-element-templates/behavior/ReferencedElementBehavior.js","../src/cloud-element-templates/behavior/GeneratedValueBehavior.js","../src/cloud-element-templates/behavior/CalledElementBehavior.js","../src/cloud-element-templates/behavior/index.js","../src/cloud-element-templates/core/index.js","../src/utils/templateUtil.js","../src/components/ElementTemplatesGroup.js","../src/components/TemplateProps.js","../node_modules/preact-markup/dist/preact-markup.module.js","../src/utils/sanitize.js","../src/cloud-element-templates/properties-panel/components/PropertyTooltip.js","../src/cloud-element-templates/properties-panel/properties/custom-properties/util.js","../src/components/PropertyDescription.js","../src/cloud-element-templates/properties-panel/properties/custom-properties/TextAreaProperty.js","../src/cloud-element-templates/properties-panel/properties/custom-properties/StringProperty.js","../src/entries/HOCs/withVariableContext.js","../src/entries/HOCs/withTooltipContainer.js","../src/entries/FeelEntryWithContext.js","../src/cloud-element-templates/properties-panel/properties/custom-properties/FeelProperty.js","../src/cloud-element-templates/properties-panel/properties/custom-properties/FeelTextAreaProperty.js","../src/cloud-element-templates/properties-panel/properties/custom-properties/DropdownProperty.js","../src/cloud-element-templates/properties-panel/properties/custom-properties/BooleanProperty.js","../src/cloud-element-templates/properties-panel/properties/custom-properties/NumberProperty.js","../src/cloud-element-templates/properties-panel/properties/custom-properties/index.js","../src/entries/ReferenceSelect.js","../src/utils/EventDefinitionUtil.js","../src/cloud-element-templates/properties-panel/properties/MessageProps.js","../src/cloud-element-templates/properties-panel/ElementTemplatesPropertiesProvider.js","../src/cloud-element-templates/properties-panel/index.js","../src/cloud-element-templates/index.js","../src/element-templates/util/handleLegacyScopes.js","../src/element-templates/CreateHelper.js","../src/element-templates/cmd/ChangeElementTemplateHandler.js","../src/element-templates/cmd/RemoveElementTemplateHandler.js","../src/element-templates/cmd/ElementTemplateCommands.js","../src/element-templates/cmd/index.js","../src/element-templates/behavior/ReplaceBehavior.js","../src/element-templates/behavior/index.js","../src/element-templates/core/index.js","../src/element-templates/util/bindingTypes.js","../src/element-templates/properties-panel/properties/CustomProperties.js","../src/element-templates/properties-panel/properties/ErrorProperties.js","../src/element-templates/properties-panel/properties/InputProperties.js","../src/element-templates/util/validationUtil.js","../src/element-templates/properties-panel/properties/OutputProperties.js","../src/element-templates/properties-panel/ElementTemplatesPropertiesProvider.js","../src/element-templates/properties-panel/index.js","../src/element-templates/index.js","../node_modules/bpmn-moddle/node_modules/moddle/dist/index.js","../node_modules/bpmn-moddle/node_modules/saxen/dist/index.js","../node_modules/bpmn-moddle/node_modules/moddle-xml/dist/index.js","../node_modules/bpmn-moddle/dist/index.js","../src/cloud-element-templates/linting/rules/element-templates-validate.js","../src/cloud-element-templates/linting/rules/element-templates-compatibility.js","../src/cloud-element-templates/linting/index.js"],"sourcesContent":["/**\n * Check if the property is cast to FEEL expression:\n * - Boolean and Number properties with feel set to 'optional' or 'static'\n * - Boolean and Number input/output parameters have default feel=static\n *\n * @returns {boolean}\n */\nexport const shouldCastToFeel = (property) => {\n  const feel = getFeelValue(property);\n\n  return [ 'optional', 'static' ].includes(feel) && [ 'Boolean', 'Number' ].includes(property.type);\n};\n\nconst ALWAYS_CAST_TO_FEEL = [\n  'zeebe:input',\n  'zeebe:output'\n];\n\nfunction getFeelValue(property) {\n  if (ALWAYS_CAST_TO_FEEL.includes(property.binding.type)) {\n    return property.feel || 'static';\n  }\n\n  return property.feel;\n}\n\nexport const toFeelExpression = (value, type) => {\n  if (typeof value === 'string' && value.startsWith('=')) {\n    return value;\n  }\n\n  if (type === 'Boolean') {\n    value = value === 'false' ? false : value;\n    return '=' + !!value;\n  }\n\n  if (typeof value === 'undefined') {\n    return value;\n  }\n\n  return '=' + value.toString();\n};","import { getBusinessObject } from 'bpmn-js/lib/util/ModelUtil';\n\nimport { is, isAny } from 'bpmn-js/lib/util/ModelUtil';\n\nimport { v4 as uuid } from 'uuid';\nimport { shouldCastToFeel, toFeelExpression } from './util/FeelUtil';\n\n/**\n * The BPMN 2.0 extension attribute name under\n * which the element template ID is stored.\n *\n * @type {String}\n */\nexport const TEMPLATE_ID_ATTR = 'zeebe:modelerTemplate';\n\n/**\n * The BPMN 2.0 extension attribute name under\n * which the element template version is stored.\n *\n * @type {String}\n */\nexport const TEMPLATE_VERSION_ATTR = 'zeebe:modelerTemplateVersion';\n\n/**\n * The BPMN 2.0 extension attribute name under\n * which the element template icon is stored.\n *\n * @type {String}\n */\nexport const TEMPLATE_ICON_ATTR = 'zeebe:modelerTemplateIcon';\n\n\n/**\n * Get template id for a given diagram element.\n *\n * @param {djs.model.Base} element\n *\n * @return {String}\n */\nexport function getTemplateId(element) {\n  const businessObject = getBusinessObject(element);\n\n  if (businessObject) {\n    return businessObject.get(TEMPLATE_ID_ATTR);\n  }\n}\n\n/**\n * Get template version for a given diagram element.\n *\n * @param {djs.model.Base} element\n *\n * @return {String}\n */\nexport function getTemplateVersion(element) {\n  const businessObject = getBusinessObject(element);\n\n  if (businessObject) {\n    return businessObject.get(TEMPLATE_VERSION_ATTR);\n  }\n}\n\n/**\n * Get template icon for a given diagram element.\n *\n * @param {djs.model.Base} element\n *\n * @return {String}\n */\nexport function getTemplateIcon(element) {\n  const businessObject = getBusinessObject(element);\n\n  if (businessObject) {\n    return businessObject.get(TEMPLATE_ICON_ATTR);\n  }\n}\n\n/**\n * Find extension with given type in\n * BPMN element, diagram element or ExtensionElement.\n *\n * @param {ModdleElement|djs.model.Base} element\n * @param {String} type\n *\n * @return {ModdleElement} the extension\n */\nexport function findExtension(element, type) {\n  const businessObject = getBusinessObject(element);\n\n  let extensionElements;\n\n  if (is(businessObject, 'bpmn:ExtensionElements')) {\n    extensionElements = businessObject;\n  } else {\n    extensionElements = businessObject.get('extensionElements');\n  }\n\n  if (!extensionElements) {\n    return;\n  }\n\n  return extensionElements.get('values').find((value) => {\n    return is(value, type);\n  });\n}\n\nexport function findExtensions(element, types) {\n  const businessObject = getBusinessObject(element);\n\n  let extensionElements;\n\n  if (is(businessObject, 'bpmn:ExtensionElements')) {\n    extensionElements = businessObject;\n  } else {\n    extensionElements = businessObject.get('extensionElements');\n  }\n\n  if (!extensionElements) {\n    return null;\n  }\n\n  return extensionElements.get('values').filter((value) => {\n    return isAny(value, types);\n  });\n}\n\nexport function findZeebeProperty(zeebeProperties, binding) {\n  return zeebeProperties.get('properties').find((value) => {\n    return value.name === binding.name;\n  });\n}\n\nexport function findInputParameter(ioMapping, binding) {\n  const parameters = ioMapping.get('inputParameters');\n\n  return parameters.find((parameter) => {\n    return parameter.target === binding.name;\n  });\n}\n\nexport function findOutputParameter(ioMapping, binding) {\n  const parameters = ioMapping.get('outputParameters');\n\n  return parameters.find((parameter) => {\n    return parameter.source === binding.source;\n  });\n}\n\nexport function findTaskHeader(taskHeaders, binding) {\n  const headers = taskHeaders.get('values');\n\n  return headers.find((header) => {\n    return header.key === binding.key;\n  });\n}\n\nexport function findMessage(businessObject) {\n  if (is(businessObject, 'bpmn:Event')) {\n    const eventDefinitions = businessObject.get('eventDefinitions');\n\n    if (!eventDefinitions || !eventDefinitions.length) {\n      return;\n    }\n\n    businessObject = eventDefinitions[0];\n  }\n\n  if (!businessObject) {\n    return;\n  }\n\n  return businessObject.get('messageRef');\n}\n\nexport function findZeebeSubscription(message) {\n  return findExtension(message, 'zeebe:Subscription');\n}\n\nexport function getDefaultValue(property) {\n\n  if (\n    shouldCastToFeel(property)\n  ) {\n    return toFeelExpression(property.value, property.type);\n  }\n\n  if (property.value !== undefined) {\n    return property.value;\n  }\n\n  if (property.generatedValue) {\n    const { type } = property.generatedValue;\n\n    if (type === 'uuid') {\n      return uuid();\n    }\n  }\n}\n","import { getBusinessObject } from 'bpmn-js/lib/util/ModelUtil';\n\nimport { is, isAny } from 'bpmn-js/lib/util/ModelUtil';\n\n/**\n * The BPMN 2.0 extension attribute name under\n * which the element template ID is stored.\n *\n * @type {String}\n */\nexport const TEMPLATE_ID_ATTR = 'camunda:modelerTemplate';\n\n/**\n * The BPMN 2.0 extension attribute name under\n * which the element template version is stored.\n *\n * @type {String}\n */\nexport const TEMPLATE_VERSION_ATTR = 'camunda:modelerTemplateVersion';\n\n\n/**\n * Get template id for a given diagram element.\n *\n * @param {djs.model.Base} element\n *\n * @return {String}\n */\nexport function getTemplateId(element) {\n  const businessObject = getBusinessObject(element);\n\n  if (businessObject) {\n    return businessObject.get(TEMPLATE_ID_ATTR);\n  }\n}\n\n/**\n * Get template version for a given diagram element.\n *\n * @param {djs.model.Base} element\n *\n * @return {String}\n */\nexport function getTemplateVersion(element) {\n  const businessObject = getBusinessObject(element);\n\n  if (businessObject) {\n    return businessObject.get(TEMPLATE_VERSION_ATTR);\n  }\n}\n\n/**\n * Find extension with given type in\n * BPMN element, diagram element or ExtensionElement.\n *\n * @param {ModdleElement|djs.model.Base} element\n * @param {String} type\n *\n * @return {ModdleElement} the extension\n */\nexport function findExtension(element, type) {\n  const businessObject = getBusinessObject(element);\n\n  let extensionElements;\n\n  if (is(businessObject, 'bpmn:ExtensionElements')) {\n    extensionElements = businessObject;\n  } else {\n    extensionElements = businessObject.get('extensionElements');\n  }\n\n  if (!extensionElements) {\n    return null;\n  }\n\n  return extensionElements.get('values').find((value) => {\n    return is(value, type);\n  });\n}\n\nexport function findExtensions(element, types) {\n  const extensionElements = getExtensionElements(element);\n\n  if (!extensionElements) {\n    return [];\n  }\n\n  return extensionElements.get('values').filter((value) => {\n    return isAny(value, types);\n  });\n}\n\nexport function findCamundaInOut(element, binding) {\n  const extensionElements = getExtensionElements(element);\n\n  if (!extensionElements) {\n    return;\n  }\n\n  const { type } = binding;\n\n  let matcher;\n\n  if (type === 'camunda:in') {\n    matcher = (element) => {\n      return is(element, 'camunda:In') && isInOut(element, binding);\n    };\n  } else if (type === 'camunda:out') {\n    matcher = (element) => {\n      return is(element, 'camunda:Out') && isInOut(element, binding);\n    };\n  } else if (type === 'camunda:in:businessKey') {\n    matcher = (element) => {\n      return is(element, 'camunda:In') && 'businessKey' in element;\n    };\n  }\n\n  return extensionElements.get('values').find(matcher);\n}\n\nexport function findCamundaProperty(camundaProperties, binding) {\n  return camundaProperties.get('values').find((value) => {\n    return value.name === binding.name;\n  });\n}\n\nexport function findInputParameter(inputOutput, binding) {\n  const parameters = inputOutput.get('inputParameters');\n\n  return parameters.find((parameter) => {\n    return parameter.name === binding.name;\n  });\n}\n\nexport function findOutputParameter(inputOutput, binding) {\n  const parameters = inputOutput.get('outputParameters');\n\n  return parameters.find(function(parameter) {\n    const { value } = parameter;\n\n    if (!binding.scriptFormat) {\n      return value === binding.source;\n    }\n\n    const definition = parameter.get('camunda:definition');\n\n    if (!definition || binding.scriptFormat !== definition.get('camunda:scriptFormat')) {\n      return false;\n    }\n\n    return definition.get('camunda:value') === binding.source;\n  });\n}\n\nexport function findCamundaErrorEventDefinition(element, errorRef) {\n  const errorEventDefinitions = findExtensions(element, [ 'camunda:ErrorEventDefinition' ]);\n\n  let error;\n\n  // error ID has to start with <Error_${ errorRef }_>\n  return errorEventDefinitions.find((definition) => {\n    error = definition.get('bpmn:errorRef');\n\n    if (error) {\n      return error.get('bpmn:id').startsWith(`Error_${ errorRef }`);\n    }\n  });\n}\n\nexport function findError(element, errorRef) {\n  const root = getRoot(getBusinessObject(element)),\n        rootElements = root.get('rootElements');\n\n  return rootElements.find((rootElement) => {\n    return is(rootElement, 'bpmn:Error')\n      && rootElement.get('id').startsWith(`Error_${ errorRef }`);\n  });\n}\n\n\n// helpers //////////\n\nfunction getExtensionElements(element) {\n  const businessObject = getBusinessObject(element);\n\n  if (is(businessObject, 'bpmn:ExtensionElements')) {\n    return businessObject;\n  } else {\n    return businessObject.get('extensionElements');\n  }\n}\n\n\nfunction isInOut(element, binding) {\n\n  if (binding.type === 'camunda:in') {\n\n    // find based on target attribute\n    if (binding.target) {\n      return element.target === binding.target;\n    }\n  }\n\n  if (binding.type === 'camunda:out') {\n\n    // find based on source / sourceExpression\n    if (binding.source) {\n      return element.source === binding.source;\n    }\n\n    if (binding.sourceExpression) {\n      return element.sourceExpression === binding.sourceExpression;\n    }\n  }\n\n  // find based variables / local combination\n  if (binding.variables) {\n    return element.variables === 'all' && (\n      binding.variables !== 'local' || element.local\n    );\n  }\n}\n\nfunction getRoot(businessObject) {\n  let parent = businessObject;\n\n  while (parent.$parent) {\n    parent = parent.$parent;\n  }\n\n  return parent;\n}","import {\n  filter,\n  find,\n  flatten,\n  has,\n  isNil,\n  isObject,\n  isString,\n  isUndefined,\n  reduce,\n  values\n} from 'min-dash';\n\nimport {\n  getTemplateId,\n  getTemplateVersion\n} from './Helper';\n\nimport { isAny } from 'bpmn-js/lib/util/ModelUtil';\n\nimport {\n  valid as isSemverValid,\n  satisfies as isSemverCompatible,\n  coerce\n} from 'semver';\n\n// eslint-disable-next-line no-undef\nconst packageVersion = process.env.PKG_VERSION;\n\n\n/**\n * Registry for element templates.\n */\nexport default class ElementTemplates {\n  constructor(commandStack, eventBus, modeling, injector, config) {\n    this._commandStack = commandStack;\n    this._eventBus = eventBus;\n    this._injector = injector;\n    this._modeling = modeling;\n\n    this._templatesById = {};\n    this._templates = [];\n\n    config = config || {};\n\n    this._engines = this._coerceEngines(config.engines || {});\n\n    eventBus.on('elementTemplates.engines.changed', event => {\n      this.set(this._templates);\n    });\n  }\n\n  /**\n   * Get template with given ID and optional version or for element.\n   *\n   * @param {String|djs.model.Base} id\n   * @param {number} [version]\n   *\n   * @return {ElementTemplate}\n   */\n  get(id, version) {\n    const templates = this._templatesById;\n\n    let element;\n\n    if (isUndefined(id)) {\n      return null;\n    } else if (isString(id)) {\n\n      if (isUndefined(version)) {\n        version = '_';\n      }\n\n      if (templates[ id ] && templates[ id ][ version ]) {\n        return templates[ id ][ version ];\n      } else {\n        return null;\n      }\n    } else {\n      element = id;\n\n      return this.get(this._getTemplateId(element), this._getTemplateVersion(element));\n    }\n  }\n\n  /**\n   * Get default template for given element.\n   *\n   * @param {djs.model.Base} element\n   *\n   * @return {ElementTemplate}\n   */\n  getDefault(element) {\n    return find(this.getAll(element), function(template) {\n      return template.isDefault;\n    }) || null;\n  }\n\n  /**\n   * Get all templates (with given ID or applicable to element).\n   *\n   * @param {string|djs.model.Base} [id]\n   * @return {Array<ElementTemplate>}\n   */\n  getAll(id) {\n    return this._getTemplateVerions(id, { includeDeprecated: true });\n  }\n\n\n  /**\n   * Get all templates (with given ID or applicable to element) with the latest\n   * version.\n   *\n   * @param {String|djs.model.Base} [id]\n   * @param {{ deprecated?: boolean }} [options]\n   *\n   * @return {Array<ElementTemplate>}\n   */\n  getLatest(id, options = {}) {\n    return this._getTemplateVerions(id, {\n      ...options,\n      latest: true\n    });\n  }\n\n  /**\n   * Set templates.\n   *\n   * @param {Array<ElementTemplate>} templates\n   */\n  set(templates) {\n    this._templatesById = {};\n    this._templates = templates;\n\n    templates.forEach((template) => {\n      const id = template.id;\n      const version = isUndefined(template.version) ? '_' : template.version;\n\n      if (!this._templatesById[ id ]) {\n        this._templatesById[ id ] = { };\n      }\n\n      this._templatesById[ id ][ version ] = template;\n\n      const latest = this._templatesById[ id ].latest;\n\n      if (this.isCompatible(template)) {\n        if (!latest || isUndefined(latest.version) || latest.version < version) {\n          this._templatesById[ id ].latest = template;\n        }\n      }\n    });\n\n    this._fire('changed');\n  }\n\n  getEngines() {\n    return this._engines;\n  }\n\n  setEngines(engines) {\n\n    this._engines = this._coerceEngines(engines);\n\n    this._fire('engines.changed');\n  }\n\n  /**\n   * Ensures that only valid engines are kept around\n   *\n   * @param { Record<string, string> } engines\n   *\n   * @return { Record<string, string> } filtered, valid engines\n   */\n  _coerceEngines(engines) {\n\n    // we provide <elementTemplates> engine with the current\n    // package version; templates may use that engine to declare\n    // compatibility with this library\n    engines = {\n      elementTemplates: packageVersion,\n      ...engines\n    };\n\n    return reduce(engines, (validEngines, version, engine) => {\n\n      const coercedVersion = coerce(version);\n\n      if (!isSemverValid(coercedVersion)) {\n        console.error(\n          new Error(`Engine <${ engine }> specifies unparseable version <${version}>`)\n        );\n\n        return validEngines;\n      }\n\n      return {\n        ...validEngines,\n        [ engine ]: coercedVersion.raw\n      };\n    }, {});\n  }\n\n  /**\n   * Check if template is compatible with currently set engine version.\n   *\n   * @param {ElementTemplate} template\n   *\n   * @return {boolean} - true if compatible or no engine is set for elementTemplates or template.\n   */\n  isCompatible(template) {\n    return !Object.keys(this.getIncompatibleEngines(template)).length;\n  }\n\n  /**\n   * Get engines that are incompatible with the template.\n   *\n   * @param {any} template\n   *\n   * @return { Record<string, { required: string, found: string } } - incompatible engines along with their template and local versions\n   */\n  getIncompatibleEngines(template) {\n    const localEngines = this._engines;\n    const templateEngines = template.engines;\n\n    return reduce(templateEngines, (result, _, engine) => {\n\n      if (!has(localEngines, engine)) {\n        return result;\n      }\n\n      if (!isSemverCompatible(localEngines[engine], templateEngines[engine])) {\n        result[engine] = {\n          actual: localEngines[engine],\n          required: templateEngines[engine]\n        };\n      }\n\n      return result;\n    }, {});\n  }\n\n  /**\n   * @param {object|string|null} id\n   * @param { { latest?: boolean, deprecated?: boolean } [options]\n   *\n   * @return {Array<ElementTemplate>}\n   */\n  _getTemplateVerions(id, options = {}) {\n\n    const {\n      latest: includeLatestOnly,\n      deprecated: includeDeprecated\n    } = options;\n\n    const templatesById = this._templatesById;\n    const getVersions = (template) => {\n      const { latest, ...versions } = template;\n      return includeLatestOnly ? (\n        !includeDeprecated && (latest && latest.deprecated) ? [] : (latest ? [ latest ] : [])\n      ) : values(versions) ;\n    };\n\n    if (isNil(id)) {\n      return flatten(values(templatesById).map(getVersions));\n    }\n\n    if (isObject(id)) {\n      const element = id;\n\n      return filter(this._getTemplateVerions(null, options), function(template) {\n        return isAny(element, template.appliesTo);\n      }) || [];\n    }\n\n    if (isString(id)) {\n      return templatesById[ id ] && getVersions(templatesById[ id ]);\n    }\n\n    throw new Error('argument must be of type {string|djs.model.Base|undefined}');\n  }\n\n  _getTemplateId(element) {\n    return getTemplateId(element);\n  }\n\n  _getTemplateVersion(element) {\n    return getTemplateVersion(element);\n  }\n\n  /**\n   * Apply element template to a given element.\n   *\n   * @param {djs.model.Base} element\n   * @param {ElementTemplate} newTemplate\n   *\n   * @return {djs.model.Base} the updated element\n   */\n  applyTemplate(element, newTemplate) {\n\n    let action = 'apply';\n    let payload = { element, newTemplate };\n    const oldTemplate = this.get(element);\n\n    if (oldTemplate && !newTemplate) {\n      action = 'unlink';\n      payload = { element };\n    }\n\n    if (newTemplate && oldTemplate && (newTemplate.id === oldTemplate.id)) {\n      action = 'update';\n    }\n\n    const context = {\n      element,\n      newTemplate,\n      oldTemplate\n    };\n\n    this._commandStack.execute('propertiesPanel.camunda.changeTemplate', context);\n\n    this._fire(action, payload);\n\n    return context.element;\n  }\n\n  _fire(action, payload) {\n    return this._eventBus.fire(`elementTemplates.${action}`, payload);\n  }\n\n  /**\n   * Remove template from a given element.\n   *\n   * @param {djs.model.Base} element\n   *\n   * @return {djs.model.Base} the updated element\n   */\n  removeTemplate(element) {\n    this._fire('remove', { element });\n\n    const context = {\n      element\n    };\n\n    this._commandStack.execute('propertiesPanel.removeTemplate', context);\n\n    return context.newElement;\n\n  }\n\n  /**\n   * Unlink template from a given element.\n   *\n   * @param {djs.model.Base} element\n   *\n   * @return {djs.model.Base} the updated element\n   */\n  unlinkTemplate(element) {\n    return this.applyTemplate(element, null);\n  }\n\n}\n\nElementTemplates.$inject = [\n  'commandStack',\n  'eventBus',\n  'modeling',\n  'injector',\n  'config.elementTemplates'\n];","import {\n  getTemplateId,\n  getTemplateVersion\n} from './Helper';\n\nimport { default as DefaultElementTemplates } from '../element-templates/ElementTemplates';\n\n/**\n * Registry for element templates.\n */\nexport default class ElementTemplates extends DefaultElementTemplates {\n  constructor(templateElementFactory, commandStack, eventBus, modeling, injector, config) {\n    super(commandStack, eventBus, modeling, injector, config);\n\n    this._templateElementFactory = templateElementFactory;\n  }\n\n  _getTemplateId(element) {\n    return getTemplateId(element);\n  }\n\n  _getTemplateVersion(element) {\n    return getTemplateVersion(element);\n  }\n\n  /**\n   * Create an element based on an element template.\n   *\n   * @param {ElementTemplate} template\n   * @returns {djs.model.Base}\n   */\n  createElement(template) {\n    if (!template) {\n      throw new Error('template is missing');\n    }\n\n    const element = this._templateElementFactory.create(template);\n\n    return element;\n  }\n\n  /**\n   * Apply element template to a given element.\n   *\n   * @param {djs.model.Base} element\n   * @param {ElementTemplate} newTemplate\n   *\n   * @return {djs.model.Base} the updated element\n   */\n  applyTemplate(element, newTemplate) {\n\n    let action = 'apply';\n    let payload = { element, newTemplate };\n\n    const oldTemplate = this.get(element);\n\n    if (oldTemplate && !newTemplate) {\n      action = 'unlink';\n      payload = { element };\n    }\n\n    if (newTemplate && oldTemplate && (newTemplate.id === oldTemplate.id)) {\n      action = 'update';\n    }\n\n    const context = {\n      element,\n      newTemplate,\n      oldTemplate\n    };\n\n    this._commandStack.execute('propertiesPanel.zeebe.changeTemplate', context);\n\n    this._eventBus.fire(`elementTemplates.${action}`, payload);\n\n    return context.element;\n  }\n\n}\n\nElementTemplates.$inject = [\n  'templateElementFactory',\n  'commandStack',\n  'eventBus',\n  'modeling',\n  'injector',\n  'config.elementTemplates',\n];\n","import {\n  filter,\n  forEach,\n  isArray,\n  isString\n} from 'min-dash';\n\nimport semverCompare from 'semver-compare';\n\nimport {\n  validRange as isSemverRangeValid\n} from 'semver';\n\nimport {\n  validate as validateAgainstSchema,\n  getSchemaVersion as getTemplateSchemaVersion\n} from '@bpmn-io/element-templates-validator';\n\nconst SUPPORTED_SCHEMA_VERSION = getTemplateSchemaVersion();\nconst MORPHABLE_TYPES = [ 'bpmn:Activity', 'bpmn:Event', 'bpmn:Gateway' ];\n\n\n/**\n * A element template validator.\n */\nexport class Validator {\n  constructor(moddle) {\n    this._templatesById = {};\n\n    this._validTemplates = [];\n    this._errors = [];\n    this._moddle = moddle;\n  }\n\n  /**\n   * Adds the templates.\n   *\n   * @param {Array<TemplateDescriptor>} templates\n   *\n   * @return {Validator}\n   */\n  addAll(templates) {\n    if (!isArray(templates)) {\n      this._logError('templates must be []');\n    } else {\n      templates.forEach(this.add, this);\n    }\n\n    return this;\n  }\n\n  /**\n   * Add the given element template, if it is valid.\n   *\n   * @param {TemplateDescriptor} template\n   *\n   * @return {Validator}\n   */\n  add(template) {\n    const err = this._validateTemplate(template);\n\n    let id, version;\n\n    if (!err) {\n      id = template.id;\n      version = template.version || '_';\n\n      if (!this._templatesById[ id ]) {\n        this._templatesById[ id ] = {};\n      }\n\n      this._templatesById[ id ][ version ] = template;\n\n      this._validTemplates.push(template);\n    }\n\n    return this;\n  }\n\n  /**\n   * Validate given template and return error (if any).\n   *\n   * @param {TemplateDescriptor} template\n   *\n   * @return {Error} validation error, if any\n   */\n  _validateTemplate(template) {\n    const id = template.id,\n          version = template.version || '_',\n          schemaVersion = template.$schema && getSchemaVersion(template.$schema);\n\n    // (1) compatibility\n    if (schemaVersion && (semverCompare(SUPPORTED_SCHEMA_VERSION, schemaVersion) < 0)) {\n      return this._logError(\n        `unsupported element template schema version <${ schemaVersion }>. Your installation only supports up to version <${ SUPPORTED_SCHEMA_VERSION }>. Please update your installation`,\n        template\n      );\n    }\n\n    // (2) versioning\n    if (this._templatesById[ id ] && this._templatesById[ id ][ version ]) {\n      if (version === '_') {\n        return this._logError(`template id <${ id }> already used`, template);\n      } else {\n        return this._logError(`template id <${ id }> and version <${ version }> already used`, template);\n      }\n    }\n\n    // (3) elementType validation\n    const elementTypeError = this._validateElementType(template);\n\n    if (elementTypeError) {\n      return elementTypeError;\n    }\n\n    // (4) JSON schema compliance\n    const schemaValidationResult = validateAgainstSchema(template);\n\n    const {\n      errors: schemaErrors,\n      valid\n    } = schemaValidationResult;\n\n    if (!valid) {\n      filteredSchemaErrors(schemaErrors).forEach((error) => {\n        this._logError(error.message, template);\n      });\n\n      return new Error('invalid template');\n    }\n\n    // (5) engines validation\n    const enginesError = this._validateEngines(template);\n\n    if (enginesError) {\n      return enginesError;\n    }\n\n    return null;\n  }\n\n  _validateEngines(template) {\n\n    let err;\n\n    forEach(template.engines, (rangeStr, engine) => {\n\n      if (!isSemverRangeValid(rangeStr)) {\n        err = this._logError(new Error(\n          `Engine <${engine}> specifies invalid semver range <${rangeStr}>`\n        ), template);\n      }\n    });\n\n    return err;\n  }\n\n  /**\n   * Validate elementType for given template and return error (if any).\n   *\n   * @param {TemplateDescriptor} template\n   *\n   * @return {Error} validation error, if any\n   */\n  _validateElementType(template) {\n    if (template.elementType && template.appliesTo) {\n\n      const elementType = template.elementType.value,\n            appliesTo = template.appliesTo;\n\n      // (3.1) template can be applied to elementType\n      // prevents cases where the elementType is not part of appliesTo\n      if (!appliesTo.find(type => this._isType(elementType, type))) {\n        return this._logError(`template does not apply to requested element type <${ elementType }>`, template);\n      }\n\n      // (3.2) template only applies to same type of element\n      // prevent elementTemplates to morph into incompatible types, e.g. Task -> SequenceFlow\n      for (const sourceType of appliesTo) {\n        if (!this._canMorph(sourceType, elementType)) {\n          return this._logError(`can not morph <${sourceType}> into <${elementType}>`, template);\n        }\n      }\n    }\n  }\n\n\n  /**\n   * Check if given type is a subtype of given base type.\n   *\n   * @param {String} type\n   * @param {String} baseType\n   * @returns {Boolean}\n   */\n  _isType(type, baseType) {\n    const moddleType = this._moddle.getType(type);\n\n    return moddleType && (baseType in this._moddle.getElementDescriptor(moddleType).allTypesByName);\n  }\n\n\n  /**\n   * Checks if a given type can be morphed into another type.\n   *\n   * @param {String} sourceType\n   * @param {String} targetType\n   * @returns {Boolean}\n   */\n  _canMorph(sourceType, targetType) {\n\n    if (sourceType === targetType) {\n      return true;\n    }\n\n    const baseType = MORPHABLE_TYPES.find(type => this._isType(sourceType, type));\n\n    if (!baseType) {\n      return false;\n    }\n\n    return this._isType(targetType, baseType);\n  }\n\n  /**\n   * Log an error for the given template\n   *\n   * @param {(String|Error)} err\n   * @param {TemplateDescriptor} template\n   *\n   * @return {Error} logged validation errors\n   */\n  _logError(err, template) {\n    if (isString(err)) {\n\n      if (template) {\n        const {\n          id,\n          name\n        } = template;\n\n        err = `template(id: <${ id }>, name: <${ name }>): ${ err }`;\n      }\n\n      err = new Error(err);\n    }\n\n    this._errors.push(err);\n\n    return err;\n  }\n\n  getErrors() {\n    return this._errors;\n  }\n\n  getValidTemplates() {\n    return this._validTemplates;\n  }\n}\n\n\n// helpers //////////\n\n/**\n * Extract schema version from schema URI\n *\n * @param {String} schemaUri - for example https://unpkg.com/@camunda/element-templates-json-schema@99.99.99/resources/schema.json\n *\n * @return {String} for example '99.99.99'\n */\nexport function getSchemaVersion(schemaUri) {\n  const re = /\\d+\\.\\d+\\.\\d+/g;\n\n  const match = schemaUri.match(re);\n\n  return match === null ? undefined : match[ 0 ];\n}\n\n/**\n * Extract only relevant errors of the validation result.\n *\n * The JSON Schema we use under the hood produces more errors than we need for a\n * detected schema violation (for example, unmatched sub-schemas, if-then-rules,\n * `oneOf`-definitions ...).\n *\n * We call these errors \"relevant\" that have a custom error message defined by us OR\n * are basic data type errors.\n *\n * @param {Array} schemaErrors\n *\n * @return {Array}\n */\nexport function filteredSchemaErrors(schemaErrors) {\n  return filter(schemaErrors, (err) => {\n    const {\n      instancePath,\n      keyword\n    } = err;\n\n    // (1) regular errors are customized from the schema\n    if (keyword === 'errorMessage') {\n      return true;\n    }\n\n    // (2) data type errors\n    // ignore type errors nested in scopes\n    if (keyword === 'type' && instancePath && !instancePath.startsWith('/scopes/')) {\n      return true;\n    }\n\n    return false;\n  });\n}","import {\n  Validator as BaseValidator,\n  filteredSchemaErrors,\n  getSchemaVersion\n} from '../element-templates/Validator';\n\nimport semverCompare from 'semver-compare';\n\nimport {\n  validRange as isSemverRangeValid\n} from 'semver';\n\nimport {\n  validateZeebe as validateAgainstSchema,\n  getZeebeSchemaPackage as getTemplateSchemaPackage,\n  getZeebeSchemaVersion as getTemplateSchemaVersion\n} from '@bpmn-io/element-templates-validator';\nimport { forEach } from 'min-dash';\n\nconst SUPPORTED_SCHEMA_VERSION = getTemplateSchemaVersion();\nconst SUPPORTED_SCHEMA_PACKAGE = getTemplateSchemaPackage();\n\n/**\n * A Camunda Cloud element template validator.\n */\nexport class Validator extends BaseValidator {\n  constructor(moddle) {\n    super(moddle);\n  }\n\n  /**\n   * Validate given template and return error (if any).\n   *\n   * @param {TemplateDescriptor} template\n   *\n   * @return {Error} validation error, if any\n   */\n  _validateTemplate(template) {\n    const id = template.id,\n          version = template.version || '_',\n          schema = template.$schema,\n          schemaVersion = schema && getSchemaVersion(schema);\n\n    // (1) $schema attribute defined\n    if (!schema) {\n      return this._logError(\n        'missing $schema attribute.',\n        template\n      );\n    }\n\n    if (!this.isSchemaValid(schema)) {\n      return this._logError(\n        `unsupported $schema attribute <${ schema }>.`,\n        template\n      );\n    }\n\n    // (2) compatibility\n    if (schemaVersion && (semverCompare(SUPPORTED_SCHEMA_VERSION, schemaVersion) < 0)) {\n      return this._logError(\n        `unsupported element template schema version <${ schemaVersion }>. Your installation only supports up to version <${ SUPPORTED_SCHEMA_VERSION }>. Please update your installation`,\n        template\n      );\n    }\n\n    // (3) versioning\n    if (this._templatesById[ id ] && this._templatesById[ id ][ version ]) {\n      if (version === '_') {\n        return this._logError(`template id <${ id }> already used`, template);\n      } else {\n        return this._logError(`template id <${ id }> and version <${ version }> already used`, template);\n      }\n    }\n\n    // (4) elementType validation\n    const elementTypeError = this._validateElementType(template);\n\n    if (elementTypeError) {\n      return elementTypeError;\n    }\n\n    // (5) JSON schema compliance\n    const schemaValidationResult = validateAgainstSchema(template);\n\n    const {\n      errors: schemaErrors,\n      valid\n    } = schemaValidationResult;\n\n    if (!valid) {\n      filteredSchemaErrors(schemaErrors).forEach((error) => {\n        this._logError(error.message, template);\n      });\n\n      return new Error('invalid template');\n    }\n\n    // (6) engines validation\n    const enginesError = this._validateEngines(template);\n\n    if (enginesError) {\n      return enginesError;\n    }\n\n    return null;\n  }\n\n  isSchemaValid(schema) {\n    return schema && schema.includes(SUPPORTED_SCHEMA_PACKAGE);\n  }\n\n  _validateEngines(template) {\n\n    let err;\n\n    forEach(template.engines, (rangeStr, engine) => {\n\n      if (!isSemverRangeValid(rangeStr)) {\n        err = this._logError(new Error(\n          `Engine <${engine}> specifies invalid semver range <${rangeStr}>`\n        ), template);\n      }\n    });\n\n    return err;\n  }\n}\n","import {\n  isFunction,\n  isUndefined,\n  isArray,\n} from 'min-dash';\n\nimport { Validator } from './Validator';\n\n/**\n * The guy responsible for template loading.\n *\n * Provide the actual templates via the `config.elementTemplates`.\n *\n * That configuration can either be an array of template\n * descriptors or a node style callback to retrieve\n * the templates asynchronously.\n *\n * @param {Array<TemplateDescriptor>|Function} config\n * @param {EventBus} eventBus\n * @param {ElementTemplates} elementTemplates\n * @param {Moddle} moddle\n */\nexport default class ElementTemplatesLoader {\n  constructor(config, eventBus, elementTemplates, moddle) {\n    this._loadTemplates;\n    this._eventBus = eventBus;\n    this._elementTemplates = elementTemplates;\n    this._moddle = moddle;\n\n    if (isArray(config) || isFunction(config)) {\n      this._loadTemplates = config;\n    }\n\n    if (config && config.loadTemplates) {\n      this._loadTemplates = config.loadTemplates;\n    }\n\n    eventBus.on('diagram.init', () => {\n      this.reload();\n    });\n  }\n\n  reload() {\n    const loadTemplates = this._loadTemplates;\n\n    // no templates specified\n    if (isUndefined(loadTemplates)) {\n      return;\n    }\n\n    // template loader function specified\n    if (isFunction(loadTemplates)) {\n\n      return loadTemplates((err, templates) => {\n\n        if (err) {\n          return this._templateErrors([ err ]);\n        }\n\n        this.setTemplates(templates);\n      });\n    }\n\n    // templates array specified\n    if (loadTemplates.length) {\n      return this.setTemplates(loadTemplates);\n    }\n  }\n\n  setTemplates(templates) {\n    const elementTemplates = this._elementTemplates,\n          moddle = this._moddle;\n\n    const validator = new Validator(moddle).addAll(templates);\n\n    const errors = validator.getErrors(),\n          validTemplates = validator.getValidTemplates();\n\n    elementTemplates.set(validTemplates);\n\n    if (errors.length) {\n      this._templateErrors(errors);\n    }\n  }\n\n  _templateErrors(errors) {\n    this._elementTemplates._fire('errors', {\n      errors: errors\n    });\n  }\n}\n\nElementTemplatesLoader.$inject = [\n  'config.elementTemplates',\n  'eventBus',\n  'elementTemplates',\n  'moddle'\n];","import { Validator } from './Validator';\n\nimport { default as TemplatesLoader } from '../element-templates/ElementTemplatesLoader';\n\n/**\n * @param {Object|Array<TemplateDescriptor>|Function} config\n * @param {EventBus} eventBus\n * @param {ElementTemplates} elementTemplates\n * @param {Moddle} moddle\n */\nexport default class ElementTemplatesLoader extends TemplatesLoader {\n  constructor(config, eventBus, elementTemplates, moddle) {\n\n    super(config, eventBus, elementTemplates, moddle);\n\n    this._elementTemplates = elementTemplates;\n  }\n\n  setTemplates(templates) {\n    const elementTemplates = this._elementTemplates,\n          moddle = this._moddle;\n\n    const validator = new Validator(moddle).addAll(templates);\n\n    const errors = validator.getErrors(),\n          validTemplates = validator.getValidTemplates();\n\n    elementTemplates.set(validTemplates);\n\n    if (errors.length) {\n      this._templateErrors(errors);\n    }\n  }\n}\n\nElementTemplatesLoader.$inject = [\n  'config.elementTemplates',\n  'eventBus',\n  'elementTemplates',\n  'moddle'\n];","import Ids from 'ids';\n\nimport {\n  is\n} from 'bpmn-js/lib/util/ModelUtil';\n\n/**\n * Create a new element and set its parent.\n *\n * @param {String} elementType of the new element\n * @param {Object} properties of the new element in key-value pairs\n * @param {moddle.object} parent of the new element\n * @param {BpmnFactory} factory which creates the new element\n *\n * @returns {djs.model.Base} element which is created\n */\nexport function createElement(elementType, properties, parent, factory) {\n  const element = factory.create(elementType, properties);\n\n  if (parent) {\n    element.$parent = parent;\n  }\n\n  return element;\n}\n\n/**\n * generate a semantic id with given prefix\n */\nexport function nextId(prefix) {\n  const ids = new Ids([ 32,32,1 ]);\n\n  return ids.nextPrefixed(prefix);\n}\n\nexport function getRoot(businessObject) {\n  let parent = businessObject;\n\n  while (parent.$parent) {\n    parent = parent.$parent;\n  }\n\n  return parent;\n}\n\nexport function filterElementsByType(objectList, type) {\n  const list = objectList || [];\n\n  return list.filter(element => is(element, type));\n}\n\nexport function findRootElementsByType(businessObject, referencedType) {\n  const root = getRoot(businessObject);\n\n  return filterElementsByType(root.get('rootElements'), referencedType);\n}\n\nexport function findRootElementById(businessObject, type, id) {\n  const elements = findRootElementsByType(businessObject, type);\n\n  return elements.find(element => element.id === id);\n}\n","import { getBusinessObject } from 'bpmn-js/lib/util/ModelUtil';\n\nimport { findExtension } from './Helper';\nimport { createElement } from '../utils/ElementUtil';\n\n\n/**\n * Create an input parameter representing the given\n * binding and value.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createInputParameter(binding, value, bpmnFactory) {\n  const {\n    name\n  } = binding;\n\n  return bpmnFactory.create('zeebe:Input', {\n    source: value,\n    target: name\n  });\n}\n\n/**\n * Create an output parameter representing the given\n * binding and value.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createOutputParameter(binding, value, bpmnFactory) {\n  const {\n    source\n  } = binding;\n\n  return bpmnFactory.create('zeebe:Output', {\n    source,\n    target: value\n  });\n}\n\n/**\n * Create a task header representing the given\n * binding and value.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createTaskHeader(binding, value, bpmnFactory) {\n  const {\n    key\n  } = binding;\n\n  return bpmnFactory.create('zeebe:Header', {\n    key,\n    value\n  });\n}\n\n/**\n * Create a task definition representing the given value.\n *\n * @param {object} attrs\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createTaskDefinition(attrs = {}, bpmnFactory) {\n  return bpmnFactory.create('zeebe:TaskDefinition', attrs);\n}\n\n/**\n * Create zeebe:Property from the given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createZeebeProperty(binding, value = '', bpmnFactory) {\n  const { name } = binding;\n\n  return bpmnFactory.create('zeebe:Property', {\n    name,\n    value\n  });\n}\n\n/**\n * Create a called element representing the given value.\n *\n * @param {object} attrs\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createCalledElement(attrs = {}, bpmnFactory) {\n  return bpmnFactory.create('zeebe:CalledElement', attrs);\n}\n\n/**\n * Retrieves whether an element should be updated for a given property.\n *\n * That matches once\n * a) the property value is not empty, or\n * b) the property is not optional\n *\n * @param {String} value\n * @param {Object} property\n * @returns {Boolean}\n */\nexport function shouldUpdate(value, property) {\n  const { optional } = property;\n\n  return value || !optional;\n}\n\n/**\n * Gets or, in case not existent, creates extension element for given element.\n *\n * @param {djs.model.Base} element\n * @param {String} type\n * @param {BpmnFactory} bpmnFactory\n * @returns {ModdleElement}\n */\nexport function ensureExtension(element, type, bpmnFactory) {\n  const businessObject = getBusinessObject(element);\n  let extensionElements = businessObject.get('extensionElements');\n\n  if (!extensionElements) {\n    extensionElements = createElement('bpmn:ExtensionElements', {}, businessObject, bpmnFactory);\n    businessObject.set('extensionElements', extensionElements);\n  }\n\n  let extension = findExtension(extensionElements, type);\n\n  if (!extension) {\n    extension = bpmnFactory.create(type);\n    extension.$parent = extensionElements;\n    extensionElements.get('values').push(extension);\n  }\n\n  return extension;\n}","export const PROPERTY_TYPE = 'property';\n\nexport const ZEBBE_PROPERTY_TYPE = 'zeebe:property';\nexport const ZEBBE_INPUT_TYPE = 'zeebe:input';\nexport const ZEEBE_OUTPUT_TYPE = 'zeebe:output';\nexport const ZEEBE_PROPERTY_TYPE = 'zeebe:property';\nexport const ZEEBE_TASK_DEFINITION_TYPE_TYPE = 'zeebe:taskDefinition:type';\nexport const ZEEBE_TASK_DEFINITION = 'zeebe:taskDefinition';\nexport const ZEEBE_TASK_HEADER_TYPE = 'zeebe:taskHeader';\nexport const MESSAGE_PROPERTY_TYPE = 'bpmn:Message#property';\nexport const MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE = 'bpmn:Message#zeebe:subscription#property';\nexport const ZEEBE_CALLED_ELEMENT = 'zeebe:calledElement';\nexport const ZEEBE_LINKED_RESOURCE_PROPERTY = 'zeebe:linkedResource';\n\nexport const EXTENSION_BINDING_TYPES = [\n  MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE,\n  ZEBBE_INPUT_TYPE,\n  ZEEBE_OUTPUT_TYPE,\n  ZEEBE_PROPERTY_TYPE,\n  ZEEBE_TASK_DEFINITION_TYPE_TYPE,\n  ZEEBE_TASK_DEFINITION,\n  ZEEBE_TASK_HEADER_TYPE,\n  ZEEBE_CALLED_ELEMENT,\n  ZEEBE_LINKED_RESOURCE_PROPERTY\n];\n\nexport const TASK_DEFINITION_TYPES = [\n  ZEEBE_TASK_DEFINITION_TYPE_TYPE,\n  ZEEBE_TASK_DEFINITION\n];\n\nexport const IO_BINDING_TYPES = [\n  ZEBBE_INPUT_TYPE,\n  ZEEBE_OUTPUT_TYPE\n];\n\nexport const MESSAGE_BINDING_TYPES = [\n  MESSAGE_PROPERTY_TYPE,\n  MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE\n];\n\nexport const PROPERTY_BINDING_TYPES = [\n  PROPERTY_TYPE,\n  MESSAGE_PROPERTY_TYPE\n];\n","import {\n  ZEEBE_TASK_DEFINITION_TYPE_TYPE\n} from './bindingTypes';\n\nexport function getTaskDefinitionPropertyName(binding) {\n  return binding.type === ZEEBE_TASK_DEFINITION_TYPE_TYPE ? 'type' : binding.property;\n}\n","import {\n  getBusinessObject,\n  is\n} from 'bpmn-js/lib/util/ModelUtil';\nimport { findMessage } from '../Helper';\n\nexport function removeRootElement(rootElement, injector) {\n  const modeling = injector.get('modeling'),\n        canvas = injector.get('canvas'),\n        bpmnjs = injector.get('bpmnjs');\n\n  const element = canvas.getRootElement(),\n        definitions = bpmnjs.getDefinitions(),\n        rootElements = definitions.get('rootElements');\n\n  const newRootElements = rootElements.filter(e => e !== rootElement);\n\n  // short-circuit to prevent unnecessary updates\n  if (newRootElements.length === rootElements.length) {\n    return;\n  }\n\n  modeling.updateModdleProperties(element, definitions, {\n    rootElements: newRootElements\n  });\n}\n\n/**\n * Remove message from element and the diagram.\n *\n * @param {import('bpmn-js/lib/model/Types').Element} element\n * @param {import('didi').Injector} injector\n */\nexport function removeMessage(element, injector) {\n  const modeling = injector.get('modeling');\n\n  const bo = getReferringElement(element);\n\n  // Event does not have an event definition\n  if (!bo) {\n    return;\n  }\n\n  const message = findMessage(bo);\n\n  if (!message) {\n    return;\n  }\n\n  modeling.updateModdleProperties(element, bo, {\n    messageRef: undefined\n  });\n  removeRootElement(message, injector);\n}\n\n\nexport function getReferringElement(element) {\n  const bo = getBusinessObject(element);\n\n  if (is(bo, 'bpmn:Event')) {\n    return bo.get('eventDefinitions')[0];\n  }\n\n  return bo;\n}\n","import {\n  getBusinessObject,\n  is\n} from 'bpmn-js/lib/util/ModelUtil';\n\nimport {\n  findExtension,\n  findMessage,\n  getDefaultValue,\n  getTemplateVersion,\n  getTemplateId,\n  getTemplateIcon\n} from '../Helper';\n\nimport {\n  createCalledElement,\n  createInputParameter,\n  createOutputParameter,\n  createTaskDefinition,\n  createTaskHeader,\n  createZeebeProperty,\n  shouldUpdate\n} from '../CreateHelper';\n\nimport {\n  find,\n  without\n} from 'min-dash';\n\nimport {\n  MESSAGE_BINDING_TYPES,\n  MESSAGE_PROPERTY_TYPE,\n  MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE,\n  TASK_DEFINITION_TYPES,\n  ZEEBE_CALLED_ELEMENT,\n  ZEEBE_LINKED_RESOURCE_PROPERTY\n} from '../util/bindingTypes';\n\nimport {\n  getTaskDefinitionPropertyName\n} from '../util/taskDefinition';\n\nimport {\n  createElement,\n  getRoot\n} from '../../utils/ElementUtil';\nimport { removeMessage } from '../util/rootElementUtil';\n\n/**\n * Applies an element template to an element. Sets `zeebe:modelerTemplate` and\n * `zeebe:modelerTemplateVersion`.\n */\nexport default class ChangeElementTemplateHandler {\n  constructor(bpmnFactory, bpmnReplace, commandStack, modeling, injector) {\n    this._bpmnFactory = bpmnFactory;\n    this._bpmnReplace = bpmnReplace;\n\n    this._modeling = modeling;\n    this._commandStack = commandStack;\n\n    this._injector = injector;\n  }\n\n  /**\n   * Change an element's template and update its properties as specified in `newTemplate`. Specify\n   * `oldTemplate` to update from one template to another. If `newTemplate` isn't specified the\n   * `zeebe:modelerTemplate` and `zeebe:modelerTemplateVersion` properties will be removed from\n   * the element.\n   *\n   * @param {Object} context\n   * @param {Object} context.element\n   * @param {Object} [context.oldTemplate]\n   * @param {Object} [context.newTemplate]\n   */\n  preExecute(context) {\n    let newTemplate = context.newTemplate,\n        oldTemplate = context.oldTemplate;\n\n    let element = context.element;\n\n    // update zeebe:modelerTemplate attribute\n    this._updateZeebeModelerTemplate(element, newTemplate);\n\n    // update zeebe:modelerTemplateIcon\n    this._updateZeebeModelerTemplateIcon(element, newTemplate);\n\n    if (newTemplate) {\n\n      // update element type\n      element = context.element = this._updateElementType(element, oldTemplate, newTemplate);\n\n      // update properties\n      this._updateProperties(element, oldTemplate, newTemplate);\n\n      // update zeebe:TaskDefinition\n      this._updateZeebeTaskDefinition(element, oldTemplate, newTemplate);\n\n      // update zeebe:Input and zeebe:Output properties\n      this._updateZeebeInputOutputParameterProperties(element, oldTemplate, newTemplate);\n\n      // update zeebe:Header properties\n      this._updateZeebeTaskHeaderProperties(element, oldTemplate, newTemplate);\n\n      // update zeebe:Property properties\n      this._updateZeebePropertyProperties(element, oldTemplate, newTemplate);\n\n      this._updateMessage(element, oldTemplate, newTemplate);\n\n      this._updateCalledElement(element, oldTemplate, newTemplate);\n\n      this._updateLinkedResources(element, oldTemplate, newTemplate);\n    }\n  }\n\n  _getOrCreateExtensionElements(element, businessObject = getBusinessObject(element)) {\n    const bpmnFactory = this._bpmnFactory,\n          modeling = this._modeling;\n\n    let extensionElements = businessObject.get('extensionElements');\n\n    if (!extensionElements) {\n      extensionElements = bpmnFactory.create('bpmn:ExtensionElements', {\n        values: []\n      });\n\n      extensionElements.$parent = businessObject;\n\n      modeling.updateModdleProperties(element, businessObject, {\n        extensionElements: extensionElements\n      });\n    }\n\n    return extensionElements;\n  }\n\n  _updateZeebeModelerTemplate(element, newTemplate) {\n    const modeling = this._modeling;\n\n    const newId = newTemplate && newTemplate.id;\n    const newVersion = newTemplate && newTemplate.version;\n\n    if (getTemplateId(element) !== newId || getTemplateVersion(element) !== newVersion) {\n      modeling.updateProperties(element, {\n        'zeebe:modelerTemplate': newId,\n        'zeebe:modelerTemplateVersion': newVersion\n      });\n    }\n  }\n\n  _updateZeebeModelerTemplateIcon(element, newTemplate) {\n    const modeling = this._modeling;\n\n    const newIcon = newTemplate && newTemplate.icon;\n    const newIconContents = newIcon && newIcon.contents;\n\n    if (getTemplateIcon(element) !== newIconContents) {\n      modeling.updateProperties(element, {\n        'zeebe:modelerTemplateIcon': newIconContents\n      });\n    }\n  }\n\n  _updateProperties(element, oldTemplate, newTemplate) {\n    const commandStack = this._commandStack;\n    const businessObject = getBusinessObject(element);\n\n    const newProperties = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return newBindingType === 'property';\n    });\n\n    // Remove old Properties if no new Properties specified\n    const propertiesToRemove = oldTemplate && oldTemplate.properties.filter((oldProperty) => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      return oldBindingType === 'property' && !newProperties.find((newProperty) => newProperty.binding.name === oldProperty.binding.name);\n    }) || [];\n\n    if (propertiesToRemove.length) {\n      const payload = propertiesToRemove.reduce((properties, property) => {\n        properties[property.binding.name] = undefined;\n        return properties;\n      }, {});\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties: payload\n      });\n    }\n\n    if (!newProperties.length) {\n      return;\n    }\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            newBinding = newProperty.binding,\n            newBindingName = newBinding.name,\n            newPropertyValue = getDefaultValue(newProperty),\n            changedElement = businessObject;\n\n      let properties = {};\n\n      if (shouldKeepValue(changedElement, oldProperty, newProperty)) {\n        return;\n      }\n\n      properties[ newBindingName ] = newPropertyValue;\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties\n      });\n    });\n  }\n\n  /**\n   * Update `zeebe:TaskDefinition` properties of specified business object. This\n   * can only exist in `bpmn:ExtensionElements`.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newTemplate\n   */\n  _updateZeebeTaskDefinition(element, oldTemplate, newTemplate) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    const newProperties = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return TASK_DEFINITION_TYPES.includes(newBindingType);\n    });\n\n    const businessObject = this._getOrCreateExtensionElements(element);\n    let taskDefinition = findExtension(businessObject, 'zeebe:TaskDefinition');\n\n    // (1) remove old task definition if no new properties specified\n\n    if (!newProperties.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties: {\n          values: without(businessObject.get('values'), taskDefinition)\n        }\n      });\n\n      return;\n    }\n\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            newPropertyValue = getDefaultValue(newProperty),\n            newBinding = newProperty.binding,\n            propertyName = getTaskDefinitionPropertyName(newBinding);\n\n      // (2) update old task definition\n      if (taskDefinition) {\n\n        if (!shouldKeepValue(taskDefinition, oldProperty, newProperty)) {\n          const properties = {\n            [propertyName]: newPropertyValue\n          };\n\n          commandStack.execute('element.updateModdleProperties', {\n            element,\n            moddleElement: taskDefinition,\n            properties\n          });\n        }\n      }\n\n      // (3) add new task definition\n      else {\n        const properties = {\n          [propertyName]: newPropertyValue\n        };\n\n        taskDefinition = createTaskDefinition(properties, bpmnFactory);\n\n        taskDefinition.$parent = businessObject;\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: businessObject,\n          properties: {\n            values: [ ...businessObject.get('values'), taskDefinition ]\n          }\n        });\n      }\n    });\n\n    // (4) remove properties no longer templated\n    const oldProperties = oldTemplate && oldTemplate.properties.filter((oldProperty) => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      return TASK_DEFINITION_TYPES.includes(oldBindingType) && !newProperties.find((newProperty) => newProperty.binding.property === oldProperty.binding.property);\n    }) || [];\n\n    oldProperties.forEach((oldProperty) => {\n      const properties = {\n        [oldProperty.binding.property]: undefined\n      };\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: taskDefinition,\n        properties\n      });\n    });\n  }\n\n  /**\n   * Update `zeebe:Input` and `zeebe:Output` properties of specified business\n   * object. Both can only exist in `zeebe:ioMapping` which can exist in `bpmn:ExtensionElements`.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newTemplate\n   */\n  _updateZeebeInputOutputParameterProperties(element, oldTemplate, newTemplate) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    const newProperties = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return newBindingType === 'zeebe:input' || newBindingType === 'zeebe:output';\n    });\n\n    const businessObject = this._getOrCreateExtensionElements(element);\n\n    let ioMapping = findExtension(businessObject, 'zeebe:IoMapping');\n\n    // (1) remove old mappings if no new specified\n    if (!newProperties.length) {\n      if (!ioMapping) {\n        return;\n      }\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties: {\n          values: without(businessObject.get('values'), ioMapping)\n        }\n      });\n    }\n\n    if (!ioMapping) {\n      ioMapping = bpmnFactory.create('zeebe:IoMapping');\n\n      ioMapping.$parent = businessObject;\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties: {\n          values: [ ...businessObject.get('values'), ioMapping ]\n        }\n      });\n    }\n\n    const oldInputs = ioMapping.get('zeebe:inputParameters')\n      ? ioMapping.get('zeebe:inputParameters').slice()\n      : [];\n\n    const oldOutputs = ioMapping.get('zeebe:outputParameters')\n      ? ioMapping.get('zeebe:outputParameters').slice()\n      : [];\n\n    let propertyName;\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            inputOrOutput = findBusinessObject(businessObject, newProperty),\n            newPropertyValue = getDefaultValue(newProperty),\n            newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      let newInputOrOutput,\n          properties;\n\n      // (2) update old inputs and outputs\n      if (inputOrOutput) {\n\n        // (2a) exclude old inputs and outputs from cleanup, unless\n        // a) optional and has empty value, and\n        // b) not changed\n        if (\n          shouldUpdate(newPropertyValue, newProperty) ||\n          shouldKeepValue(inputOrOutput, oldProperty, newProperty)\n        ) {\n          if (is(inputOrOutput, 'zeebe:Input')) {\n            remove(oldInputs, inputOrOutput);\n          } else {\n            remove(oldOutputs, inputOrOutput);\n          }\n        }\n\n        // (2a) do updates (unless changed)\n        if (!shouldKeepValue(inputOrOutput, oldProperty, newProperty)) {\n\n          if (is(inputOrOutput, 'zeebe:Input')) {\n            properties = {\n              source: newPropertyValue\n            };\n          } else {\n            properties = {\n              target: newPropertyValue\n            };\n          }\n\n          commandStack.execute('element.updateModdleProperties', {\n            element,\n            moddleElement: inputOrOutput,\n            properties\n          });\n        }\n      }\n\n      // (3) add new inputs and outputs (unless optional)\n      else if (shouldUpdate(newPropertyValue, newProperty)) {\n\n        if (newBindingType === 'zeebe:input') {\n          propertyName = 'inputParameters';\n\n          newInputOrOutput = createInputParameter(newBinding, newPropertyValue, bpmnFactory);\n        } else {\n          propertyName = 'outputParameters';\n\n          newInputOrOutput = createOutputParameter(newBinding, newPropertyValue, bpmnFactory);\n        }\n\n        newInputOrOutput.$parent = ioMapping;\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: ioMapping,\n          properties: {\n            [ propertyName ]: [ ...ioMapping.get(propertyName), newInputOrOutput ]\n          }\n        });\n      }\n    });\n\n    // (4) remove old inputs and outputs\n    if (oldInputs.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: ioMapping,\n        properties: {\n          inputParameters: without(ioMapping.get('inputParameters'), inputParameter => oldInputs.includes(inputParameter))\n        }\n      });\n    }\n\n    if (oldOutputs.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: ioMapping,\n        properties: {\n          outputParameters: without(ioMapping.get('outputParameters'), outputParameter => oldOutputs.includes(outputParameter))\n        }\n      });\n    }\n  }\n\n  /**\n   * Update `zeebe:Header` properties of specified business\n   * object. Those can only exist in `zeebe:taskHeaders` which can exist in `bpmn:ExtensionElements`.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newTemplate\n   */\n  _updateZeebeTaskHeaderProperties(element, oldTemplate, newTemplate) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    const newProperties = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return newBindingType === 'zeebe:taskHeader';\n    });\n\n    const businessObject = this._getOrCreateExtensionElements(element);\n\n    let taskHeaders = findExtension(businessObject, 'zeebe:TaskHeaders');\n\n    // (1) remove old headers if no new specified\n    if (!newProperties.length) {\n      if (!taskHeaders) {\n        return;\n      }\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties: {\n          values: without(businessObject.get('values'), taskHeaders)\n        }\n      });\n    }\n\n    if (!taskHeaders) {\n      taskHeaders = bpmnFactory.create('zeebe:TaskHeaders');\n\n      taskHeaders.$parent = businessObject;\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties: {\n          values: [ ...businessObject.get('values'), taskHeaders ]\n        }\n      });\n    }\n\n    const oldHeaders = taskHeaders.get('zeebe:values')\n      ? taskHeaders.get('zeebe:values').slice()\n      : [];\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            oldHeader = findBusinessObject(businessObject, newProperty),\n            newPropertyValue = getDefaultValue(newProperty),\n            newBinding = newProperty.binding;\n\n      // (2) update old headers\n      if (oldHeader) {\n\n        if (!shouldKeepValue(oldHeader, oldProperty, newProperty)) {\n          const properties = {\n            value: newPropertyValue\n          };\n\n          commandStack.execute('element.updateModdleProperties', {\n            element,\n            moddleElement: oldHeader,\n            properties\n          });\n        }\n\n        remove(oldHeaders, oldHeader);\n      }\n\n      // (3) add new (non-empty) headers\n      else if (newPropertyValue) {\n        const newHeader = createTaskHeader(newBinding, newPropertyValue, bpmnFactory);\n\n        newHeader.$parent = taskHeaders;\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: taskHeaders,\n          properties: {\n            values: [ ...taskHeaders.get('values'), newHeader ]\n          }\n        });\n      }\n    });\n\n    // (4) remove old headers\n    if (oldHeaders.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: taskHeaders,\n        properties: {\n          values: without(taskHeaders.get('values'), header => oldHeaders.includes(header))\n        }\n      });\n    }\n  }\n\n  /**\n   * Update zeebe:Property properties of zeebe:Properties extension element.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newTemplate\n   */\n  _updateZeebePropertyProperties(element, oldTemplate, newTemplate) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    const newProperties = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return newBindingType === 'zeebe:property';\n    });\n\n    const businessObject = this._getOrCreateExtensionElements(element);\n\n    let zeebeProperties = findExtension(businessObject, 'zeebe:Properties');\n\n    // (1) remove old zeebe:Properties if no new zeebe:Property properties\n    if (!newProperties.length) {\n      if (!zeebeProperties) {\n        return;\n      }\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties: {\n          values: without(businessObject.get('values'), zeebeProperties)\n        }\n      });\n    }\n\n    if (!zeebeProperties) {\n      zeebeProperties = bpmnFactory.create('zeebe:Properties');\n\n      zeebeProperties.$parent = businessObject;\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties: {\n          values: [ ...businessObject.get('values'), zeebeProperties ]\n        }\n      });\n    }\n\n    const oldZeebeProperties = zeebeProperties.get('properties')\n      ? zeebeProperties.get('properties').slice()\n      : [];\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            oldZeebeProperty = findBusinessObject(businessObject, newProperty),\n            newPropertyValue = getDefaultValue(newProperty),\n            newBinding = newProperty.binding;\n\n      // (2) update old zeebe:Property\n      if (oldZeebeProperty) {\n        if (shouldUpdate(newPropertyValue, newProperty)\n          || shouldKeepValue(oldZeebeProperty, oldProperty, newProperty)) {\n          remove(oldZeebeProperties, oldZeebeProperty);\n        }\n\n        if (!shouldKeepValue(oldZeebeProperty, oldProperty, newProperty)) {\n          commandStack.execute('element.updateModdleProperties', {\n            element,\n            moddleElement: oldZeebeProperty,\n            properties: {\n              value: newPropertyValue\n            }\n          });\n        }\n      }\n\n      // (3) add new zeebe:Property\n      else if (shouldUpdate(newPropertyValue, newProperty)) {\n        const newProperty = createZeebeProperty(newBinding, newPropertyValue, bpmnFactory);\n\n        newProperty.$parent = zeebeProperties;\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: zeebeProperties,\n          properties: {\n            properties: [ ...zeebeProperties.get('properties'), newProperty ]\n          }\n        });\n      }\n    });\n\n    // (4) remove old zeebe:Property\n    if (oldZeebeProperties.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: zeebeProperties,\n        properties: {\n          properties: without(zeebeProperties.get('properties'), zeebeProperty => oldZeebeProperties.includes(zeebeProperty))\n        }\n      });\n    }\n  }\n\n  _updateMessage(element, oldTemplate, newTemplate) {\n\n    // update bpmn:Message properties\n    this._updateMessageProperties(element, oldTemplate, newTemplate);\n\n    // update bpmn:Message zeebe:subscription properties\n    this._updateMessageZeebeSubscriptionProperties(element, oldTemplate, newTemplate);\n\n    this._updateZeebeModelerTemplateOnReferencedElement(element, oldTemplate, newTemplate);\n\n    if (!hasMessageProperties(newTemplate)) {\n      removeMessage(element, this._injector);\n    }\n  }\n\n  /**\n   * Update bpmn:Message properties.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newTemplate\n   */\n  _updateMessageProperties(element, oldTemplate, newTemplate) {\n    const newProperties = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return newBindingType === MESSAGE_PROPERTY_TYPE;\n    });\n\n    const removedProperties = oldTemplate && oldTemplate.properties.filter((oldProperty) => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      return oldBindingType === MESSAGE_PROPERTY_TYPE && !newProperties.find((newProperty) => newProperty.binding.name === oldProperty.binding.name);\n    }) || [];\n\n    let message = this._getMessage(element);\n    message && removedProperties.forEach((removedProperty) => {\n\n      this._modeling.updateModdleProperties(element, message, {\n        [removedProperty.binding.name]: undefined\n      });\n    });\n\n    if (!newProperties.length) {\n      return;\n    }\n\n    message = this._getOrCreateMessage(element, newTemplate);\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            newBinding = newProperty.binding,\n            newBindingName = newBinding.name,\n            newPropertyValue = getDefaultValue(newProperty),\n            changedElement = message;\n\n      let properties = {};\n\n      if (shouldKeepValue(changedElement, oldProperty, newProperty)) {\n        return;\n      }\n\n      properties[ newBindingName ] = newPropertyValue;\n\n      this._modeling.updateModdleProperties(element, changedElement, properties);\n    });\n  }\n\n  /**\n   * Update bpmn:Message#zeebe:subscription properties.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newTemplate\n   */\n  _updateMessageZeebeSubscriptionProperties(element, oldTemplate, newTemplate) {\n    const newProperties = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return newBindingType === MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE;\n    });\n\n    const removedProperties = oldTemplate && oldTemplate.properties.filter((oldProperty) => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      return oldBindingType === MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE && !newProperties.find((newProperty) => newProperty.binding.name === oldProperty.binding.name);\n    }) || [];\n\n    if (!newProperties.length && !removedProperties.length) {\n      return;\n    }\n\n    let message = this._getMessage(element);\n\n    // no new properties and no message -> nothing to do\n    if (!newProperties.length && !message) {\n      return;\n    }\n\n    message = this._getOrCreateMessage(element, newTemplate);\n    const messageExtensionElements = this._getOrCreateExtensionElements(element, message);\n    const zeebeSubscription = this._getSubscription(element, message);\n\n    const propertiesToSet = newProperties.reduce((properties, newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            newBinding = newProperty.binding,\n            newBindingName = newBinding.name,\n            newPropertyValue = getDefaultValue(newProperty),\n            changedElement = zeebeSubscription;\n\n      if (shouldKeepValue(changedElement, oldProperty, newProperty)) {\n        return properties;\n      }\n\n      properties[ newBindingName ] = newPropertyValue;\n      return properties;\n    }, {});\n\n    // Update zeebe Subscription\n    if (zeebeSubscription) {\n      this._modeling.updateModdleProperties(element, zeebeSubscription,\n        propertiesToSet\n      );\n    } else {\n\n      // create new Subscription\n      const newSubscription = createElement('zeebe:Subscription', propertiesToSet, message, this._bpmnFactory);\n      this._modeling.updateModdleProperties(element, messageExtensionElements, {\n        values: [ ...messageExtensionElements.get('values'), newSubscription ]\n      });\n    }\n\n    // Remove old properties\n    if (!oldTemplate || !zeebeSubscription) {\n      return;\n    }\n\n    const propertiesToRemove = removedProperties.reduce((properties, removedProperty) => {\n      properties[ removedProperty.binding.name ] = undefined;\n      return properties;\n    }, {});\n\n    this._modeling.updateModdleProperties(element, zeebeSubscription,\n      propertiesToRemove\n    );\n  }\n\n  _updateZeebeModelerTemplateOnReferencedElement(element, oldTemplate, newTemplate) {\n    const businessObject = getBusinessObject(element);\n\n    const message = findMessage(businessObject);\n\n    if (!message) {\n      return;\n    }\n\n    if (getTemplateId(message) === newTemplate.id) {\n      return;\n    }\n\n    this._modeling.updateModdleProperties(element, message, {\n      'zeebe:modelerTemplate': newTemplate.id\n    });\n  }\n\n  _getSubscription(element, bo) {\n    const extensionElements = this._getOrCreateExtensionElements(element, bo);\n\n    const extension = findExtension(extensionElements, 'zeebe:Subscription');\n\n    if (extension) {\n      return extension;\n    }\n  }\n\n  _getOrCreateMessage(element, template) {\n    return this._getMessage(element) || this._createMessage(element, template);\n  }\n\n  _createMessage(element, template) {\n    let bo = getBusinessObject(element);\n\n    if (is(bo, 'bpmn:Event')) {\n      bo = bo.get('eventDefinitions')[0];\n    }\n\n    const message = this._bpmnFactory.create('bpmn:Message', { 'zeebe:modelerTemplate': template.id });\n\n    message.$parent = getRoot(bo);\n\n    this._modeling.updateModdleProperties(element, bo, { messageRef: message });\n\n    return message;\n  }\n\n  _getMessage(element) {\n    let bo = getBusinessObject(element);\n\n    if (is(bo, 'bpmn:Event')) {\n      bo = bo.get('eventDefinitions')[0];\n    }\n\n    return bo && bo.get('messageRef');\n  }\n\n\n\n  /**\n   * Update `zeebe:CalledElement` properties of specified business object. This\n   * can only exist in `bpmn:ExtensionElements`.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newTemplate\n   */\n  _updateCalledElement(element, oldTemplate, newTemplate) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    const newProperties = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return newBindingType === ZEEBE_CALLED_ELEMENT;\n    });\n\n    const businessObject = this._getOrCreateExtensionElements(element);\n    let calledElement = findExtension(businessObject, 'zeebe:CalledElement');\n\n    // (1) remove old called element if no new properties specified\n    if (!newProperties.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties: {\n          values: without(businessObject.get('values'), calledElement)\n        }\n      });\n\n      return;\n    }\n\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            newPropertyValue = getDefaultValue(newProperty),\n            propertyName = newProperty.binding.property;\n\n      // (2) update old called element\n      if (calledElement) {\n\n        if (!shouldKeepValue(calledElement, oldProperty, newProperty)) {\n          const properties = {\n            [propertyName]: newPropertyValue\n          };\n\n          commandStack.execute('element.updateModdleProperties', {\n            element,\n            moddleElement: calledElement,\n            properties\n          });\n        }\n      }\n\n      // (3) add new called element\n      else {\n        const properties = {\n          [propertyName]: newPropertyValue\n        };\n\n        calledElement = createCalledElement(properties, bpmnFactory);\n\n        calledElement.$parent = businessObject;\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: businessObject,\n          properties: {\n            values: [ ...businessObject.get('values'), calledElement ]\n          }\n        });\n      }\n    });\n\n    // (4) remove properties no longer templated\n    const oldProperties = oldTemplate && oldTemplate.properties.filter((oldProperty) => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      return oldBindingType === ZEEBE_CALLED_ELEMENT && !newProperties.find(\n        (newProperty) => newProperty.binding.property === oldProperty.binding.property\n      );\n    }) || [];\n\n    oldProperties.forEach((oldProperty) => {\n      const properties = {\n        [oldProperty.binding.property]: undefined\n      };\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: calledElement,\n        properties\n      });\n    });\n  }\n\n  /**\n   * Replaces the element with the specified elementType.\n   * Takes into account the eventDefinition for events.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} newTemplate\n   */\n  _updateElementType(element, oldTemplate, newTemplate) {\n\n    // determine new task type\n    const newType = newTemplate.elementType;\n\n    if (!newType) {\n      return element;\n    }\n\n\n    // Do not replace if the element type did not change\n    if (!shouldUpdateElementType(element, oldTemplate, newType)) {\n      return element;\n    }\n\n    const replacement = { type: newType.value };\n\n    if (newType.eventDefinition) {\n      replacement.eventDefinitionType = newType.eventDefinition;\n    }\n\n    const replacedElement = this._bpmnReplace.replaceElement(element, replacement);\n\n    return replacedElement;\n  }\n\n\n  _updateLinkedResources(element, oldTemplate, newTemplate) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    const newLinkedResources = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return newBindingType === 'zeebe:linkedResource';\n    });\n\n    const extensionElements = this._getOrCreateExtensionElements(element);\n\n    let linkedResources = findExtension(extensionElements, 'zeebe:LinkedResources');\n\n    // (1) remove linkedResourcess if no new specified\n    if (!newLinkedResources.length) {\n      if (!linkedResources) {\n        return;\n      }\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: extensionElements,\n        properties: {\n          values: without(extensionElements.get('values'), linkedResources)\n        }\n      });\n      return;\n    }\n\n    if (!linkedResources) {\n      linkedResources = bpmnFactory.create('zeebe:LinkedResources');\n\n      linkedResources.$parent = extensionElements;\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: extensionElements,\n        properties: {\n          values: [ ...extensionElements.get('values'), linkedResources ]\n        }\n      });\n    }\n\n    const unusedLinkedResources = linkedResources.get('values').slice();\n    const unusedResourceProperties = (oldTemplate?.properties.slice() || [])\n      .filter((property) => property.binding.type === ZEEBE_LINKED_RESOURCE_PROPERTY);\n\n    newLinkedResources.forEach((newLinkedResource) => {\n      const oldProperty = findOldProperty(oldTemplate, newLinkedResource),\n            oldLinkedResource = findBusinessObject(extensionElements, newLinkedResource),\n            newPropertyValue = getDefaultValue(newLinkedResource),\n            newBinding = newLinkedResource.binding;\n\n      if (oldProperty) {\n        remove(unusedResourceProperties, oldProperty);\n      }\n\n      // (2) update old LinkesResources\n      if (oldLinkedResource) {\n        if (\n          shouldUpdate(newPropertyValue, newLinkedResource)\n          || shouldKeepValue(oldLinkedResource, oldProperty, newLinkedResource)\n        ) {\n          remove(unusedLinkedResources, oldLinkedResource);\n        }\n\n        if (!shouldKeepValue(oldLinkedResource, oldProperty, newLinkedResource)) {\n          commandStack.execute('element.updateModdleProperties', {\n            element,\n            moddleElement: oldLinkedResource,\n            properties: {\n              [newBinding.property]: newPropertyValue\n            }\n          });\n        }\n      }\n\n      // (3) add new linkedResources\n      else if (shouldUpdate(newPropertyValue, newLinkedResource)) {\n        const newProperties = {\n          linkName: newBinding.linkName,\n          [newBinding.property]: newPropertyValue\n        };\n\n        const newLinkedResource = createElement('zeebe:LinkedResource', newProperties, extensionElements, bpmnFactory);\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: linkedResources,\n          properties: {\n            values: [ ...linkedResources.get('values'), newLinkedResource ]\n          }\n        });\n      }\n    });\n\n\n    // (4) remove unused linkedResources\n    if (unusedLinkedResources.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: linkedResources,\n        properties: {\n          values: without(linkedResources.get('values'), linkedResource => unusedLinkedResources.includes(linkedResource))\n        }\n      });\n    }\n\n    // (5) remove unused resource properties\n    unusedResourceProperties.forEach((unusedResourceProperty) => {\n      const oldLinkedResource = findBusinessObject(extensionElements, unusedResourceProperty);\n\n      const oldBinding = unusedResourceProperty.binding;\n\n      // No property was reused and element was removed in previous step\n      if (!oldLinkedResource) {\n        return;\n      }\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: oldLinkedResource,\n        properties: {\n          [oldBinding.property]: undefined\n        }\n      });\n    });\n  }\n\n}\n\nChangeElementTemplateHandler.$inject = [\n  'bpmnFactory',\n  'bpmnReplace',\n  'commandStack',\n  'modeling',\n  'injector'\n];\n\n\n// helpers //////////\n\n/**\n * Find business object matching specified property.\n *\n * @param {djs.model.Base|ModdleElement} element\n * @param {Object} property\n *\n * @returns {ModdleElement}\n */\nfunction findBusinessObject(element, property) {\n  const businessObject = getBusinessObject(element);\n\n  const binding = property.binding,\n        bindingType = binding.type;\n\n  if (TASK_DEFINITION_TYPES.includes(bindingType)) {\n    return findExtension(businessObject, 'zeebe:TaskDefinition');\n  }\n\n  if (bindingType === 'zeebe:input' || bindingType === 'zeebe:output') {\n\n    const extensionElements = findExtension(businessObject, 'zeebe:IoMapping');\n\n    if (!extensionElements) {\n      return;\n    }\n\n    if (bindingType === 'zeebe:input') {\n      return find(extensionElements.get('zeebe:inputParameters'), function(input) {\n        return input.get('zeebe:target') === binding.name;\n      });\n    } else {\n      return find(extensionElements.get('zeebe:outputParameters'), function(output) {\n        return output.get('zeebe:source') === binding.source;\n      });\n    }\n\n  }\n\n  if (bindingType === 'zeebe:taskHeader') {\n    const extensionElements = findExtension(businessObject, 'zeebe:TaskHeaders');\n\n    if (!extensionElements) {\n      return;\n    }\n\n    return find(extensionElements.get('zeebe:values'), function(value) {\n      return value.get('zeebe:key') === binding.key;\n    });\n  }\n\n  if (bindingType === 'zeebe:property') {\n    const zeebeProperties = findExtension(businessObject, 'zeebe:Properties');\n\n    if (!zeebeProperties) {\n      return;\n    }\n\n    return zeebeProperties.get('properties').find((value) => {\n      return value.get('name') === binding.name;\n    });\n  }\n\n  if (bindingType === ZEEBE_LINKED_RESOURCE_PROPERTY) {\n    const linkedResources = findExtension(businessObject, 'zeebe:LinkedResources');\n\n    if (!linkedResources) {\n      return;\n    }\n\n    return linkedResources.get('values').find((value) => {\n      return value.get('linkName') === binding.linkName;\n    });\n  }\n}\n\n/**\n * Find old property matching specified new property.\n *\n * @param {Object} oldTemplate\n * @param {Object} newProperty\n *\n * @returns {Object}\n */\nexport function findOldProperty(oldTemplate, newProperty) {\n  if (!oldTemplate) {\n    return;\n  }\n\n  const oldProperties = oldTemplate.properties,\n        newBinding = newProperty.binding,\n        newBindingName = newBinding.name,\n        newBindingType = newBinding.type;\n\n  if (newBindingType === 'property') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingName = oldBinding.name,\n            oldBindingType = oldBinding.type;\n\n      return oldBindingType === 'property' && oldBindingName === newBindingName;\n    });\n  }\n\n  if (TASK_DEFINITION_TYPES.includes(newBindingType)) {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldPropertyName = getTaskDefinitionPropertyName(oldBinding),\n            newPropertyName = getTaskDefinitionPropertyName(newBinding);\n\n      return oldPropertyName === newPropertyName;\n    });\n  }\n\n  if (newBindingType === 'zeebe:input') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingName = oldBinding.name,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== 'zeebe:input') {\n        return;\n      }\n\n      return oldBindingName === newBindingName;\n    });\n  }\n\n  if (newBindingType === 'zeebe:output') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== 'zeebe:output') {\n        return;\n      }\n\n      return oldBinding.source === newBinding.source;\n    });\n  }\n\n  if (newBindingType === 'zeebe:taskHeader') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== 'zeebe:taskHeader') {\n        return;\n      }\n\n      return oldBinding.key === newBinding.key;\n    });\n  }\n\n  if (newBindingType === 'zeebe:property') {\n    return oldProperties.find((oldProperty) => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== 'zeebe:property') {\n        return;\n      }\n\n      return oldBinding.name === newBinding.name;\n    });\n  }\n\n  if (newBindingType === MESSAGE_PROPERTY_TYPE) {\n    return oldProperties.find(oldProperty => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== MESSAGE_PROPERTY_TYPE) {\n        return;\n      }\n\n      return oldBinding.name === newBinding.name;\n    });\n  }\n\n  if (newBindingType === MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE) {\n    return oldProperties.find(oldProperty => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE) {\n        return;\n      }\n\n      return oldBinding.name === newBinding.name;\n    });\n  }\n\n  if (newBindingType === ZEEBE_LINKED_RESOURCE_PROPERTY) {\n    return oldProperties.find(oldProperty => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== ZEEBE_LINKED_RESOURCE_PROPERTY) {\n        return;\n      }\n\n      return oldBinding.linkName === newBinding.linkName && oldBinding.property === newBinding.property;\n    });\n  }\n}\n\n/**\n * Check whether the existing property should be kept. This is the case if\n *  - an old template was set and the value differs from the default\n *  - no template was set but the property was set manually\n *\n * @param {djs.model.Base|ModdleElement} element\n * @param {Object} oldProperty\n * @param {Object} newProperty\n *\n * @returns {boolean}\n */\nfunction shouldKeepValue(element, oldProperty, newProperty) {\n\n  // \"Hidden\" values are treated as a constant\n  if (newProperty.type === 'Hidden') {\n    return false;\n  }\n\n  // Dropdowns should keep existing configuration\n  // cf. https://github.com/bpmn-io/bpmn-js-properties-panel/issues/767\n  if (newProperty.type === 'Dropdown') {\n\n    const currentValue = getPropertyValue(element, newProperty);\n\n    // only keep value if old value is a valid option\n    return newProperty.choices && newProperty.choices.some(\n      (choice) => choice.value === currentValue\n    );\n  }\n\n  // keep existing old property if\n  // user changed it from the original\n  if (oldProperty) {\n    return propertyChanged(element, oldProperty);\n  }\n\n  // keep existing property value\n  return !!(getPropertyValue(element, newProperty));\n}\n\n/**\n * Check whether property was changed after being set by template.\n *\n * @param {djs.model.Base|ModdleElement} element\n * @param {Object} oldProperty\n *\n * @returns {boolean}\n */\nfunction propertyChanged(element, oldProperty) {\n  const oldPropertyValue = oldProperty.value;\n\n  return getPropertyValue(element, oldProperty) !== oldPropertyValue;\n}\n\nfunction getPropertyValue(element, property) {\n  const businessObject = getBusinessObject(element);\n\n  if (!businessObject) {\n    return;\n  }\n\n  const binding = property.binding,\n        bindingName = binding.name,\n        bindingType = binding.type,\n        bindingProperty = binding.property;\n\n\n  if (bindingType === 'property') {\n    return businessObject.get(bindingName);\n  }\n\n  if (TASK_DEFINITION_TYPES.includes(bindingType)) {\n    return businessObject.get(getTaskDefinitionPropertyName(binding));\n  }\n\n  if (bindingType === 'zeebe:input') {\n    return businessObject.get('zeebe:source');\n  }\n\n  if (bindingType === 'zeebe:output') {\n    return businessObject.get('zeebe:target');\n  }\n\n  if (bindingType === 'zeebe:taskHeader') {\n    return businessObject.get('zeebe:value');\n  }\n\n  if (bindingType === 'zeebe:property') {\n    return businessObject.get('zeebe:value');\n  }\n\n  if (bindingType === MESSAGE_PROPERTY_TYPE) {\n    return businessObject.get(bindingName);\n  }\n\n  if (bindingType === MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE) {\n    return businessObject.get(bindingName);\n  }\n\n  if (bindingType === ZEEBE_LINKED_RESOURCE_PROPERTY) {\n    return businessObject.get(bindingProperty);\n  }\n}\n\nfunction remove(array, item) {\n  const index = array.indexOf(item);\n\n  if (index < 0) {\n    return array;\n  }\n\n  array.splice(index, 1);\n\n  return array;\n}\n\n\nfunction hasMessageProperties(template) {\n  return template.properties.some(p => MESSAGE_BINDING_TYPES.includes(p.binding.type));\n}\n\nfunction shouldUpdateElementType(element, oldTemplate, newType) {\n\n  // Never reuse existing eventDefinition when applying a new template\n  if (!oldTemplate && newType.eventDefinition) {\n    return true;\n  }\n\n  const oldType = oldTemplate && oldTemplate.elementType || {\n    value: element.type,\n    eventDefinition: getEventDefinitionType(element)\n  };\n\n  // Do not update if the element type did not change\n  if (oldType && oldType.value === newType.value && oldType.eventDefinition === newType.eventDefinition) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction getEventDefinitionType(element) {\n  const businessObject = getBusinessObject(element);\n  if (!businessObject.eventDefinitions) {\n    return;\n  }\n\n  const eventDefinition = businessObject.eventDefinitions[ 0 ];\n\n  if (!eventDefinition) {\n    return;\n  }\n\n  return eventDefinition.$type;\n}","import { getLabel, setLabel } from 'bpmn-js/lib/features/label-editing/LabelUtil';\nimport { getShapeIdFromPlane, isPlane } from 'bpmn-js/lib/util/DrilldownUtil';\nimport { getBusinessObject, is } from 'bpmn-js/lib/util/ModelUtil';\n\nexport default class RemoveElementTemplateHandler {\n  constructor(\n      modeling,\n      elementFactory,\n      elementRegistry,\n      canvas,\n      bpmnFactory,\n      replace,\n      commandStack,\n      moddleCopy\n  ) {\n    this._modeling = modeling;\n    this._elementFactory = elementFactory;\n    this._elementRegistry = elementRegistry;\n    this._canvas = canvas;\n    this._bpmnFactory = bpmnFactory;\n    this._replace = replace;\n    this._commandStack = commandStack;\n    this._moddleCopy = moddleCopy;\n  }\n\n  preExecute(context) {\n    const {\n      element\n    } = context;\n\n    if (element.parent) {\n      context.newElement = this._removeTemplate(element);\n    } else {\n      context.newElement = this._removeRootTemplate(element);\n    }\n  }\n\n  _removeTemplate(element) {\n    const replace = this._replace;\n\n    const businessObject = getBusinessObject(element);\n\n    const type = businessObject.$type,\n          eventDefinitionType = this._getEventDefinitionType(businessObject);\n\n    const newBusinessObject = this._createNewBusinessObject(element);\n\n    return replace.replaceElement(element,\n      {\n        type: type,\n        businessObject: newBusinessObject,\n        eventDefinitionType: eventDefinitionType,\n      },\n      {\n        createElementsBehavior: false\n      }\n    );\n  }\n\n  /**\n   * Remove template from a given element.\n   *\n   * @param {djs.model.Base} element\n   *\n   * @return {djs.model.Base} the updated element\n   */\n  _removeRootTemplate(element) {\n    var modeling = this._modeling,\n        elementFactory = this._elementFactory,\n        elementRegistry = this._elementRegistry,\n        canvas = this._canvas;\n\n    // We are inside a collapsed subprocess, move up to the parent before replacing the collapsed object\n    if (isPlane(element)) {\n      const shapeId = getShapeIdFromPlane(element);\n      const shape = elementRegistry.get(shapeId);\n\n      if (shape && shape !== element) {\n        canvas.setRootElement(canvas.findRoot(shape));\n        return this._removeTemplate(shape);\n      }\n    }\n\n    const businessObject = getBusinessObject(element);\n\n    const type = businessObject.$type;\n\n    const newBusinessObject = this._createNewBusinessObject(element);\n\n    const newRoot = elementFactory.create('root', {\n      type: type,\n      businessObject: newBusinessObject\n    });\n\n    this._commandStack.execute('canvas.updateRoot', {\n      newRoot: newRoot,\n      oldRoot: element\n    });\n\n    modeling.moveElements(element.children, { x: 0, y: 0 }, newRoot);\n\n    return newRoot;\n  }\n\n  _getEventDefinitionType(businessObject) {\n    if (!businessObject.eventDefinitions) {\n      return null;\n    }\n\n    const eventDefinition = businessObject.eventDefinitions[ 0 ];\n\n    if (!eventDefinition) {\n      return null;\n    }\n\n    return eventDefinition.$type;\n  }\n\n  _createNewBusinessObject(element) {\n    const bpmnFactory = this._bpmnFactory;\n\n    const bo = getBusinessObject(element),\n          newBo = bpmnFactory.create(bo.$type),\n          label = getLabel(element);\n\n    // Make we we keep general properties unrelated to the template.\n    this._copyProperties(bo, newBo, [ 'documentation' ]);\n    this._copyExtensionElements(bo, newBo, [ 'zeebe:ExecutionListeners' ]);\n\n    if (!label) {\n      return newBo;\n    }\n\n    if (is(element, 'bpmn:Group')) {\n      newBo.categoryValueRef = bpmnFactory.create('bpmn:CategoryValue');\n    }\n\n    setLabel({ businessObject: newBo }, label);\n\n    return newBo;\n  }\n\n  /**\n   * Copy specified properties to the target business object.\n   *\n   * @param {ModdleElement} source\n   * @param {ModdleElement} target\n   * @param {Array<string>} properties\n   */\n  _copyProperties(source, target, properties) {\n    const copy = this._moddleCopy;\n\n    properties.forEach(propertyName => {\n\n      const property = source.get(propertyName);\n\n      if (property) {\n        const propertyCopy = copy.copyProperty(property, target, propertyName);\n        target.set(propertyName, propertyCopy);\n      }\n    });\n  }\n\n  /**\n   * Copy extension elements of specified types to the target business object.\n   *\n   * @param {ModdleElement} source\n   * @param {ModdleElement} target\n   * @param {Array<string>} extensionElements\n   */\n  _copyExtensionElements(source, target, extensionElements) {\n    const bpmnFactory = this._bpmnFactory;\n\n    // No extension elements in the source business object.\n    if (!source.extensionElements || !source.extensionElements.values) return;\n\n    const newExtensionElements = source.extensionElements.values.filter(value =>\n      extensionElements.some(extensionElement => is(value, extensionElement))\n    );\n\n    // Nothing to copy.\n    if (!newExtensionElements.length) return;\n\n    target.extensionElements = bpmnFactory.create('bpmn:ExtensionElements', { values: newExtensionElements });\n  }\n}\n\n\nRemoveElementTemplateHandler.$inject = [\n  'modeling',\n  'elementFactory',\n  'elementRegistry',\n  'canvas',\n  'bpmnFactory',\n  'replace',\n  'commandStack',\n  'moddleCopy'\n];\n","import {\n  forEach\n} from 'min-dash';\n\n/**\n * A handler that combines and executes multiple commands.\n *\n * All updates are bundled on the command stack and executed in one step.\n * This also makes it possible to revert the changes in one step.\n *\n * Example use case: remove the camunda:formKey attribute and in addition\n * add all form fields needed for the camunda:formData property.\n */\nexport default class MultiCommandHandler {\n  constructor(commandStack) {\n    this._commandStack = commandStack;\n  }\n\n  preExecute(context) {\n    const commandStack = this._commandStack;\n\n    forEach(context, function(command) {\n      commandStack.execute(command.cmd, command.context);\n    });\n  }\n}\n\nMultiCommandHandler.$inject = [ 'commandStack' ];","import ChangeElementTemplateHandler from './ChangeElementTemplateHandler';\nimport RemoveElementTemplateHandler from './RemoveElementTemplateHandler';\nimport MultiCommandHandler from '../../element-templates/cmd/MultiCommandHandler';\n\nexport default class ElementTemplatesCommands {\n  constructor(commandStack, elementTemplates, eventBus) {\n    commandStack.registerHandler(\n      'element-templates.multi-command-executor',\n      MultiCommandHandler\n    );\n\n    commandStack.registerHandler(\n      'propertiesPanel.zeebe.changeTemplate',\n      ChangeElementTemplateHandler\n    );\n\n    commandStack.registerHandler(\n      'propertiesPanel.removeTemplate',\n      RemoveElementTemplateHandler\n    );\n\n    // apply default element templates on shape creation\n    eventBus.on([ 'commandStack.shape.create.postExecuted' ], function(event) {\n      const {\n        context: {\n          hints = {},\n          shape\n        }\n      } = event;\n\n      if (hints.createElementsBehavior !== false) {\n        applyDefaultTemplate(shape, elementTemplates, commandStack);\n      }\n    });\n\n    // apply default element templates on connection creation\n    eventBus.on([ 'commandStack.connection.create.postExecuted' ], function(event) {\n      const {\n        context: {\n          hints = {},\n          connection\n        }\n      } = event;\n\n      if (hints.createElementsBehavior !== false) {\n        applyDefaultTemplate(connection, elementTemplates, commandStack);\n      }\n    });\n  }\n}\n\nElementTemplatesCommands.$inject = [ 'commandStack', 'elementTemplates', 'eventBus' ];\n\nfunction applyDefaultTemplate(element, elementTemplates, commandStack) {\n\n  if (!elementTemplates.get(element) && elementTemplates.getDefault(element)) {\n\n    const command = 'propertiesPanel.zeebe.changeTemplate';\n    const commandContext = {\n      element: element,\n      newTemplate: elementTemplates.getDefault(element)\n    };\n\n    commandStack.execute(command, commandContext);\n  }\n}","import ElementTemplateCommands from './ElementTemplateCommands';\n\nexport default {\n  __init__: [ 'elementTemplateCommands' ],\n  elementTemplateCommands: [ 'type', ElementTemplateCommands ]\n};","import { getBusinessObject } from 'bpmn-js/lib/util/ModelUtil';\nimport { getDefaultValue } from '../Helper';\n\n\nexport default class PropertyBindingProvider {\n  static create(element, options) {\n    const {\n      property\n    } = options;\n\n    const {\n      binding\n    } = property;\n\n    const {\n      name\n    } = binding;\n\n    const value = getDefaultValue(property);\n\n    const businessObject = getBusinessObject(element);\n\n    businessObject[name] = value;\n  }\n}","import {\n  ensureExtension\n} from '../CreateHelper';\nimport { getDefaultValue } from '../Helper';\n\nimport {\n  getTaskDefinitionPropertyName\n} from '../util/taskDefinition';\n\n\nexport default class TaskDefinitionTypeBindingProvider {\n  static create(element, options) {\n    const {\n      property,\n      bpmnFactory\n    } = options;\n\n    const value = getDefaultValue(property);\n    const propertyName = getTaskDefinitionPropertyName(property.binding);\n\n    const taskDefinition = ensureExtension(element, 'zeebe:TaskDefinition', bpmnFactory);\n    taskDefinition.set(propertyName, value);\n  }\n}\n","import {\n  createInputParameter,\n  ensureExtension,\n  shouldUpdate\n} from '../CreateHelper';\n\nimport { getDefaultValue } from '../Helper';\n\n\nexport default class InputBindingProvider {\n  static create(element, options) {\n    const {\n      property,\n      bpmnFactory\n    } = options;\n\n    const {\n      binding\n    } = property;\n\n    const value = getDefaultValue(property);\n\n    const ioMapping = ensureExtension(element, 'zeebe:IoMapping', bpmnFactory);\n\n    if (!shouldUpdate(value, property)) {\n      return;\n    }\n\n    const input = createInputParameter(binding, value, bpmnFactory);\n    input.$parent = ioMapping;\n    ioMapping.get('inputParameters').push(input);\n  }\n}","import {\n  createOutputParameter,\n  ensureExtension,\n  shouldUpdate\n} from '../CreateHelper';\nimport { getDefaultValue } from '../Helper';\n\n\nexport default class OutputBindingProvider {\n  static create(element, options) {\n    const {\n      property,\n      bpmnFactory\n    } = options;\n\n    const {\n      binding\n    } = property;\n\n    const value = getDefaultValue(property);\n\n    const ioMapping = ensureExtension(element, 'zeebe:IoMapping', bpmnFactory);\n\n    if (!shouldUpdate(value, property)) {\n      return;\n    }\n\n    const output = createOutputParameter(binding, value, bpmnFactory);\n    output.$parent = ioMapping;\n    ioMapping.get('outputParameters').push(output);\n  }\n}","import {\n  createTaskHeader,\n  ensureExtension\n} from '../CreateHelper';\nimport { getDefaultValue } from '../Helper';\n\n\nexport default class TaskHeaderBindingProvider {\n  static create(element, options) {\n    const {\n      property,\n      bpmnFactory\n    } = options;\n\n    const {\n      binding\n    } = property;\n\n    const value = getDefaultValue(property);\n\n    const taskHeaders = ensureExtension(element, 'zeebe:TaskHeaders', bpmnFactory);\n\n    const header = createTaskHeader(binding, value, bpmnFactory);\n    header.$parent = taskHeaders;\n    taskHeaders.get('values').push(header);\n  }\n}","import {\n  createZeebeProperty,\n  ensureExtension,\n  shouldUpdate\n} from '../CreateHelper';\nimport { getDefaultValue } from '../Helper';\n\n\nexport default class ZeebePropertiesProvider {\n  static create(element, options) {\n    const {\n      property,\n      bpmnFactory\n    } = options;\n\n    const {\n      binding,\n    } = property;\n\n    const value = getDefaultValue(property);\n\n    const zeebeProperties = ensureExtension(element, 'zeebe:Properties', bpmnFactory);\n\n    if (!shouldUpdate(value, property)) {\n      return;\n    }\n\n    const zeebeProperty = createZeebeProperty(binding, value, bpmnFactory);\n    zeebeProperty.$parent = zeebeProperties;\n    zeebeProperties.get('properties').push(zeebeProperty);\n  }\n}","import { getBusinessObject, is } from 'bpmn-js/lib/util/ModelUtil';\nimport { getDefaultValue, getTemplateId } from '../Helper';\n\nexport class MessagePropertyBindingProvider {\n  static create(element, options) {\n    const {\n      bpmnFactory,\n      property\n    } = options;\n\n    const {\n      binding\n    } = property;\n\n    const {\n      name\n    } = binding;\n\n    const value = getDefaultValue(property);\n\n    let businessObject = getBusinessObject(element);\n\n    if (is(businessObject, 'bpmn:Event')) {\n      businessObject = businessObject.get('eventDefinitions')[0];\n    }\n\n    let message = businessObject.get('messageRef');\n\n    if (!message) {\n      message = bpmnFactory.create('bpmn:Message', { 'zeebe:modelerTemplate': getTemplateId(element) });\n      businessObject.set('messageRef', message);\n    }\n\n    message.set(name, value);\n  }\n}\n","import { getBusinessObject, is } from 'bpmn-js/lib/util/ModelUtil';\n\nimport {\n  ensureExtension,\n  shouldUpdate\n} from '../CreateHelper';\nimport { getDefaultValue, getTemplateId } from '../Helper';\n\nexport class MessageZeebeSubscriptionBindingProvider {\n  static create(element, options) {\n    const {\n      bpmnFactory,\n      property\n    } = options;\n\n    const {\n      binding\n    } = property;\n\n    const {\n      name\n    } = binding;\n\n    const value = getDefaultValue(property);\n\n    let businessObject = getBusinessObject(element);\n    if (is(businessObject, 'bpmn:Event')) {\n      businessObject = businessObject.get('eventDefinitions')[0];\n    }\n\n    let message = businessObject.get('messageRef');\n    if (!message) {\n      message = bpmnFactory.create('bpmn:Message', { 'zeebe:modelerTemplate': getTemplateId(element) });\n      businessObject.set('messageRef', message);\n    }\n\n    const subscription = ensureExtension(message, 'zeebe:Subscription', bpmnFactory);\n\n    if (!shouldUpdate(value, property)) {\n      return;\n    }\n\n    subscription.set(name, value);\n  }\n}\n","import {\n  ensureExtension\n} from '../CreateHelper';\nimport { getDefaultValue } from '../Helper';\n\n\nexport class CalledElementBindingProvider {\n  static create(element, options) {\n    const {\n      property,\n      bpmnFactory\n    } = options;\n\n    const {\n      binding\n    } = property;\n\n    const {\n      property: propertyName\n    } = binding;\n\n    const value = getDefaultValue(property);\n\n    const calledElement = ensureExtension(element, 'zeebe:CalledElement', bpmnFactory);\n\n    // TODO(@barmac): remove if we decide to support propagation in templates\n    ensureNoPropagation(calledElement);\n\n    calledElement.set(propertyName, value);\n  }\n}\n\nfunction ensureNoPropagation(calledElement) {\n  calledElement.set('propagateAllChildVariables', false);\n  calledElement.set('propagateAllParentVariables', false);\n}\n","import { getBusinessObject } from 'bpmn-js/lib/util/ModelUtil';\nimport { createElement } from '../../utils/ElementUtil';\n\nimport {\n  ensureExtension\n} from '../CreateHelper';\nimport { getDefaultValue } from '../Helper';\n\n\nexport default class LinkedResourcePropertyBindingProvider {\n  static create(element, options) {\n    const {\n      property,\n      bpmnFactory\n    } = options;\n\n    const {\n      binding: {\n        property: bindingProperty,\n        linkName\n      }\n    } = property;\n\n    const value = getDefaultValue(property);\n\n    const bo = getBusinessObject(element);\n    const linkedResources = ensureExtension(element, 'zeebe:LinkedResources', bpmnFactory);\n\n    let linkedResource = linkedResources.get('values').find(linkedResource => linkedResource.get('linkName') === linkName);\n\n    if (!linkedResource) {\n      linkedResource = createElement('zeebe:LinkedResource', { linkName }, bo, bpmnFactory);\n      linkedResources.get('values').push(linkedResource);\n    }\n\n    linkedResource.set(bindingProperty, value);\n  }\n}\n","import {\n  getBusinessObject,\n  is\n} from 'bpmn-js/lib/util/ModelUtil';\n\nimport {\n  isString,\n  isUndefined, without\n} from 'min-dash';\n\nimport {\n  EXTENSION_BINDING_TYPES,\n  IO_BINDING_TYPES,\n  MESSAGE_BINDING_TYPES,\n  MESSAGE_PROPERTY_TYPE,\n  MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE,\n  PROPERTY_BINDING_TYPES,\n  TASK_DEFINITION_TYPES,\n  ZEEBE_TASK_DEFINITION_TYPE_TYPE,\n  ZEEBE_TASK_DEFINITION,\n  ZEBBE_INPUT_TYPE,\n  ZEEBE_OUTPUT_TYPE,\n  ZEEBE_PROPERTY_TYPE,\n  ZEEBE_TASK_HEADER_TYPE,\n  ZEEBE_CALLED_ELEMENT,\n  ZEEBE_LINKED_RESOURCE_PROPERTY\n} from './bindingTypes';\n\nimport {\n  getTaskDefinitionPropertyName\n} from './taskDefinition';\n\nimport {\n  findExtension,\n  findTaskHeader,\n  findInputParameter,\n  findMessage,\n  findOutputParameter,\n  findZeebeProperty,\n  findZeebeSubscription,\n  getTemplateId\n} from '../Helper';\n\nimport {\n  createInputParameter,\n  createOutputParameter,\n  createTaskDefinition,\n  createTaskHeader,\n  createZeebeProperty,\n  shouldUpdate\n} from '../CreateHelper';\n\nimport { createElement } from '../../utils/ElementUtil';\n\nconst PRIMITIVE_MODDLE_TYPES = [\n  'Boolean',\n  'Integer',\n  'String'\n];\n\nexport function getPropertyValue(element, property, scope) {\n  const rawValue = getRawPropertyValue(element, property, scope);\n\n  const { type } = property;\n\n  if (type === 'Boolean') {\n    return getBooleanPropertyValue(rawValue);\n  }\n\n  return rawValue;\n}\n\nfunction getRawPropertyValue(element, property, scope) {\n  let businessObject = getBusinessObject(element);\n\n  const defaultValue = '';\n\n  const {\n    binding\n  } = property;\n\n  const {\n    name,\n    property: bindingProperty,\n    type,\n    linkName\n  } = binding;\n\n  // property\n  if (type === 'property') {\n    const value = businessObject.get(name);\n\n    if (!isUndefined(value)) {\n      return value;\n    }\n\n    return defaultValue;\n  }\n\n  // zeebe:taskDefinition\n  if (TASK_DEFINITION_TYPES.includes(type)) {\n\n    const taskDefinition = findExtension(businessObject, 'zeebe:TaskDefinition');\n\n    if (taskDefinition) {\n      if (type === ZEEBE_TASK_DEFINITION_TYPE_TYPE) {\n        return taskDefinition.get('type');\n      } else if (type === ZEEBE_TASK_DEFINITION) {\n        return taskDefinition.get(bindingProperty);\n      }\n    }\n\n    return defaultValue;\n  }\n\n  if (IO_BINDING_TYPES.includes(type)) {\n    const ioMapping = findExtension(businessObject, 'zeebe:IoMapping');\n\n    if (!ioMapping) {\n      return defaultValue;\n    }\n\n    // zeebe:Input\n    if (type === ZEBBE_INPUT_TYPE) {\n      const inputParameter = findInputParameter(ioMapping, binding);\n\n      if (inputParameter) {\n        return inputParameter.get('source');\n      }\n\n      return defaultValue;\n    }\n\n    // zeebe:Output\n    if (type === ZEEBE_OUTPUT_TYPE) {\n      const outputParameter = findOutputParameter(ioMapping, binding);\n\n      if (outputParameter) {\n        return outputParameter.get('target');\n      }\n\n      return defaultValue;\n    }\n  }\n\n  // zeebe:taskHeaders\n  if (type === ZEEBE_TASK_HEADER_TYPE) {\n    const taskHeaders = findExtension(businessObject, 'zeebe:TaskHeaders');\n\n    if (!taskHeaders) {\n      return defaultValue;\n    }\n\n    const header = findTaskHeader(taskHeaders, binding);\n\n    if (header) {\n      return header.get('value');\n    }\n\n    return defaultValue;\n  }\n\n  // zeebe:Property\n  if (type === ZEEBE_PROPERTY_TYPE) {\n    const zeebeProperties = findExtension(businessObject, 'zeebe:Properties');\n\n    if (zeebeProperties) {\n      const zeebeProperty = findZeebeProperty(zeebeProperties, binding);\n\n      if (zeebeProperty) {\n        return zeebeProperty.get('value');\n      }\n    }\n\n    return defaultValue;\n  }\n\n  // bpmn:Message#property\n  if (type === MESSAGE_PROPERTY_TYPE) {\n    const message = findMessage(businessObject);\n\n    const value = message ? message.get(name) : undefined;\n\n    if (!isUndefined(value)) {\n      return value;\n    }\n\n    return defaultValue;\n  }\n\n  // bpmn:Message#zeebe:subscription#property\n  if (type === MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE) {\n    const message = findMessage(businessObject);\n\n    if (message) {\n      const subscription = findExtension(message, 'zeebe:Subscription');\n\n      const value = subscription ? subscription.get(name) : undefined;\n\n      if (!isUndefined(value)) {\n        return subscription.get(name);\n      }\n    }\n\n    return defaultValue;\n  }\n\n  // zeebe:calledElement\n  if (type === ZEEBE_CALLED_ELEMENT) {\n    const calledElement = findExtension(businessObject, 'zeebe:CalledElement');\n\n    return calledElement ? calledElement.get(bindingProperty) : defaultValue;\n  }\n\n  if (type === ZEEBE_LINKED_RESOURCE_PROPERTY) {\n    const linkedResources = findExtension(businessObject, 'zeebe:LinkedResources');\n\n    if (!linkedResources) {\n      return defaultValue;\n    }\n\n    const linkedResource = linkedResources.get('values').find((value) => value.get('linkName') === linkName);\n\n    return linkedResource ? linkedResource.get(bindingProperty) : defaultValue;\n  }\n\n  // should never throw as templates are validated beforehand\n  throw unknownBindingError(element, property);\n}\n\n/**\n * Cast a string value to a boolean if possible. Otherwise return the value.\n * Cannot always cast due to FEEL expressions.\n *\n * @param {string|boolean} value\n */\nfunction getBooleanPropertyValue(value) {\n  switch (value) {\n  case 'true':\n    return true;\n  case 'false':\n    return false;\n  }\n\n  return value;\n}\n\nconst NO_OP = null;\n\nexport function setPropertyValue(bpmnFactory, commandStack, element, property, value) {\n  let businessObject = getBusinessObject(element);\n\n  const {\n    binding,\n  } = property;\n\n  const {\n    name,\n    type,\n    property: bindingProperty,\n    linkName\n  } = binding;\n\n  let extensionElements;\n\n  let propertyValue;\n\n  const commands = [];\n\n  const context = {\n    element,\n    property\n  };\n\n  // ensure message exists\n  if (MESSAGE_BINDING_TYPES.includes(type)) {\n    if (is(businessObject, 'bpmn:Event')) {\n      businessObject = businessObject.get('eventDefinitions')[0];\n    }\n\n    let message = findMessage(businessObject);\n\n    if (!message) {\n      message = bpmnFactory.create('bpmn:Message', { 'zeebe:modelerTemplate': getTemplateId(element) });\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: businessObject,\n          properties: { messageRef: message }\n        }\n      });\n    }\n\n    businessObject = message;\n  }\n\n  // ensure extension elements\n  if (EXTENSION_BINDING_TYPES.includes(type)) {\n    extensionElements = businessObject.get('extensionElements');\n\n    if (!extensionElements) {\n      extensionElements = createElement('bpmn:ExtensionElements', null, businessObject, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: businessObject,\n          properties: { extensionElements }\n        }\n      });\n    } else {\n      commands.push(NO_OP);\n    }\n  }\n\n  // property\n  if (PROPERTY_BINDING_TYPES.includes(type)) {\n\n    const propertyDescriptor = businessObject.$descriptor.propertiesByName[ name ];\n\n    // if property not created yet\n    if (!propertyDescriptor) {\n\n      // make sure we create the property\n      propertyValue = value || '';\n    }\n\n    else {\n      const { type: propertyType } = propertyDescriptor;\n\n      // do not override non-primitive types\n      if (!PRIMITIVE_MODDLE_TYPES.includes(propertyType)) {\n        throw new Error(`cannot set property of type <${ propertyType }>`);\n      }\n\n      if (propertyType === 'Boolean') {\n        propertyValue = !!value;\n      } else if (propertyType === 'Integer') {\n        propertyValue = parseInt(value, 10);\n\n        if (isNaN(propertyValue)) {\n\n          // do not set NaN value\n          propertyValue = undefined;\n        }\n      } else {\n\n        // make sure we don't remove the property\n        propertyValue = value || '';\n      }\n    }\n\n    if (!isUndefined(propertyValue)) {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: businessObject,\n          properties: { [ name ]: propertyValue }\n        }\n      });\n    } else {\n      commands.push(NO_OP);\n    }\n\n  }\n\n  // zeebe:taskDefinition\n  if (TASK_DEFINITION_TYPES.includes(type)) {\n    const oldTaskDefinition = findExtension(extensionElements, 'zeebe:TaskDefinition'),\n          propertyName = getTaskDefinitionPropertyName(binding),\n          properties = {\n            [ propertyName ]: value || ''\n          };\n\n    if (oldTaskDefinition) {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          properties,\n          moddleElement: oldTaskDefinition\n        }\n      });\n    } else {\n      const newTaskDefinition = createTaskDefinition(properties, bpmnFactory);\n      newTaskDefinition.$parent = businessObject;\n\n      const values = extensionElements.get('values');\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: extensionElements,\n          properties: { values: [ ...values, newTaskDefinition ] }\n        }\n      });\n    }\n  }\n\n  if (IO_BINDING_TYPES.includes(type)) {\n    let ioMapping = findExtension(extensionElements, 'zeebe:IoMapping');\n\n    if (!ioMapping) {\n      ioMapping = createElement('zeebe:IoMapping', null, businessObject, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: extensionElements,\n          properties: { values: [ ...extensionElements.get('values'), ioMapping ] }\n        }\n      });\n    }\n\n    // zeebe:Input\n    if (type === ZEBBE_INPUT_TYPE) {\n      const oldZeebeInputParameter = findInputParameter(ioMapping, binding);\n      const values = ioMapping.get('inputParameters').filter((value) => value !== oldZeebeInputParameter);\n\n      // do not persist empty parameters when configured as <optional>\n      if (shouldUpdate(value, property)) {\n        const newZeebeInputParameter = createInputParameter(binding, value, bpmnFactory);\n        values.push(newZeebeInputParameter);\n      }\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: ioMapping,\n          properties: { inputParameters: [ ...values ] }\n        }\n      });\n    }\n\n    // zeebe:Output\n    if (type === ZEEBE_OUTPUT_TYPE) {\n      const oldZeebeOutputParameter = findOutputParameter(ioMapping, binding);\n      const values = ioMapping.get('outputParameters').filter((value) => value !== oldZeebeOutputParameter);\n\n      // do not persist empty parameters when configured as <optional>\n      if (shouldUpdate(value, property)) {\n        const newZeebeOutputParameter = createOutputParameter(binding, value, bpmnFactory);\n        values.push(newZeebeOutputParameter);\n      }\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: ioMapping,\n          properties: { 'outputParameters': [ ...values ] }\n        }\n      });\n    }\n  }\n\n  // zeebe:taskHeaders\n  if (type === ZEEBE_TASK_HEADER_TYPE) {\n    let taskHeaders = findExtension(extensionElements, 'zeebe:TaskHeaders');\n\n    if (!taskHeaders) {\n      taskHeaders = createElement('zeebe:TaskHeaders', null, businessObject, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: extensionElements,\n          properties: { values: [ ...extensionElements.get('values'), taskHeaders ] }\n        }\n      });\n    }\n\n    const oldTaskHeader = findTaskHeader(taskHeaders, binding);\n\n    const values = taskHeaders.get('values').filter((value) => value !== oldTaskHeader);\n\n    // do not persist task headers with empty value\n    if (!value) {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: taskHeaders,\n          properties: { values }\n        }\n      });\n    } else {\n      const newTaskHeader = createTaskHeader(binding, value, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: taskHeaders,\n          properties: { values: [ ...values, newTaskHeader ] }\n        }\n      });\n    }\n  }\n\n  // zeebe:Property\n  if (type === ZEEBE_PROPERTY_TYPE) {\n    let zeebeProperties = findExtension(extensionElements, 'zeebe:Properties');\n\n    if (!zeebeProperties) {\n      zeebeProperties = createElement('zeebe:Properties', null, businessObject, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          element,\n          moddleElement: extensionElements,\n          properties: {\n            values: [ ...extensionElements.get('values'), zeebeProperties ]\n          }\n        }\n      });\n    }\n\n    const oldZeebeProperty = findZeebeProperty(zeebeProperties, binding);\n\n    const properties = zeebeProperties.get('properties').filter((property) => property !== oldZeebeProperty);\n\n    if (shouldUpdate(value, property)) {\n      const newZeebeProperty = createZeebeProperty(binding, value, bpmnFactory);\n\n      properties.push(newZeebeProperty);\n    }\n\n    commands.push({\n      cmd: 'element.updateModdleProperties',\n      context: {\n        element,\n        moddleElement: zeebeProperties,\n        properties: {\n          properties\n        }\n      }\n    });\n  }\n\n  // bpmn:Message#zeebe:subscription#property\n  if (type === MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE) {\n    let subscription = findExtension(extensionElements, 'zeebe:Subscription');\n    const properties = {\n      [ name ]: value || ''\n    };\n\n    if (subscription) {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          element,\n          properties,\n          moddleElement: subscription\n        }\n      });\n    } else {\n      subscription = createElement('zeebe:Subscription', properties, extensionElements, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: extensionElements,\n          properties: { values: [ ...extensionElements.get('values'), subscription ] }\n        }\n      });\n    }\n  }\n\n  // zeebe:calledElement\n  if (type === ZEEBE_CALLED_ELEMENT) {\n    let calledElement = findExtension(element, 'zeebe:CalledElement');\n    const propertyName = binding.property;\n\n    const properties = {\n      [ propertyName ]: value || ''\n    };\n\n    if (calledElement) {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          element,\n          properties,\n          moddleElement: calledElement\n        }\n      });\n    } else {\n      calledElement = createElement('zeebe:CalledElement', properties, extensionElements, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: extensionElements,\n          properties: { values: [ ...extensionElements.get('values'), calledElement ] }\n        }\n      });\n    }\n  }\n\n  if (type === ZEEBE_LINKED_RESOURCE_PROPERTY) {\n    let linkedResources = findExtension(businessObject, 'zeebe:LinkedResources');\n\n    if (!linkedResources) {\n      linkedResources = createElement('zeebe:LinkedResources', null, businessObject, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: extensionElements,\n          properties: { values: [ ...extensionElements.get('values'), linkedResources ] }\n        }\n      });\n    }\n\n    let linkedResource = linkedResources.get('values').find((value) => value.get('linkName') === linkName);\n\n    if (!linkedResource) {\n      linkedResource = createElement('zeebe:LinkedResource', { linkName }, businessObject, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: linkedResources,\n          properties: { values: [ ...linkedResources.get('values'), linkedResource ] }\n        }\n      });\n    }\n\n    commands.push({\n      cmd: 'element.updateModdleProperties',\n      context: {\n        ...context,\n        moddleElement: linkedResource,\n        properties: { [ bindingProperty ]: value }\n      }\n    });\n  }\n\n  if (commands.length) {\n    const commandsToExecute = commands.filter((command) => command !== NO_OP);\n\n    commandsToExecute.length && commandStack.execute(\n      'element-templates.multi-command-executor',\n      commandsToExecute\n    );\n\n    return;\n  }\n\n  // should never throw as templates are validated beforehand\n  throw unknownBindingError(element, property);\n}\n\n\nexport function unsetProperty(commandStack, element, property) {\n  let businessObject = getBusinessObject(element);\n\n  const {\n    binding\n  } = property;\n\n  const {\n    type\n  } = binding;\n\n  let extensionElements;\n\n  const commands = [];\n\n  const context = {\n    element,\n    property\n  };\n\n  if (MESSAGE_BINDING_TYPES.includes(type)) {\n    businessObject = findMessage(businessObject);\n\n    if (!businessObject) {\n      return;\n    }\n  }\n\n  // property\n  if (PROPERTY_BINDING_TYPES.includes(type)) {\n    const { name } = binding;\n\n    commands.push({\n      cmd: 'element.updateModdleProperties',\n      context: {\n        ...context,\n        moddleElement: businessObject,\n        properties: { [ name ]: undefined }\n      }\n    });\n  }\n\n\n  if (EXTENSION_BINDING_TYPES.includes(type)) {\n    extensionElements = businessObject.get('extensionElements');\n    if (!extensionElements)\n      return;\n  }\n\n  // zeebe:taskDefinition\n  if (TASK_DEFINITION_TYPES.includes(type)) {\n    const oldTaskDefinition = findExtension(extensionElements, 'zeebe:TaskDefinition');\n\n    const propertyName = getTaskDefinitionPropertyName(binding);\n\n    if (oldTaskDefinition) {\n\n      if (isOnlyProperty(oldTaskDefinition, propertyName)) {\n\n        // remove task definition\n        commands.push({\n          cmd: 'element.updateModdleProperties',\n          context: {\n            ...context,\n            moddleElement: extensionElements,\n            properties: {\n              values: without(extensionElements.get('values'), oldTaskDefinition)\n            }\n          }\n        });\n      } else {\n\n        // remove property\n        commands.push({\n          cmd: 'element.updateModdleProperties',\n          context: {\n            ...context,\n            moddleElement: oldTaskDefinition,\n            properties: {\n              [ propertyName ]: undefined\n            }\n          }\n        });\n      }\n    }\n  }\n\n\n  // zeebe:IoMapping\n  if (IO_BINDING_TYPES.includes(type)) {\n    let ioMapping = findExtension(extensionElements, 'zeebe:IoMapping');\n\n    if (!ioMapping)\n      return;\n\n    // zeebe:Input\n    if (type === ZEBBE_INPUT_TYPE) {\n      const oldZeebeInputParameter = findInputParameter(ioMapping, binding);\n      const values = ioMapping.get('inputParameters').filter((value) => value !== oldZeebeInputParameter);\n\n      if (ioMapping.get('outputParameters').length == 0 && values.length == 0) {\n\n        commands.push({\n          cmd: 'element.updateModdleProperties',\n          context: {\n            ...context,\n            moddleElement: extensionElements,\n            properties: {\n              values:  without(extensionElements.get('values'), ioMapping)\n            }\n          }\n        });\n      }\n\n      else {\n        commands.push({\n          cmd: 'element.updateModdleProperties',\n          context: {\n            ...context,\n            moddleElement: ioMapping,\n            properties: { inputParameters: [ ...values ] }\n          }\n        });\n      }\n    }\n\n    // zeebe:Output\n    if (type === ZEEBE_OUTPUT_TYPE) {\n      const oldZeebeOutputParameter = findOutputParameter(ioMapping, binding);\n      const values = ioMapping.get('outputParameters').filter((value) => value !== oldZeebeOutputParameter);\n\n      if (ioMapping.get('inputParameters').length == 0 && values.length == 0) {\n\n        commands.push({\n          cmd: 'element.updateModdleProperties',\n          context: {\n            ...context,\n            moddleElement: extensionElements,\n            properties: {\n              values: without(extensionElements.get('values'), ioMapping)\n            }\n          }\n        });\n      }\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: ioMapping,\n          properties: { 'outputParameters': [ ...values ] }\n        }\n      });\n    }\n  }\n\n  // zeebe:taskHeaders\n  if (type === ZEEBE_TASK_HEADER_TYPE) {\n    let taskHeaders = findExtension(extensionElements, 'zeebe:TaskHeaders');\n\n    if (!taskHeaders)\n      return;\n\n    const oldTaskHeader = findTaskHeader(taskHeaders, binding);\n\n    const values = taskHeaders.get('values').filter((value) => value !== oldTaskHeader);\n\n    if (values.length === 0) {\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: extensionElements,\n          properties: {\n            values: without(extensionElements.get('values'), taskHeaders)\n          }\n        }\n      });\n    }\n    else {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: taskHeaders,\n          properties: { values: [ ...values ] }\n        }\n      });\n    }\n  }\n\n  // zeebe:Property\n  if (type === ZEEBE_PROPERTY_TYPE) {\n    let zeebeProperties = findExtension(extensionElements, 'zeebe:Properties');\n\n    if (!zeebeProperties)\n      return;\n\n    const oldZeebeProperty = findZeebeProperty(zeebeProperties, binding);\n\n    const properties = zeebeProperties.get('properties').filter((property) => property !== oldZeebeProperty);\n\n    if (!properties.length) {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: extensionElements,\n          properties: {\n            values: without(extensionElements.get('values'), zeebeProperties)\n          }\n        }\n      });\n    } else {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: zeebeProperties,\n          properties: {\n            properties: [ ...properties ]\n          }\n        }\n      });\n    }\n  }\n\n  // bpmn:Message#property\n  if (type === MESSAGE_PROPERTY_TYPE) {\n    commands.push({\n      cmd: 'element.updateModdleProperties',\n      context: {\n        ...context,\n        moddleElement: businessObject,\n        properties: {\n          [ binding.name ]: undefined\n        }\n      }\n    });\n  }\n\n  // bpmn:Message#zeebe:subscription#property\n  if (type === MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE) {\n    const subscription = findZeebeSubscription(businessObject);\n\n    if (!subscription) {\n      return;\n    }\n\n    commands.push({\n      cmd: 'element.updateModdleProperties',\n      context: {\n        ...context,\n        moddleElement: subscription,\n        properties: {\n          [ binding.name ]: undefined\n        }\n      }\n    });\n  }\n\n\n  if (commands.length) {\n    commandStack.execute(\n      'element-templates.multi-command-executor',\n      commands\n    );\n\n    return;\n  }\n}\n\n// TODO(@barmac): fix translate usage (https://github.com/bpmn-io/bpmn-js-element-templates/pull/53#issuecomment-1906203270)\nexport function validateProperty(value, property, translate = defaultTranslate) {\n  const {\n    constraints = {},\n    label\n  } = property;\n\n  const {\n    maxLength,\n    minLength,\n    notEmpty\n  } = constraints;\n\n  if (notEmpty && isEmpty(value)) {\n    return `${label} ${translate('must not be empty.')}`;\n  }\n\n  if (property.feel && isFeel(value)) {\n    return;\n  }\n\n  if (maxLength && (value || '').length > maxLength) {\n    return `${label} ${translate('must have max length {maxLength}.', { maxLength })}`;\n  }\n\n  if (minLength && (value || '').length < minLength) {\n    return `${label} ${translate('must have min length {minLength}.', { minLength })}`;\n  }\n\n  let { pattern } = constraints;\n\n  if (pattern) {\n    let message;\n\n    if (!isString(pattern)) {\n      message = pattern.message;\n      pattern = pattern.value;\n    }\n\n    if (!matchesPattern(value, pattern)) {\n      if (message) {\n        return `${label} ${translate(message)}`;\n      }\n\n      return `${label} ${translate('must match pattern {pattern}.', { pattern })}`;\n    }\n  }\n}\n\n// helpers\nfunction unknownBindingError(element, property) {\n  const businessObject = getBusinessObject(element);\n\n  const id = businessObject.get('id');\n\n  const { binding } = property;\n\n  const { type } = binding;\n\n  return new Error(`unknown binding <${ type }> for element <${ id }>, this should never happen`);\n}\n\nfunction isEmpty(value) {\n  if (typeof value === 'string') {\n    return !value.trim().length;\n  }\n\n  return value === undefined;\n}\n\nfunction matchesPattern(string, pattern) {\n  return new RegExp(pattern).test(string);\n}\n\nfunction isOnlyProperty(moddleElement, propertyName) {\n  const descriptor = moddleElement.$descriptor;\n\n  return descriptor.properties.every(({ name }) => {\n    return propertyName === name || moddleElement.get(name) === undefined;\n  });\n}\n\nfunction defaultTranslate(template, replacements) {\n\n  replacements = replacements || {};\n\n  return template.replace(/{([^}]+)}/g, function(_, key) {\n    return replacements[key] || '{' + key + '}';\n  });\n}\n\nfunction isFeel(value) {\n  return isString(value) && value.trim().startsWith('=');\n}","import { isEventSubProcess } from 'bpmn-js/lib/util/DiUtil';\nimport { getPropertyValue } from './util/propertyUtil';\nimport { is } from 'bpmn-js/lib/util/ModelUtil';\n\n/**\n * Based on conditions, remove properties from the template.\n */\nexport function applyConditions(element, elementTemplate) {\n  const { properties } = elementTemplate;\n\n  const filteredProperties = properties.filter(property => {\n    return isPropertyAllowed(element, property) && isConditionMet(element, properties, property);\n  });\n\n  return {\n    ...elementTemplate,\n    properties: filteredProperties\n  };\n}\n\nexport function isConditionMet(element, properties, property) {\n  const { condition } = property;\n\n  // If no condition is defined, return true.\n  if (!condition) {\n    return true;\n  }\n\n  // multiple (\"and\") conditions\n  if (condition.allMatch) {\n    const conditions = condition.allMatch;\n\n    return conditions.every(\n      condition => isSimpleConditionMet(element, properties, condition)\n    );\n  }\n\n  // single condition\n  return isSimpleConditionMet(element, properties, condition);\n}\n\nfunction isSimpleConditionMet(element, properties, condition) {\n  const { property, equals, oneOf, isActive } = condition;\n\n  if (typeof isActive !== 'undefined') {\n    const relatedCondition = properties.find(p => p.id === property);\n\n    if (!relatedCondition) {\n      return !isActive;\n    }\n\n    return isActive ? isConditionMet(element, properties, relatedCondition) : !isConditionMet(element, properties, relatedCondition);\n  }\n\n  const propertyValue = getValue(element, properties, property);\n\n  if (hasProperty(condition, 'equals')) {\n    return propertyValue === equals;\n  }\n\n  if (oneOf) {\n    return oneOf.includes(propertyValue);\n  }\n\n  return false;\n}\n\nexport function getValue(element, properties, propertyId) {\n  const property = properties.find(p => p.id === propertyId);\n\n  if (!property) {\n    return;\n  }\n\n  return getPropertyValue(element, property);\n}\n\nfunction isPropertyAllowed(element, property) {\n  const { binding } = property;\n  const { type } = binding;\n\n  if (\n    type === 'bpmn:Message#zeebe:subscription#property' &&\n    binding.name === 'correlationKey' &&\n    is(element, 'bpmn:StartEvent') &&\n    !isEventSubProcess(element.parent)\n  ) {\n    return false;\n  }\n\n  return true;\n}\n\n\n// helpers //////////////////////\n\nfunction hasProperty(obj, key) {\n  return Object.prototype.hasOwnProperty.call(obj, key);\n}","import {\n  getBusinessObject\n} from 'bpmn-js/lib/util/ModelUtil';\n\nimport { find } from 'min-dash';\n\nimport PropertyBindingProvider from './PropertyBindingProvider';\nimport TaskDefinitionBindingProvider from './TaskDefinitionBindingProvider';\nimport InputBindingProvider from './InputBindingProvider';\nimport OutputBindingProvider from './OutputBindingProvider';\nimport TaskHeaderBindingProvider from './TaskHeaderBindingProvider';\nimport ZeebePropertiesProvider from './ZeebePropertiesProvider';\nimport { MessagePropertyBindingProvider } from './MessagePropertyBindingProvider';\nimport { MessageZeebeSubscriptionBindingProvider } from './MessageZeebeSubscriptionBindingProvider';\nimport { CalledElementBindingProvider } from './CalledElementBindingProvider';\nimport LinkedResourcePropertyBindingProvider from './LinkedResourceProvider';\n\nimport {\n  MESSAGE_PROPERTY_TYPE,\n  MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE,\n  PROPERTY_TYPE,\n  ZEEBE_TASK_DEFINITION_TYPE_TYPE,\n  ZEEBE_TASK_DEFINITION,\n  ZEBBE_INPUT_TYPE,\n  ZEEBE_OUTPUT_TYPE,\n  ZEEBE_TASK_HEADER_TYPE,\n  ZEBBE_PROPERTY_TYPE,\n  ZEEBE_CALLED_ELEMENT,\n  ZEEBE_LINKED_RESOURCE_PROPERTY\n} from '../util/bindingTypes';\n\nimport {\n  isConditionMet\n} from '../Condition';\n\nexport default class TemplateElementFactory {\n\n  constructor(bpmnFactory, elementFactory) {\n    this._bpmnFactory = bpmnFactory;\n    this._elementFactory = elementFactory;\n\n    this._providers = {\n      [PROPERTY_TYPE]: PropertyBindingProvider,\n      [ZEEBE_TASK_DEFINITION_TYPE_TYPE]: TaskDefinitionBindingProvider,\n      [ZEEBE_TASK_DEFINITION]: TaskDefinitionBindingProvider,\n      [ZEBBE_PROPERTY_TYPE]: ZeebePropertiesProvider,\n      [ZEBBE_INPUT_TYPE]: InputBindingProvider,\n      [ZEEBE_OUTPUT_TYPE]: OutputBindingProvider,\n      [ZEEBE_TASK_HEADER_TYPE]: TaskHeaderBindingProvider,\n      [MESSAGE_PROPERTY_TYPE]: MessagePropertyBindingProvider,\n      [MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE]: MessageZeebeSubscriptionBindingProvider,\n      [ZEEBE_CALLED_ELEMENT]: CalledElementBindingProvider,\n      [ZEEBE_LINKED_RESOURCE_PROPERTY]: LinkedResourcePropertyBindingProvider\n    };\n  }\n\n  /**\n   * Create an element based on an element template.\n   *\n   * @param {ElementTemplate} template\n   * @returns {djs.model.Base}\n   */\n  create(template) {\n\n    const {\n      properties\n    } = template;\n\n    // (1) base shape\n    const element = this._createShape(template);\n\n    // (2) apply template\n    this._setModelerTemplate(element, template);\n\n    // (3) apply icon\n    if (hasIcon(template)) {\n      this._setModelerTemplateIcon(element, template);\n    }\n\n    // (4) apply properties\n    this._applyProperties(element, properties);\n\n    return element;\n  }\n\n  _createShape(template) {\n    const {\n      appliesTo,\n      elementType = {}\n    } = template;\n    const elementFactory = this._elementFactory;\n\n    const attrs = {\n      type: elementType.value || appliesTo[0]\n    };\n\n    // apply eventDefinition\n    if (elementType.eventDefinition) {\n      attrs.eventDefinitionType = elementType.eventDefinition;\n    }\n\n    const element = elementFactory.createShape(attrs);\n\n    return element;\n  }\n\n  _ensureExtensionElements(element) {\n    const bpmnFactory = this._bpmnFactory;\n    const businessObject = getBusinessObject(element);\n\n    let extensionElements = businessObject.get('extensionElements');\n\n    if (!extensionElements) {\n      extensionElements = bpmnFactory.create('bpmn:ExtensionElements', {\n        values: []\n      });\n\n      extensionElements.$parent = businessObject;\n      businessObject.set('extensionElements', extensionElements);\n    }\n\n    return extensionElements;\n  }\n\n  _setModelerTemplate(element, template) {\n    const {\n      id,\n      version\n    } = template;\n\n    const businessObject = getBusinessObject(element);\n\n    businessObject.set('zeebe:modelerTemplate', id);\n    businessObject.set('zeebe:modelerTemplateVersion', version);\n  }\n\n  _setModelerTemplateIcon(element, template) {\n    const {\n      icon\n    } = template;\n\n    const {\n      contents\n    } = icon;\n\n    const businessObject = getBusinessObject(element);\n\n    businessObject.set('zeebe:modelerTemplateIcon', contents);\n  }\n\n  /**\n   * Apply properties to a given element.\n   *\n   * @param {djs.model.Base} element\n   * @param {Array<Object>} properties\n   */\n  _applyProperties(element, properties) {\n    const processedProperties = [];\n\n    properties.forEach(\n      property => this._applyProperty(element, property, properties, processedProperties)\n    );\n  }\n\n  /**\n   * Apply a property and its parent properties to an element based on conditions.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} property\n   * @param {Array<Object>} properties\n   * @param {Array<Object>} processedProperties\n   */\n  _applyProperty(element, property, properties, processedProperties) {\n\n    // skip if already processed\n    if (processedProperties.includes(property)) {\n      return;\n    }\n\n    // apply dependant property first if not already applied\n    const dependentProperties = findDependentProperties(property, properties);\n\n    dependentProperties.forEach(\n      property => this._applyProperty(element, property, properties, processedProperties)\n    );\n\n    // check condition and apply property if condition is met\n    if (isConditionMet(element, properties, property)) {\n      this._bindProperty(property, element);\n    }\n\n    processedProperties.push(property);\n  }\n\n  /**\n   * Bind property to element.\n   * @param {Object} property\n   * @param {djs.Model.Base} element\n   */\n  _bindProperty(property, element) {\n    const {\n      binding\n    } = property;\n\n    const {\n      type: bindingType\n    } = binding;\n\n    const bindingProvider = this._providers[bindingType];\n\n    bindingProvider.create(element, {\n      property,\n      bpmnFactory: this._bpmnFactory\n    });\n  }\n}\n\nTemplateElementFactory.$inject = [ 'bpmnFactory', 'elementFactory' ];\n\n\n// helper ////////////////\n\nfunction hasIcon(template) {\n  const {\n    icon\n  } = template;\n\n  return !!(icon && icon.contents);\n}\n\nfunction findDependentProperties(property, properties) {\n\n  const {\n    condition\n  } = property;\n\n  if (!condition) {\n    return [];\n  }\n\n  const dependentProperty = findProperyById(properties, condition.property);\n\n  if (dependentProperty) {\n    return [ dependentProperty ];\n  }\n\n  return [];\n}\n\nfunction findProperyById(properties, id) {\n  return find(properties, function(property) {\n    return property.id === id;\n  });\n}","import TemplateElementFactory from './TemplateElementFactory';\n\nexport default {\n  __init__: [\n    'templateElementFactory'\n  ],\n  templateElementFactory: [ 'type', TemplateElementFactory ]\n};\n","import {\n  applyConditions\n} from '../Condition';\n\nimport { isObject } from 'min-dash';\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { ZEEBE_TASK_DEFINITION, ZEEBE_TASK_DEFINITION_TYPE_TYPE } from '../util/bindingTypes';\n\n\n/**\n * Checks the conditions of an element template and sets/resets the\n * corresponding properties on the element.\n */\nexport default class ConditionalBehavior extends CommandInterceptor {\n\n  /**\n   * @param {import('diagram-js/lib/core/EventBus').default} eventBus\n   * @param {import('../ElementTemplates').default} elementTemplates\n   * @param {import('diagram-js/lib/command/CommandStack').default} commandStack\n   * @param {import('bpmn-js/lib/features/modeling/BpmnFactory').default} bpmnFactory\n   * @param {import('didi').Injector} injector\n   */\n  constructor(eventBus, elementTemplates, commandStack, bpmnFactory, injector) {\n    super(eventBus);\n\n    this._eventBus = eventBus;\n    this._elementTemplates = elementTemplates;\n    this._commandStack = commandStack;\n    this._bpmnFactory = bpmnFactory;\n    this._injector = injector;\n\n    // (1) save pre-conditional state before updating a property\n    this.preExecute([\n      'element.updateProperties',\n      'element.updateModdleProperties',\n      'element.move'\n    ], this._saveConditionalState, true, this);\n\n    // (2) check if we need to apply post-conditional updates\n    //\n    //   if [additional bindings activate] then\n    //     (re-)trigger setting the template\n    //   else\n    //     else we're done\n    //\n    this.postExecute([\n      'element.updateProperties',\n      'element.updateModdleProperties',\n      'propertiesPanel.zeebe.changeTemplate',\n      'element.move'\n    ], this._applyConditions, true, this);\n\n    // (3) set conditions before changing the template\n    this.preExecute([\n      'propertiesPanel.zeebe.changeTemplate'\n    ], this._ensureConditional, true, this);\n  }\n\n  _saveConditionalState(context) {\n    const {\n      element\n    } = context;\n\n    const template = this._elementTemplates.get(element);\n\n    if (!template) {\n      return;\n    }\n\n    context.oldTemplateWithConditions = applyConditions(element, template);\n  }\n\n  _applyConditions(context, event) {\n    const {\n      element,\n      newTemplate,\n      oldTemplateWithConditions\n    } = context;\n\n    // do not apply conditions if we only update meta information\n    if (isMetaUpdate(event, context)) {\n      return;\n    }\n\n    const template = this._elementTemplates.get(element);\n\n    // new Template is persisted before applying default values,\n    // new conditions might apply after the defaults are present.\n    const oldTemplate = oldTemplateWithConditions || newTemplate;\n\n    if (!template || !oldTemplate) {\n      return;\n    }\n\n    const newTemplateWithConditions = applyConditions(element, template);\n\n    // verify that new bindings were activated\n    if (!hasDifferentPropertyBindings(newTemplateWithConditions, oldTemplate)) {\n      return;\n    }\n\n    // do another pass to apply further conditional bindings\n    // newTemplate will always be the original template; it is filtered\n    // at a later step (3)\n    const changeContext = {\n      element,\n      newTemplate: template,\n      oldTemplate\n    };\n\n    this._commandStack.execute('propertiesPanel.zeebe.changeTemplate', changeContext);\n  }\n\n  _ensureConditional(context) {\n    const {\n      element,\n      newTemplate\n    } = context;\n\n    if (!newTemplate) {\n      return;\n    }\n\n    // ensure conditions are applied before changing the template.\n    // `newTemplate` will always be the original template.\n    context.newTemplate = applyConditions(element, newTemplate);\n  }\n\n}\n\n\nConditionalBehavior.$inject = [\n  'eventBus',\n  'elementTemplates',\n  'commandStack',\n  'bpmnFactory',\n  'injector'\n];\n\n\n// helpers\n\nfunction hasDifferentPropertyBindings(sourceTemplate, targetTemplate) {\n  return hasNewProperties(sourceTemplate, targetTemplate) || hasRemovedProperties(sourceTemplate, targetTemplate);\n}\n\nfunction hasNewProperties(sourceTemplate, targetTemplate) {\n  let properties = targetTemplate.properties;\n\n  return properties.some(targetProp =>!(\n    sourceTemplate.properties.find(sourceProp => compareProps(sourceProp, targetProp))\n  ));\n}\n\nfunction hasRemovedProperties(oldTemplate, newTemplate) {\n  const oldProperties = getMissingProperties(newTemplate, oldTemplate);\n\n  // ensure XML properties are mantained for properties with\n  // different conditions but same bindings\n  return oldProperties.some(property =>\n    !findPropertyWithBinding(newTemplate, property)\n  );\n}\n\nfunction getMissingProperties(sourceTemplate, targetTemplate) {\n\n  let properties = targetTemplate.properties;\n\n  return properties.filter(targetProp =>!(\n    sourceTemplate.properties.find(sourceProp => compareProps(sourceProp, targetProp))\n  ));\n}\n\nfunction compareProps(sourceProp, targetProp) {\n  return (\n    areBindingsEqual(sourceProp.binding, targetProp.binding) &&\n    equals(sourceProp.condition, targetProp.condition)\n  );\n}\n\nfunction findPropertyWithBinding(template, prop1) {\n  return template.properties.some(\n    prop2 => areBindingsEqual(prop1.binding, prop2.binding)\n  );\n}\n\nfunction normalizeReplacer(key, value) {\n\n  if (isObject(value)) {\n    const keys = Object.keys(value).sort();\n\n    return keys.reduce((obj, key) => {\n      obj[key] = value[key];\n\n      return obj;\n    }, {});\n  }\n\n  return value;\n}\n\nfunction areBindingsEqual(binding1, binding2) {\n  binding1 = normalizeBinding(binding1);\n  binding2 = normalizeBinding(binding2);\n\n  return equals(binding1, binding2);\n}\n\n/**\n * Convert deprecated binding type to new type.\n */\nfunction normalizeBinding(binding) {\n  if (binding.type === ZEEBE_TASK_DEFINITION_TYPE_TYPE) {\n    return {\n      ...binding,\n      type: ZEEBE_TASK_DEFINITION,\n      property: 'type'\n    };\n  }\n\n  return binding;\n}\n\nfunction equals(a, b) {\n  return JSON.stringify(a, normalizeReplacer) === JSON.stringify(b, normalizeReplacer);\n}\n\n/**\n * Checks if the event only updates \"meta\" properties:\n *\n *   * `zeebe:modelerTemplate`\n *   * `zeebe:modelerTemplateVersion`\n *\n * @param {string} event\n * @param {any} context\n *\n * @return {boolean}\n */\nfunction isMetaUpdate(event, context) {\n  return event === 'element.updateProperties' && (\n    Object.keys(context.properties).every(\n      key => [ 'zeebe:modelerTemplate', 'zeebe:modelerTemplateVersion' ].includes(key)\n    ));\n}","import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { getBusinessObject, is } from 'bpmn-js/lib/util/ModelUtil';\n\n/**\n * This Behavior checks if the new element's type is in\n * the list of elements the template applies to and unlinks\n * it if not.\n */\nexport default class ReplaceBehavior extends CommandInterceptor {\n  constructor(elementTemplates, injector) {\n    super(injector.get('eventBus'));\n\n    this.postExecuted('shape.replace', function(e) {\n      var context = e.context,\n          oldShape = context.oldShape,\n          oldBo = getBusinessObject(oldShape),\n          newShape = context.newShape,\n          newBo = getBusinessObject(newShape);\n\n      if (!oldBo.modelerTemplate) {\n        return;\n      }\n\n      const template = newBo.modelerTemplate;\n      const version = newBo.modelerTemplateVersion;\n\n      const elementTemplate = elementTemplates.get(template, version);\n\n      if (!elementTemplate) {\n        elementTemplates.unlinkTemplate(newShape);\n        return;\n      }\n\n      const { appliesTo, elementType } = elementTemplate;\n\n      if (elementType) {\n        if (!is(newShape, elementType.value) || shouldUnlinkEvent(newShape, elementType)) {\n          elementTemplates.unlinkTemplate(newShape);\n        }\n\n        return;\n      }\n\n      const allowed = appliesTo.reduce((allowed, type) => {\n        return allowed || is(newBo, type);\n      }, false);\n\n      if (!allowed) {\n        elementTemplates.unlinkTemplate(newShape);\n      }\n    });\n  }\n}\n\nReplaceBehavior.$inject = [\n  'elementTemplates',\n  'injector'\n];\n\nfunction shouldUnlinkEvent(newShape, elementType) {\n  if (!is(newShape, 'bpmn:Event')) {\n    return false;\n  }\n\n  const { eventDefinition } = elementType,\n        bo = getBusinessObject(newShape),\n        eventDefinitions = bo.get('eventDefinitions');\n\n  if (!eventDefinition) {\n    return eventDefinitions.length !== 0;\n  }\n\n  return !is(eventDefinitions[0], eventDefinition);\n}\n","import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { isObject } from 'min-dash';\nimport { applyConditions } from '../Condition';\nimport { findExtension } from '../Helper';\n\n/**\n * Restores the original order of the template properties\n * on the moddle element.\n */\nexport default class UpdateTemplatePropertiesOrder extends CommandInterceptor {\n  constructor(eventBus, elementTemplates, commandStack, bpmnFactory) {\n    super(eventBus);\n\n    this._eventBus = eventBus;\n    this._elementTemplates = elementTemplates;\n    this._commandStack = commandStack;\n    this._bpmnFactory = bpmnFactory;\n\n    this.postExecute([\n      'element.updateProperties', 'element.updateModdleProperties'\n    ], this._updatePropertiesOrder, true, this);\n  }\n\n  _updatePropertiesOrder(context) {\n    const {\n      element\n    } = context;\n\n    const template = this._elementTemplates.get(element);\n    const businessObject = element.businessObject;\n    const commands = [];\n\n    if (!template) {\n      return;\n    }\n\n    const templateProperties = applyConditions(element, template).properties;\n\n    // zeebe:Property\n    const zeebeProperties = findExtension(businessObject, 'zeebe:Properties');\n\n    if (zeebeProperties) {\n      this._updateZeebePropertiesOrder(zeebeProperties, templateProperties, commands, context);\n    }\n\n    // zeebe:IoMapping\n    const ioMapping = findExtension(businessObject, 'zeebe:IoMapping');\n\n    if (ioMapping) {\n\n      // zeebe:Input\n      this._updateInputOrder(ioMapping, templateProperties, commands, context);\n\n      // zeebe:Output\n      this._updateOutputOrder(ioMapping, templateProperties, commands, context);\n    }\n\n    // zeebe:TaskHeaders\n    const taskHeaders = findExtension(businessObject, 'zeebe:TaskHeaders');\n\n    if (taskHeaders) {\n      this._updateTaskHeadersOrder(taskHeaders, templateProperties, commands, context);\n    }\n\n\n    if (commands.length) {\n      const commandsToExecute = commands.filter((command) => command !== null);\n\n      commandsToExecute.length && this._commandStack.execute(\n        'element-templates.multi-command-executor',\n        commandsToExecute\n      );\n\n      return;\n    }\n  }\n\n  _updateZeebePropertiesOrder(zeebeProperties, templateProperties, commands, context) {\n    const findIndex = (properties, propertyToFind) =>\n      properties.findIndex(prop =>\n        prop.binding.type == 'zeebe:property' && prop.binding.name === propertyToFind.get('name')\n      );\n\n    const properties = zeebeProperties.get('properties');\n\n    if (properties.length < 1)\n      return;\n\n    let newPropertiesOrder = [ ...properties ];\n\n    sortProperties(newPropertiesOrder, findIndex, templateProperties);\n\n    if (!arrayEquals(newPropertiesOrder, properties)) {\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: zeebeProperties,\n          properties: {\n            properties: newPropertiesOrder\n          }\n        }\n      });\n    }\n  }\n\n  _updateInputOrder(ioMapping, templateProperties, commands, context) {\n\n    const findIndex = (properties, propertyToFind) =>\n      properties.findIndex(prop =>\n        prop.binding.type == 'zeebe:input' && prop.binding.name === propertyToFind.get('target')\n      );\n\n    const inputParameters = ioMapping.get('inputParameters');\n\n    if (inputParameters.length < 1)\n      return;\n\n    let newInputOrder = [ ...inputParameters ];\n\n    sortProperties(newInputOrder, findIndex, templateProperties);\n\n    if (!arrayEquals(newInputOrder,inputParameters)) {\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: ioMapping,\n          properties: { inputParameters: newInputOrder }\n        }\n      });\n    }\n  }\n\n  _updateOutputOrder(ioMapping, templateProperties, commands, context) {\n\n    const findIndex = (properties, propertyToFind) =>\n      properties.findIndex(prop =>\n        prop.binding.type == 'zeebe:output' && prop.binding.source === propertyToFind.get('source')\n      );\n\n    const outputParameters = ioMapping.get('outputParameters');\n\n    if (outputParameters.length < 1)\n      return;\n\n    let newOutputOrder = [ ...outputParameters ];\n\n    sortProperties(newOutputOrder, findIndex, templateProperties);\n\n    if (!arrayEquals(newOutputOrder, outputParameters)) {\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: ioMapping,\n          properties: { outputParameters: newOutputOrder }\n        }\n      });\n    }\n  }\n\n  _updateTaskHeadersOrder(taskHeaders, templateProperties, commands, context) {\n\n    const findIndex = (properties, propertyToFind) =>\n      properties.findIndex(prop =>\n        prop.binding.type == 'zeebe:taskHeader' && prop.binding.key === propertyToFind.get('key')\n      );\n\n    const headers = taskHeaders.get('zeebe:values');\n\n    if (headers.length < 1)\n      return;\n\n    let newHeadersOrder = [ ...headers ];\n\n    sortProperties(newHeadersOrder, findIndex, templateProperties);\n\n    if (!arrayEquals(newHeadersOrder, headers)) {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: taskHeaders,\n          properties: { values: newHeadersOrder }\n        }\n      });\n    }\n  }\n\n}\n\nUpdateTemplatePropertiesOrder.$inject = [\n  'eventBus',\n  'elementTemplates',\n  'commandStack',\n  'bpmnFactory'\n];\n\n\n// helpers\n\nfunction normalizeReplacer(key, value) {\n\n  if (isObject(value)) {\n    const keys = Object.keys(value).sort();\n\n    return keys.reduce((obj, key) => {\n      obj[key] = value[key];\n\n      return obj;\n    }, {});\n  }\n\n  return value;\n}\n\nfunction objectEquals(a, b) {\n  return JSON.stringify(a, normalizeReplacer) === JSON.stringify(b, normalizeReplacer);\n}\n\nfunction arrayEquals(a, b) {\n  return a.every((element, idx) => objectEquals(element, b[idx]));\n}\n\nfunction sortProperties(array, findIndex, templateProperties) {\n  return array.sort((a, b) => {\n    const aIndex = findIndex(templateProperties, a);\n    const bIndex = findIndex(templateProperties, b);\n\n    return aIndex - bIndex;\n  });\n}","import { getBusinessObject, is, isAny } from 'bpmn-js/lib/util/ModelUtil';\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\nimport { isString } from 'min-dash';\n\nimport { findMessage, getTemplateId, TEMPLATE_ID_ATTR } from '../Helper';\nimport {\n  getReferringElement,\n  removeRootElement\n} from '../util/rootElementUtil';\n\n/**\n * Handles referenced elements.\n */\nexport class ReferencedElementBehavior extends CommandInterceptor {\n  constructor(eventBus, elementTemplates, modeling, injector, moddleCopy, bpmnFactory) {\n    super(eventBus);\n\n    this._eventBus = eventBus;\n    this._elementTemplates = elementTemplates;\n    this._modeling = modeling;\n    this._injector = injector;\n\n    this.postExecuted([\n      'element.updateProperties', 'element.updateModdleProperties'\n    ], this._handlePropertiesUpdate, true, this);\n\n    this.postExecuted('shape.replace', this._handleReplacement, true, this);\n\n    this.postExecuted('shape.delete', this._handleRemoval, true, this);\n\n\n    // copy templated root element when pasting\n    eventBus.on('copyPaste.pasteElement', function(context) {\n      const {\n        referencedRootElement\n      } = context.descriptor;\n\n      if (!referencedRootElement) {\n        return;\n      }\n\n      if (!getTemplateId(referencedRootElement)) {\n        return;\n      }\n\n      context.descriptor.referencedRootElement = moddleCopy.copyElement(\n        referencedRootElement,\n        bpmnFactory.create(referencedRootElement.$type)\n      );\n    });\n  }\n\n  /**\n   * Unlink referenced element when template is unlinked.\n   */\n  _handlePropertiesUpdate(context) {\n    const { element, properties } = context;\n\n    if (!canHaveReferencedElement(element)) {\n      return;\n    }\n\n    if (!(TEMPLATE_ID_ATTR in properties) || isString(properties[TEMPLATE_ID_ATTR])) {\n      return;\n    }\n\n    const bo = getBusinessObject(element);\n    const message = findMessage(bo);\n\n    if (message && getTemplateId(message)) {\n      this._modeling.updateModdleProperties(element, message, {\n        [TEMPLATE_ID_ATTR]: null\n      });\n    }\n  }\n\n  /**\n   * Remove referenced element when template is removed.\n   * Keep referenced element when template is replaced.\n   */\n  _handleReplacement(context) {\n    const { oldShape, newShape } = context;\n    const oldTemplate = getTemplateId(oldShape),\n          newTemplate = getTemplateId(newShape);\n\n    if (!canHaveReferencedElement(oldShape) || !oldTemplate) {\n      return;\n    }\n\n    const bo = getBusinessObject(oldShape);\n    const message = findMessage(bo);\n\n    if (!message || !getTemplateId(message)) {\n      return;\n    }\n\n    if (!canHaveReferencedElement(newShape) || !newTemplate) {\n      removeRootElement(message, this._injector);\n      return;\n    }\n\n    this._addMessage(newShape, message);\n  }\n\n  _handleRemoval(context) {\n    const { shape } = context;\n\n    if (isLabel(shape)) {\n      return;\n    }\n\n    if (!canHaveReferencedElement(shape)) {\n      return;\n    }\n\n    if (!getTemplateId(shape)) {\n      return;\n    }\n\n    const bo = getBusinessObject(shape);\n    const message = findMessage(bo);\n\n    if (message && getTemplateId(message)) {\n      removeRootElement(message, this._injector);\n    }\n  }\n\n  _addMessage(element, message) {\n    const bo = getReferringElement(element);\n\n    this._modeling.updateModdleProperties(element, bo, {\n      'messageRef': message\n    });\n  }\n}\n\nReferencedElementBehavior.$inject = [\n  'eventBus',\n  'elementTemplates',\n  'modeling',\n  'injector',\n  'moddleCopy',\n  'bpmnFactory'\n];\n\nfunction canHaveReferencedElement(element) {\n\n  // Blank-Events can't have referenced elements\n  if (is(element, 'bpmn:Event')) {\n    const bo = getBusinessObject(element);\n    return bo.get('eventDefinitions') && bo.get('eventDefinitions')[0];\n  }\n\n  return isAny(element, [\n    'bpmn:ReceiveTask',\n    'bpmn:SendTask'\n  ]);\n}\n\nfunction isLabel(element) {\n  return element.type === 'label';\n}\n","import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { getDefaultValue } from '../Helper';\nimport { getPropertyValue, setPropertyValue } from '../util/propertyUtil';\n\n/**\n * Handles generated value properties.\n */\nexport class GeneratedValueBehavior extends CommandInterceptor {\n  constructor(eventBus, elementTemplates, modeling, commandStack, bpmnFactory) {\n    super(eventBus);\n\n    this._eventBus = eventBus;\n    this._elementTemplates = elementTemplates;\n    this._modeling = modeling;\n\n    this.preExecute('shape.create', context => {\n      const element = context.shape;\n      const template = elementTemplates.get(element);\n\n      if (!template) {\n        return;\n      }\n\n      const generatedProps = template.properties.filter(p => p.generatedValue);\n\n      generatedProps.forEach(p => {\n        if (!getPropertyValue(element, p)) {\n          return;\n        }\n\n        const value = getDefaultValue(p);\n\n        setPropertyValue(bpmnFactory, commandStack, element, p, value);\n      });\n    }, true);\n  }\n}\n\nGeneratedValueBehavior.$inject = [\n  'eventBus',\n  'elementTemplates',\n  'modeling',\n  'commandStack',\n  'bpmnFactory'\n];\n","import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\nimport { is } from 'bpmn-js/lib/util/ModelUtil';\n\nimport { findExtension } from '../Helper';\n\n/**\n * Enforces no variable propagation for templated call activities.\n */\nexport class CalledElementBehavior extends CommandInterceptor {\n\n  /**\n   * @param {*} eventBus\n   * @param {*} modeling\n   * @param {import('../ElementTemplates').default} elementTemplates\n   */\n  constructor(eventBus, modeling, elementTemplates) {\n    super(eventBus);\n\n    this._modeling = modeling;\n    this._elementTemplates = elementTemplates;\n\n    this.postExecuted([\n      'element.updateProperties', 'element.updateModdleProperties'\n    ], this._ensureNoPropagation, true, this);\n  }\n\n  _ensureNoPropagation(context) {\n    const { element } = context;\n\n    if (!this._elementTemplates.get(element)) {\n      return;\n    }\n\n    if (!is(element, 'bpmn:CallActivity')) {\n      return;\n    }\n\n    const calledElement = findExtension(element, 'zeebe:CalledElement');\n\n    if (!calledElement) {\n      return;\n    }\n\n    for (const property of [\n      'propagateAllChildVariables',\n      'propagateAllParentVariables'\n    ]) {\n      if (calledElement.get(property) !== false) {\n        this._modeling.updateModdleProperties(element, calledElement, {\n          [property]: false\n        });\n      }\n    }\n  }\n}\n\nCalledElementBehavior.$inject = [\n  'eventBus',\n  'modeling',\n  'elementTemplates'\n];\n","import ConditionalBehavior from './ConditionalBehavior';\nimport ReplaceBehavior from './ReplaceBehavior';\nimport UpdatePropertiesOrderBehavior from './UpdatePropertiesOrderBehavior';\nimport { ReferencedElementBehavior } from './ReferencedElementBehavior';\nimport { GeneratedValueBehavior } from './GeneratedValueBehavior';\nimport { CalledElementBehavior } from './CalledElementBehavior';\n\nexport default {\n  __init__: [\n    'elementTemplatesReplaceBehavior',\n    'elementTemplatesConditionalBehavior',\n    'elementTemplatesGeneratedValueBehavior',\n    'elementTemplatesReferencedElementBehavior',\n    'elementTemplatesUpdatePropertiesOrderBehavior',\n    'elementTemplatesCalledElementBehavior'\n  ],\n  elementTemplatesReplaceBehavior: [ 'type', ReplaceBehavior ],\n  elementTemplatesConditionalBehavior: [ 'type', ConditionalBehavior ],\n  elementTemplatesGeneratedValueBehavior: [ 'type', GeneratedValueBehavior ],\n  elementTemplatesReferencedElementBehavior: [ 'type', ReferencedElementBehavior ],\n  elementTemplatesUpdatePropertiesOrderBehavior: [ 'type', UpdatePropertiesOrderBehavior ],\n  elementTemplatesCalledElementBehavior: [ 'type', CalledElementBehavior ]\n};\n","import ElementTemplates from '../ElementTemplates';\nimport ElementTemplatesLoader from '../ElementTemplatesLoader';\n\nimport commandsModule from '../cmd';\nimport createModule from '../create';\nimport behaviorModule from '../behavior';\n\nexport default {\n  __depends__: [\n    commandsModule,\n    behaviorModule,\n    createModule\n  ],\n  __init__: [\n    'elementTemplatesLoader'\n  ],\n  elementTemplates: [ 'type', ElementTemplates ],\n  elementTemplatesLoader: [ 'type', ElementTemplatesLoader ]\n};\n","import { isUndefined } from 'min-dash';\n\nexport function getVersionOrDateFromTemplate(template) {\n  const metadata = template.metadata,\n        version = template.version;\n\n  if (metadata) {\n    if (!isUndefined(metadata.created)) {\n      return toDateString(metadata.created);\n    } else if (!isUndefined(metadata.updated)) {\n      return toDateString(metadata.updated);\n    }\n  }\n\n  if (isUndefined(version)) {\n    return null;\n  }\n\n  return version;\n}\n\n\n// helper ///////////\n\n/**\n * Example: 01.01.1900 01:01\n *\n * @param {number} timestamp\n * @returns {string}\n */\nfunction toDateString(timestamp) {\n  const date = new Date(timestamp);\n\n  const year = date.getFullYear();\n\n  const month = withLeadingZeros(String(date.getMonth() + 1));\n\n  const day = withLeadingZeros(String(date.getDate()));\n\n  const hours = withLeadingZeros(String(date.getHours()));\n\n  const minutes = withLeadingZeros(String(date.getMinutes()));\n\n  return day + '.' + month + '.' + year + ' ' + hours + ':' + minutes;\n}\n\nfunction withLeadingZeros(string) {\n  return leftPad(string, 2, '0');\n}\n\nfunction leftPad(string, length, character) {\n  while (string.length < length) {\n    string = character + string;\n  }\n\n  return string;\n}\n","import {\n  ArrowIcon,\n  CreateIcon,\n  DropdownButton,\n  HeaderButton,\n  useLayoutState\n} from '@bpmn-io/properties-panel';\n\nimport classnames from 'classnames';\n\nimport {\n  useService\n} from 'bpmn-js-properties-panel';\n\nimport { getTemplateId as defaultGetTemplateId } from '../element-templates/Helper';\n\nimport {\n  getVersionOrDateFromTemplate\n} from '../utils/templateUtil';\n\n\n/**\n * @typedef {NoTemplate|KnownTemplate|UnknownTemplate|OutdatedTemplate} TemplateState\n */\n\n/**\n * @typedef NoTemplate\n * @property {'NO_TEMPLATE'} type\n *\n * @typedef KnownTemplate\n * @property {'KNOWN_TEMPLATE'} type\n * @property {object} template\n *\n * @typedef UnknownTemplate\n * @property {'UNKNOWN_TEMPLATE'} type\n * @property {string} templateId\n *\n * @typedef OutdatedTemplate\n * @property {'OUTDATED_TEMPLATE'} type\n * @property {object} template\n * @property {object} newerTemplate\n */\n\n/**\n * Factory to create an element templates group.\n *\n * @param {object} [props]\n * @param {function} [props.getTemplateId]\n * @param {function} [props.unlinkTemplate]\n * @param {function} [props.updateTemplate]\n */\nexport function createElementTemplatesGroup(props = {}) {\n\n  const {\n    getTemplateId = defaultGetTemplateId\n  } = props;\n\n  return function ElementTemplatesGroup(props) {\n    const {\n      id,\n      label,\n      element,\n      entries = []\n    } = props;\n\n    const [ open, setOpen ] = useLayoutState(\n      [ 'groups', id, 'open' ],\n      false\n    );\n\n    const empty = !entries.length;\n\n    const toggleOpen = () => !empty && setOpen(!open);\n\n    return <div class=\"bio-properties-panel-group bio-properties-panel-templates-group\" data-group-id={ 'group-' + id }>\n      <div class={ classnames(\n        'bio-properties-panel-group-header',\n        {\n          empty,\n          open: open && !empty\n        }\n      ) } onClick={ toggleOpen }\n      >\n        <div title={ label } class=\"bio-properties-panel-group-header-title\">\n          { label }\n        </div>\n\n        <div class=\"bio-properties-panel-group-header-buttons\">\n          <TemplateGroupButtons\n            element={ element }\n            getTemplateId={ getTemplateId } />\n          { !empty && <SectionToggle open={ open } /> }\n        </div>\n      </div>\n\n      <div class={ classnames(\n        'bio-properties-panel-group-entries',\n        { open: open && !empty }\n      ) }>\n        {\n          entries.map(entry => {\n            const {\n              component: Component,\n              id\n            } = entry;\n\n            return (\n              <Component\n                { ...entry }\n                key={ id }\n                element={ element } />\n            );\n          })\n        }\n      </div>\n    </div>;\n  };\n\n}\n\nfunction SectionToggle({ open }) {\n  return <HeaderButton\n    title=\"Toggle section\"\n    class=\"bio-properties-panel-arrow\"\n  >\n    <ArrowIcon class={ open ? 'bio-properties-panel-arrow-down' : 'bio-properties-panel-arrow-right' } />\n  </HeaderButton>;\n}\n\n\n/**\n *\n * @param {object} props\n * @param {object} props.element\n * @param {function} props.getTemplateId\n * @param {function} props.unlinkTemplate\n * @param {function} props.updateTemplate\n */\nfunction TemplateGroupButtons({ element, getTemplateId }) {\n  const elementTemplates = useService('elementTemplates');\n\n  const templateState = getTemplateState(elementTemplates, element, getTemplateId);\n\n  if (templateState.type === 'NO_TEMPLATE') {\n    return <SelectEntryTemplate element={ element } />;\n  } else if (templateState.type === 'KNOWN_TEMPLATE') {\n    return <AppliedTemplate element={ element } />;\n  } else if (templateState.type === 'UNKNOWN_TEMPLATE') {\n    return <UnknownTemplate element={ element } />;\n  } else if (templateState.type === 'DEPRECATED_TEMPLATE') {\n    return <DeprecatedTemplate element={ element } templateState={ templateState } />;\n  } else if (templateState.type === 'INCOMPATIBLE_TEMPLATE') {\n    return <IncompatibleTemplate element={ element } />;\n  } else if (templateState.type === 'OUTDATED_TEMPLATE') {\n    return (\n      <OutdatedTemplate\n        element={ element }\n        templateState={ templateState } />\n    );\n  }\n}\n\nfunction SelectEntryTemplate({ element }) {\n  const translate = useService('translate');\n  const eventBus = useService('eventBus');\n\n  const selectTemplate = () => eventBus.fire('elementTemplates.select', { element });\n\n  return (\n    <HeaderButton\n      title=\"Select a template\"\n      class=\"bio-properties-panel-select-template-button\"\n      onClick={ selectTemplate }\n    >\n      <CreateIcon />\n      <span>{ translate('Select') }</span>\n    </HeaderButton>\n  );\n}\n\nfunction AppliedTemplate({ element }) {\n  const translate = useService('translate'),\n        elementTemplates = useService('elementTemplates');\n\n  const menuItems = [\n    { entry: translate('Unlink'), action: () => elementTemplates.unlinkTemplate(element) },\n    { entry: <RemoveTemplate />, action: () => elementTemplates.removeTemplate(element) }\n  ];\n\n  return (\n    <DropdownButton menuItems={ menuItems } class=\"bio-properties-panel-applied-template-button\">\n      <HeaderButton>\n        <span>{ translate('Applied') }</span>\n        <ArrowIcon class=\"bio-properties-panel-arrow-down\" />\n      </HeaderButton>\n    </DropdownButton>\n  );\n}\n\nfunction RemoveTemplate() {\n  const translate = useService('translate');\n\n  return <span class=\"bio-properties-panel-remove-template\">{ translate('Remove') }</span>;\n}\n\nfunction UnknownTemplate({ element }) {\n  const translate = useService('translate'),\n        elementTemplates = useService('elementTemplates');\n\n  const menuItems = [\n    { entry: <NotFoundText /> },\n    { separator: true },\n    { entry: translate('Unlink'), action: () => elementTemplates.unlinkTemplate(element) },\n    { entry: <RemoveTemplate />, action: () => elementTemplates.removeTemplate(element) }\n  ];\n\n  return (\n    <DropdownButton menuItems={ menuItems } class=\"bio-properties-panel-template-not-found\">\n      <HeaderButton>\n        <span>{ translate('Not found') }</span>\n        <ArrowIcon class=\"bio-properties-panel-arrow-down\" />\n      </HeaderButton>\n    </DropdownButton>\n  );\n}\n\nfunction NotFoundText() {\n  const translate = useService('translate');\n\n  return (\n    <div class=\"bio-properties-panel-template-not-found-text\">\n      { translate(\n        'The template applied was not found. Therefore, its properties cannot be shown. Unlink to access the data.'\n      ) }\n    </div>\n  );\n}\n\n/**\n *\n * @param {object} props\n * @param {object} element\n * @param {UnknownTemplate} templateState\n * @param {function} unlinkTemplate\n * @param {function} updateTemplate\n */\nfunction OutdatedTemplate({ element, templateState }) {\n  const { newerTemplate, compatible } = templateState;\n\n  const translate = useService('translate'),\n        elementTemplates = useService('elementTemplates');\n\n  const menuItems = [\n    { entry: <UpdateAvailableText newerTemplate={ newerTemplate } compatible={ compatible } /> },\n    { separator: true },\n    { entry: translate('Update'), action: () => elementTemplates.applyTemplate(element, newerTemplate) },\n    { entry: translate('Unlink'), action: () => elementTemplates.unlinkTemplate(element) },\n    { entry: <RemoveTemplate />, action: () => elementTemplates.removeTemplate(element) }\n  ];\n\n  const cls = compatible\n    ? 'bio-properties-panel-template-update-available'\n    : 'bio-properties-panel-template-incompatible';\n\n  const text = compatible\n    ? translate('Update available')\n    : translate('Incompatible');\n\n  return (\n    <DropdownButton menuItems={ menuItems } class={ cls }>\n      <HeaderButton>\n        <span>{ text }</span>\n        <ArrowIcon class=\"bio-properties-panel-arrow-down\" />\n      </HeaderButton>\n    </DropdownButton>\n  );\n}\n\nfunction UpdateAvailableText({ newerTemplate, compatible }) {\n  const translate = useService('translate');\n\n  const text = compatible\n    ? translate(\n      'A new version of the template is available: {templateVersion}',\n      { templateVersion: getVersionOrDateFromTemplate(newerTemplate) }\n    )\n    : translate(\n      'A version of this template is available that supports your environment: {templateVersion}',\n      { templateVersion: getVersionOrDateFromTemplate(newerTemplate) }\n    );\n\n  return <div class=\"bio-properties-panel-template-update-available-text\">{text}</div>;\n}\n\nfunction DeprecatedTemplate({ element, templateState }) {\n  const { template } = templateState;\n\n  const translate = useService('translate'),\n        elementTemplates = useService('elementTemplates');\n\n  const menuItems = [\n    { entry: <DeprecationWarning template={ template } /> },\n    { separator: true },\n    { entry: translate('Unlink'), action: () => elementTemplates.unlinkTemplate(element) },\n    { entry: <RemoveTemplate />, action: () => elementTemplates.removeTemplate(element) }\n  ];\n\n  return (\n    <DropdownButton menuItems={ menuItems } class=\"bio-properties-panel-deprecated-template-button\">\n      <HeaderButton>\n        <span>{ translate('Deprecated') }</span>\n        <ArrowIcon class=\"bio-properties-panel-arrow-down\" />\n      </HeaderButton>\n    </DropdownButton>\n  );\n}\n\nfunction DeprecationWarning({ template }) {\n  const translate = useService('translate');\n\n  const {\n    message = translate('This template is deprecated.'),\n    documentationRef\n  } = template.deprecated;\n\n  return <div class=\"bio-properties-panel-deprecated-template-text\">\n    {message}\n    {documentationRef && <>&nbsp;<a href={ documentationRef }><DocumentationIcon /></a></>}\n  </div>;\n}\n\nfunction DocumentationIcon() {\n  return <svg width=\"12\" height=\"12\" viewBox=\"0 0 12 12\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M10.6368 10.6375V5.91761H11.9995V10.6382C11.9995 10.9973 11.8623 11.3141 11.5878 11.5885C11.3134 11.863 10.9966 12.0002 10.6375 12.0002H1.36266C0.982345 12.0002 0.660159 11.8681 0.396102 11.6041C0.132044 11.34 1.52588e-05 11.0178 1.52588e-05 10.6375V1.36267C1.52588e-05 0.98236 0.132044 0.660173 0.396102 0.396116C0.660159 0.132058 0.982345 2.95639e-05 1.36266 2.95639e-05H5.91624V1.36267H1.36266V10.6375H10.6368ZM12 0H7.2794L7.27873 1.36197H9.68701L3.06507 7.98391L4.01541 8.93425L10.6373 2.31231V4.72059H12V0Z\" fill=\"#818798\" />\n  </svg>;\n}\n\nfunction IncompatibleTemplate({ element }) {\n  const translate = useService('translate'),\n        elementTemplates = useService('elementTemplates');\n\n  const menuItems = [\n    { entry: <IncompatibleText /> },\n    { separator: true },\n    { entry: translate('Unlink'), action: () => elementTemplates.unlinkTemplate(element) },\n    { entry: <RemoveTemplate />, action: () => elementTemplates.removeTemplate(element) }\n  ];\n\n  return (\n    <DropdownButton menuItems={ menuItems } class=\"bio-properties-panel-template-incompatible\">\n      <HeaderButton>\n        <span>{ translate('Incompatible') }</span>\n        <ArrowIcon class=\"bio-properties-panel-arrow-down\" />\n      </HeaderButton>\n    </DropdownButton>\n  );\n}\n\nfunction IncompatibleText() {\n  const translate = useService('translate');\n\n  return (\n    <div class=\"bio-properties-panel-template-incompatible-text\">\n      { translate(\n        'No compatible version of this template was found for your environment. Unlink to access the templates data.'\n      ) }\n    </div>\n  );\n}\n\n\n// helper //////\n\n/**\n * Determine template state in the current element.\n *\n * @param {object} elementTemplates\n * @param {object} element\n * @param {function} getTemplateId\n * @returns {TemplateState}\n */\nfunction getTemplateState(elementTemplates, element, getTemplateId) {\n  const templateId = getTemplateId(element),\n        template = elementTemplates.get(element);\n\n  if (!templateId) {\n    return { type: 'NO_TEMPLATE' };\n  }\n\n  if (!template) {\n    return { type: 'UNKNOWN_TEMPLATE', templateId };\n  }\n\n  if (template.deprecated) {\n    return { type: 'DEPRECATED_TEMPLATE', template };\n  }\n\n  const compatible = elementTemplates.isCompatible(template);\n\n  const latestTemplate = elementTemplates.getLatest(templateId, { deprecated: true })[0];\n\n  if (latestTemplate && latestTemplate !== template) {\n    return { type: 'OUTDATED_TEMPLATE', template, newerTemplate: latestTemplate, compatible };\n  }\n\n  if (!compatible) {\n    return { type: 'INCOMPATIBLE_TEMPLATE', template };\n  }\n\n  return { type: 'KNOWN_TEMPLATE', template };\n}\n","import { useService } from 'bpmn-js-properties-panel';\n\nimport { getVersionOrDateFromTemplate } from '../utils/templateUtil';\n\nexport function TemplateProps({ element, elementTemplates }) {\n  const template = elementTemplates.get(element);\n\n  if (!template) {\n    return [];\n  }\n\n  return [\n    {\n      id: 'template-name',\n      component: TemplateName,\n      template\n    },\n    {\n      id: 'template-version',\n      component: TemplateVersion,\n      template\n    },\n    {\n      id: 'template-description',\n      component: TemplateDescription,\n      template\n    }\n  ].filter(entry => !!entry.component);\n}\n\nfunction TemplateName({ id, template }) {\n  const translate = useService('translate');\n\n  return <TextEntry id={ id } label={ translate('Name') } content={ template.name } />;\n}\n\nfunction TemplateVersion({ id, template }) {\n  const translate = useService('translate');\n\n  const version = getVersionOrDateFromTemplate(template);\n\n  return version ? <TextEntry id={ id } label={ translate('Version') } content={ version } /> : null;\n}\n\nfunction TemplateDescription({ id, template }) {\n  const translate = useService('translate');\n\n  const { description } = template;\n\n  return description ?\n    <TextEntry id={ id } label={ translate('Description') } content={ template.description } /> :\n    null;\n}\n\nfunction TextEntry({ id, label, content }) {\n  return <div data-entry-id={ id } class=\"bio-properties-panel-entry bio-properties-panel-text-entry\">\n    <span class=\"bio-properties-panel-label\">{ label }</span>\n    <span class=\"bio-properties-panel-text-entry__content\">{ content }</span>\n  </div>;\n}\n","import{h as r,Component as t}from\"preact\";var e,o={};function n(r,t,e){if(3===r.nodeType){var o=\"textContent\"in r?r.textContent:r.nodeValue||\"\";if(!1!==n.options.trim){var a=0===t||t===e.length-1;if((!(o=o.match(/^[\\s\\n]+$/g)&&\"all\"!==n.options.trim?\" \":o.replace(/(^[\\s\\n]+|[\\s\\n]+$)/g,\"all\"===n.options.trim||a?\"\":\" \"))||\" \"===o)&&e.length>1&&a)return null}return o}if(1!==r.nodeType)return null;var p=String(r.nodeName).toLowerCase();if(\"script\"===p&&!n.options.allowScripts)return null;var l,s,u=n.h(p,function(r){var t=r&&r.length;if(!t)return null;for(var e={},o=0;o<t;o++){var a=r[o],i=a.name,p=a.value;\"on\"===i.substring(0,2)&&n.options.allowEvents&&(p=new Function(p)),e[i]=p}return e}(r.attributes),(s=(l=r.childNodes)&&Array.prototype.map.call(l,n).filter(i))&&s.length?s:null);return n.visitor&&n.visitor(u),u}var a,i=function(r){return r},p={};function l(r){var t=(r.type||\"\").toLowerCase(),e=l.map;e&&e.hasOwnProperty(t)?(r.type=e[t],r.props=Object.keys(r.props||{}).reduce(function(t,e){var o;return t[(o=e,o.replace(/-(.)/g,function(r,t){return t.toUpperCase()}))]=r.props[e],t},{})):r.type=t.replace(/[^a-z0-9-]/i,\"\")}export default(function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.setReviver=function(r){a=r},i.prototype.shouldComponentUpdate=function(r){var t=this.props;return r.wrap!==t.wrap||r.type!==t.type||r.markup!==t.markup},i.prototype.setComponents=function(r){if(this.map={},r)for(var t in r)if(r.hasOwnProperty(t)){var e=t.replace(/([A-Z]+)([A-Z][a-z0-9])|([a-z0-9]+)([A-Z])/g,\"$1$3-$2$4\").toLowerCase();this.map[e]=r[t]}},i.prototype.render=function(t){var i=t.wrap;void 0===i&&(i=!0);var s,u=t.type,c=t.markup,m=t.components,v=t.reviver,f=t.onError,d=t[\"allow-scripts\"],h=t[\"allow-events\"],y=t.trim,w=function(r,t){var e={};for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&-1===t.indexOf(o)&&(e[o]=r[o]);return e}(t,[\"wrap\",\"type\",\"markup\",\"components\",\"reviver\",\"onError\",\"allow-scripts\",\"allow-events\",\"trim\"]),C=v||this.reviver||this.constructor.prototype.reviver||a||r;this.setComponents(m);var g={allowScripts:d,allowEvents:h,trim:y};try{s=function(r,t,a,i,s){var u=function(r,t){var o,n,a,i,p=\"html\"===t?\"text/html\":\"application/xml\";\"html\"===t?(i=\"body\",a=\"<!DOCTYPE html>\\n<html><body>\"+r+\"</body></html>\"):(i=\"xml\",a='<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n<xml>'+r+\"</xml>\");try{o=(new DOMParser).parseFromString(a,p)}catch(r){n=r}if(o||\"html\"!==t||((o=e||(e=function(){if(document.implementation&&document.implementation.createHTMLDocument)return document.implementation.createHTMLDocument(\"\");var r=document.createElement(\"iframe\");return r.style.cssText=\"position:absolute; left:0; top:-999em; width:1px; height:1px; overflow:hidden;\",r.setAttribute(\"sandbox\",\"allow-forms\"),document.body.appendChild(r),r.contentWindow.document}())).open(),o.write(a),o.close()),o){var l=o.getElementsByTagName(i)[0],s=l.firstChild;return r&&!s&&(l.error=\"Document parse failed.\"),s&&\"parsererror\"===String(s.nodeName).toLowerCase()&&(s.removeChild(s.firstChild),s.removeChild(s.lastChild),l.error=s.textContent||s.nodeValue||n||\"Unknown error\",l.removeChild(s)),l}}(r,t);if(u&&u.error)throw new Error(u.error);var c=u&&u.body||u;l.map=i||p;var m=c&&function(r,t,e,a){return n.visitor=t,n.h=e,n.options=a||o,n(r)}(c,l,a,s);return l.map=null,m&&m.props&&m.props.children||null}(c,u,C,this.map,g)}catch(r){f?f({error:r}):\"undefined\"!=typeof console&&console.error&&console.error(\"preact-markup: \"+r)}if(!1===i)return s||null;var x=w.hasOwnProperty(\"className\")?\"className\":\"class\",b=w[x];return b?b.splice?b.splice(0,0,\"markup\"):\"string\"==typeof b?w[x]+=\" markup\":\"object\"==typeof b&&(b.markup=!0):w[x]=\"markup\",C(\"div\",w,s||null)},i}(t));\n//# sourceMappingURL=preact-markup.module.js.map\n","/**\n * Copied from existing form-js#Sanitizer\n * cf. https://github.com/bpmn-io/form-js/blob/master/packages/form-js-viewer/src/render/components/Sanitizer.js\n */\n\nconst NODE_TYPE_TEXT = 3,\n      NODE_TYPE_ELEMENT = 1;\n\nconst ALLOWED_NODES = [\n  'h1',\n  'h2',\n  'h3',\n  'h4',\n  'h5',\n  'span',\n  'em',\n  'a',\n  'p',\n  'div',\n  'ul',\n  'ol',\n  'li',\n  'hr',\n  'blockquote',\n  'img',\n  'pre',\n  'code',\n  'br',\n  'strong'\n];\n\nconst ALLOWED_ATTRIBUTES = [\n  'align',\n  'alt',\n  'class',\n  'href',\n  'id',\n  'name',\n  'rel',\n  'target',\n  'src'\n];\n\nconst ALLOWED_URI_PATTERN = /^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i; // eslint-disable-line no-useless-escape\nconst ATTR_WHITESPACE_PATTERN = /[\\u0000-\\u0020\\u00A0\\u1680\\u180E\\u2000-\\u2029\\u205F\\u3000]/g; // eslint-disable-line no-control-regex\n\nconst FORM_ELEMENT = document.createElement('form');\n\n/**\n * Sanitize a HTML string and return the cleaned, safe version.\n *\n * @param {string} html\n * @return {string}\n */\nexport function sanitizeHTML(html) {\n\n  const doc = new DOMParser().parseFromString(\n    `<!DOCTYPE html>\\n<html><body><div>${ html }`,\n    'text/html'\n  );\n\n  doc.normalize();\n\n  const element = doc.body.firstChild;\n\n  if (element) {\n    sanitizeNode(/** @type Element */ (element));\n\n    return new XMLSerializer().serializeToString(element);\n  } else {\n\n    // handle the case that document parsing\n    // does not work at all, due to HTML gibberish\n    return '';\n  }\n}\n\n/**\n * Recursively sanitize a HTML node, potentially\n * removing it, its children or attributes.\n *\n * Inspired by https://github.com/developit/snarkdown/issues/70\n * and https://github.com/cure53/DOMPurify. Simplified\n * for our use-case.\n *\n * @param {Element} node\n */\nfunction sanitizeNode(node) {\n\n  // allow text nodes\n  if (node.nodeType === NODE_TYPE_TEXT) {\n    return;\n  }\n\n  // disallow all other nodes but Element\n  if (node.nodeType !== NODE_TYPE_ELEMENT) {\n    return node.remove();\n  }\n\n  const lcTag = node.tagName.toLowerCase();\n\n  // disallow non-whitelisted tags\n  if (!ALLOWED_NODES.includes(lcTag)) {\n    return node.remove();\n  }\n\n  const attributes = node.attributes;\n\n  // clean attributes\n  for (let i = attributes.length; i--;) {\n    const attribute = attributes[i];\n\n    const name = attribute.name;\n    const lcName = name.toLowerCase();\n\n    // normalize node value\n    const value = attribute.value.trim();\n\n    node.removeAttribute(name);\n\n    const valid = isValidAttribute(lcTag, lcName, value);\n\n    if (valid) {\n      node.setAttribute(name, value);\n    }\n\n  }\n\n  // force noopener on target=\"_blank\" links\n  if (lcTag === 'a' && node.getAttribute('target') === '_blank' && node.getAttribute('rel') !== 'noopener') {\n    node.setAttribute('rel', 'noopener');\n  }\n\n  for (let i = node.childNodes.length; i--;) {\n    sanitizeNode(/** @type Element */ (node.childNodes[i]));\n  }\n}\n\n\n/**\n * Validates attributes for validity.\n *\n * @param {string} lcTag\n * @param {string} lcName\n * @param {string} value\n * @return {boolean}\n */\nfunction isValidAttribute(lcTag, lcName, value) {\n\n  // disallow most attributes based on whitelist\n  if (!ALLOWED_ATTRIBUTES.includes(lcName)) {\n    return false;\n  }\n\n  // disallow \"DOM clobbering\" / polution of document and wrapping form elements\n  if ((lcName === 'id' || lcName === 'name') && (value in document || value in FORM_ELEMENT)) {\n    return false;\n  }\n\n  if (lcName === 'target' && value !== '_blank') {\n    return false;\n  }\n\n  // allow valid url links only\n  if (lcName === 'href' && !ALLOWED_URI_PATTERN.test(value.replace(ATTR_WHITESPACE_PATTERN, ''))) {\n    return false;\n  }\n\n  return true;\n}","import Markup from 'preact-markup';\n\nimport { sanitizeHTML } from '../../../utils/sanitize';\n\nexport function PropertyTooltip(props) {\n\n  const {\n    tooltip\n  } = props;\n\n  return tooltip && (\n    <Markup\n      markup={ sanitizeHTML(tooltip) }\n      trim={ false } />\n  );\n}","import { find, groupBy } from 'min-dash';\nimport { getPropertyValue, setPropertyValue, validateProperty } from '../../../util/propertyUtil';\nimport { shouldCastToFeel, toFeelExpression } from '../../../util/FeelUtil';\n\nimport { useCallback, useState } from '@bpmn-io/properties-panel/preact/hooks';\n\nexport function usePropertyAccessors(bpmnFactory, commandStack, element, property) {\n  const directSet = useCallback(propertySetter(bpmnFactory, commandStack, element, property), [ bpmnFactory, commandStack, element, property ]);\n  const directGet = useCallback(propertyGetter(element, property), [ element, property ]);\n\n  const [ isFeelEnabled, setIsFeelEnabled ] = useState(feelEnabled(property, directGet()));\n\n  const handleFeelToggle = useCallback((value) => {\n    if (!isFeelEnabled && typeof value === 'string' && value.startsWith('=')) {\n      setIsFeelEnabled(true);\n    }\n\n    if (isFeelEnabled && (typeof value !== 'string' || !value.startsWith('='))) {\n      setIsFeelEnabled(false);\n    }\n  }, [ isFeelEnabled ]);\n\n  const set = useCallback((value, error) => {\n    handleFeelToggle(value);\n    directSet(toFeelExpression(value, property.type));\n  }, [ directSet, property, handleFeelToggle ]);\n\n  const get = useCallback(() => {\n    if (isFeelEnabled) {\n      return directGet();\n    }\n\n    return fromFeelExpression(directGet(), property.type);\n  }, [ directGet, property, isFeelEnabled ]);\n\n  if (!shouldCastToFeel(property)) {\n    return [ directGet, directSet ];\n  }\n\n  return [ get, set ];\n}\n\n\nconst fromFeelExpression = (value, type) => {\n  if (typeof value === 'undefined') {\n    return value;\n  }\n\n  if (typeof value === 'string' && value.startsWith('=')) {\n    value = value.slice(1);\n  }\n\n  if (type === 'Number') {\n    return Number(value);\n  }\n\n  if (type === 'Boolean') {\n    return value !== 'false';\n  }\n\n  return value;\n};\n\nconst feelEnabled = (property, value) => {\n  if (!shouldCastToFeel(property)) {\n    return true;\n  }\n\n  if (property.type === 'Boolean') {\n    return !(value === '=true' || value === '=false');\n  }\n\n  if (property.type === 'Number') {\n    return isNaN(fromFeelExpression(value, property.type));\n  }\n\n  return true;\n};\n\n\nexport function propertyGetter(element, property) {\n  return function getValue() {\n    return getPropertyValue(element, property);\n  };\n}\n\nexport function propertySetter(bpmnFactory, commandStack, element, property) {\n  return function setValue(value) {\n    return setPropertyValue(bpmnFactory, commandStack, element, property, value);\n  };\n}\n\nexport function propertyValidator(translate, property) {\n  return value => validateProperty(value, property, translate);\n}\n\nexport function groupByGroupId(properties) {\n  return groupBy(properties, 'group');\n}\n\nexport function findCustomGroup(groups, id) {\n  return find(groups, g => g.id === id);\n}\n\n/**\n * Is the given property executed by the engine?\n *\n * @param { { binding: { type: string } } } property\n * @return {boolean}\n */\nexport function isExternalProperty(property) {\n  return [ 'zeebe:property', 'zeebe:taskHeader' ].includes(property.binding.type);\n}\n","import Markup from 'preact-markup';\nimport { useService } from 'bpmn-js-properties-panel';\n\nimport { sanitizeHTML } from '../utils/sanitize';\n\nexport function PropertyDescription(props) {\n  const {\n    description\n  } = props;\n\n  const translate = useService('translate');\n\n  return description && (\n    <Markup\n      markup={ sanitizeHTML(translate(description)) }\n      trim={ false } />\n  );\n}","import { useService } from 'bpmn-js-properties-panel';\nimport { PropertyDescription } from '../../../../components/PropertyDescription';\nimport { PropertyTooltip } from '../../components/PropertyTooltip';\nimport { TextAreaEntry } from '@bpmn-io/properties-panel';\nimport {\n  propertyGetter,\n  propertySetter,\n  propertyValidator\n} from './util';\n\nexport function TextAreaProperty(props) {\n  const {\n    element,\n    id,\n    property\n  } = props;\n\n  const {\n    description,\n    editable,\n    label,\n    feel,\n    language,\n    placeholder,\n    tooltip\n  } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        commandStack = useService('commandStack'),\n        debounce = useService('debounceInput'),\n        translate = useService('translate');\n\n  return TextAreaEntry({\n    debounce,\n    element,\n    id,\n    label,\n    feel,\n    placeholder,\n    monospace: !!language,\n    autoResize: true,\n    description: PropertyDescription({ description }),\n    getValue: propertyGetter(element, property),\n    setValue: propertySetter(bpmnFactory, commandStack, element, property),\n    validate: propertyValidator(translate, property),\n    disabled: editable === false,\n    tooltip: PropertyTooltip({ tooltip })\n  });\n}\n","import { useService } from 'bpmn-js-properties-panel';\nimport { PropertyDescription } from '../../../../components/PropertyDescription';\nimport { PropertyTooltip } from '../../components/PropertyTooltip';\nimport { TextFieldEntry } from '@bpmn-io/properties-panel';\nimport { propertyGetter, propertySetter, propertyValidator } from './util';\n\nexport function StringProperty(props) {\n  const {\n    element,\n    id,\n    property\n  } = props;\n\n  const {\n    description,\n    editable,\n    label,\n    feel,\n    placeholder,\n    tooltip\n  } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        commandStack = useService('commandStack'),\n        debounce = useService('debounceInput'),\n        translate = useService('translate');\n\n  return TextFieldEntry({\n    debounce,\n    element,\n    getValue: propertyGetter(element, property),\n    id,\n    label,\n    feel,\n    placeholder,\n    description: PropertyDescription({ description }),\n    setValue: propertySetter(bpmnFactory, commandStack, element, property),\n    validate: propertyValidator(translate, property),\n    disabled: editable === false,\n    tooltip: PropertyTooltip({ tooltip })\n  });\n}\n","import { getVariablesForElement } from '@bpmn-io/extract-process-variables/zeebe';\nimport { useEffect, useState } from '@bpmn-io/properties-panel/preact/hooks';\nimport { useService } from 'bpmn-js-properties-panel';\n\nfunction useServiceIfAvailable(service, fallback) {\n  const resolved = useService(service, false);\n\n  if (!resolved) {\n    return fallback;\n  }\n\n  return resolved;\n}\n\nexport function withVariableContext(Component) {\n  return props => {\n    const { bpmnElement, element } = props;\n\n    const bo = (bpmnElement || element).businessObject;\n\n    const [ variables, setVariables ] = useState([]);\n    const eventBus = useService('eventBus');\n\n    const variableResolver = useServiceIfAvailable('variableResolver', { getVariablesForElement });\n\n    useEffect(() => {\n      const extractVariables = async () => {\n\n        const variables = await variableResolver.getVariablesForElement(bo);\n\n        setVariables(variables.map(variable => {\n          return {\n            ...variable,\n            info: variable.info ||\n                  (variable.origin && ('Written in ' + variable.origin.map(origin => origin.name || origin.id).join(', ')))\n          };\n        }));\n      };\n\n      // The callback must return undefined, so the event propagation is not canceled.\n      // Cf. https://github.com/camunda/camunda-modeler/issues/3392\n      const callback = () => {\n        extractVariables();\n      };\n\n      eventBus.on('commandStack.changed', callback);\n      callback();\n\n      return () => {\n        eventBus.off('commandStack.changed', callback);\n      };\n    }, [ bo ]);\n\n    return <Component { ...props } variables={ variables }></Component>;\n  };\n}","import { useMemo } from '@bpmn-io/properties-panel/preact/hooks';\nimport { useService } from 'bpmn-js-properties-panel';\n\nexport function withTooltipContainer(Component) {\n  return props => {\n    const tooltipContainer = useMemo(() => {\n      const config = useService('config');\n\n      return config && config.propertiesPanel && config.propertiesPanel.feelTooltipContainer;\n    }, [ ]);\n\n    return <Component { ...props }\n      tooltipContainer={ tooltipContainer }\n    ></Component>;\n  };\n}","import { FeelEntry as BaseFeelEntry, FeelTextAreaEntry as BaseFeelTextAreaEntry } from '@bpmn-io/properties-panel';\nimport { withTooltipContainer, withVariableContext } from './HOCs';\n\nexport const FeelEntry = withTooltipContainer(BaseFeelEntry);\nexport const FeelTextAreaEntry = withTooltipContainer(BaseFeelTextAreaEntry);\n\nexport const FeelEntryWithVariableContext = withVariableContext(FeelEntry);\nexport const FeelTextAreaEntryWithVariableContext = withVariableContext(FeelTextAreaEntry);","import { useService } from 'bpmn-js-properties-panel';\nimport { PropertyDescription } from '../../../../components/PropertyDescription';\nimport { PropertyTooltip } from '../../components/PropertyTooltip';\nimport { FeelEntryWithVariableContext, FeelEntry } from '../../../../entries/FeelEntryWithContext';\nimport { propertyGetter, propertySetter, propertyValidator, isExternalProperty } from './util';\n\nexport function FeelProperty(props) {\n  const {\n    element,\n    id,\n    property\n  } = props;\n\n  const {\n    description,\n    editable,\n    label,\n    feel,\n    placeholder,\n    tooltip\n  } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        commandStack = useService('commandStack'),\n        debounce = useService('debounceInput'),\n        translate = useService('translate');\n\n  const TextFieldComponent = !isExternalProperty(property)\n    ? FeelEntryWithVariableContext\n    : FeelEntry;\n\n  return TextFieldComponent({\n    debounce,\n    element,\n    getValue: propertyGetter(element, property),\n    id,\n    label,\n    feel,\n    placeholder,\n    description: PropertyDescription({ description }),\n    setValue: propertySetter(bpmnFactory, commandStack, element, property),\n    validate: propertyValidator(translate, property),\n    disabled: editable === false,\n    tooltip: PropertyTooltip({ tooltip })\n  });\n}\n","import { useService } from 'bpmn-js-properties-panel';\nimport { PropertyDescription } from '../../../../components/PropertyDescription';\nimport { PropertyTooltip } from '../../components/PropertyTooltip';\nimport {\n  FeelTextAreaEntryWithVariableContext,\n  FeelTextAreaEntry\n} from '../../../../entries/FeelEntryWithContext';\nimport { propertyGetter, propertySetter, propertyValidator, isExternalProperty } from './util';\n\nexport function FeelTextAreaProperty(props) {\n  const {\n    element,\n    id,\n    property\n  } = props;\n\n  const {\n    description,\n    editable,\n    label,\n    feel,\n    placeholder,\n    tooltip\n  } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        commandStack = useService('commandStack'),\n        debounce = useService('debounceInput'),\n        translate = useService('translate');\n\n  const TextAreaComponent = !isExternalProperty(property)\n    ? FeelTextAreaEntryWithVariableContext\n    : FeelTextAreaEntry;\n\n  return TextAreaComponent({\n    debounce,\n    element,\n    getValue: propertyGetter(element, property),\n    id,\n    label,\n    feel,\n    placeholder,\n    description: PropertyDescription({ description }),\n    setValue: propertySetter(bpmnFactory, commandStack, element, property),\n    validate: propertyValidator(translate, property),\n    disabled: editable === false,\n    tooltip: PropertyTooltip({ tooltip })\n  });\n}\n","import { useService } from 'bpmn-js-properties-panel';\nimport { PropertyDescription } from '../../../../components/PropertyDescription';\nimport { PropertyTooltip } from '../../components/PropertyTooltip';\nimport { SelectEntry } from '@bpmn-io/properties-panel';\nimport { propertyGetter, propertySetter, propertyValidator } from './util';\n\nexport function DropdownProperty(props) {\n  const {\n    element,\n    id,\n    property\n  } = props;\n\n  const {\n    description,\n    editable,\n    label,\n    tooltip\n  } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        commandStack = useService('commandStack'),\n        translate = useService('translate');\n\n  const getOptions = () => {\n    const { choices, optional } = property;\n    let dropdownOptions = [];\n\n    dropdownOptions = choices.map(({ name, value }) => {\n      return {\n        label: name,\n        value\n      };\n    });\n\n    if (optional) {\n      dropdownOptions = [ { label: '', value: undefined }, ...dropdownOptions ];\n    }\n\n    return dropdownOptions;\n  };\n\n  return SelectEntry({\n    element,\n    id,\n    label,\n    getOptions,\n    description: PropertyDescription({ description }),\n    getValue: propertyGetter(element, property),\n    setValue: propertySetter(bpmnFactory, commandStack, element, property),\n    validate: propertyValidator(translate, property),\n    disabled: editable === false,\n    tooltip: PropertyTooltip({ tooltip })\n  });\n}\n","import { useService } from 'bpmn-js-properties-panel';\nimport { PropertyDescription } from '../../../../components/PropertyDescription';\nimport { PropertyTooltip } from '../../components/PropertyTooltip';\nimport { CheckboxEntry, FeelCheckboxEntry } from '@bpmn-io/properties-panel';\nimport { usePropertyAccessors } from './util';\n\nexport function BooleanProperty(props) {\n  const {\n    element,\n    id,\n    property\n  } = props;\n\n  const {\n    description,\n    editable,\n    label,\n    tooltip,\n    feel\n  } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        commandStack = useService('commandStack'),\n        debounce = useService('debounceInput'),\n        translate = useService('translate');\n\n  const Component = feel === 'optional' ? FeelCheckboxEntry : CheckboxEntry;\n\n  const [ getValue, setValue ] = usePropertyAccessors(bpmnFactory, commandStack, element, property);\n\n  return Component({\n    element,\n    debounce,\n    translate,\n    getValue,\n    id,\n    label,\n    description: PropertyDescription({ description }),\n    setValue,\n    disabled: editable === false,\n    tooltip: PropertyTooltip({ tooltip })\n  });\n}\n","import { FeelNumberEntry, NumberFieldEntry } from '@bpmn-io/properties-panel';\nimport { useService } from 'bpmn-js-properties-panel';\nimport { propertyValidator, usePropertyAccessors } from './util';\nimport { shouldCastToFeel } from '../../../util/FeelUtil';\nimport { PropertyDescription } from '../../../../components/PropertyDescription';\nimport { PropertyTooltip } from '../../components/PropertyTooltip';\nimport { useCallback } from '@bpmn-io/properties-panel/preact/hooks';\nimport { isNumber } from 'min-dash';\n\nexport function NumberProperty(props) {\n  const {\n    element,\n    id,\n    property\n  } = props;\n\n  const {\n    description,\n    editable,\n    label,\n    feel,\n    tooltip\n  } = property;\n\n  const Component = feel === 'optional' ? FeelNumberEntry : NumberFieldEntry;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        commandStack = useService('commandStack'),\n        debounce = useService('debounceInput'),\n        translate = useService('translate');\n\n  const [ getValue, setValue ] = usePropertyAccessors(bpmnFactory, commandStack, element, property);\n\n  const validate = useCallback((value) => {\n    if (shouldCastToFeel(property) && isNumber(value) && value.toString().includes('e')) {\n      return translate('Scientific notation is disallowed in FEEL.');\n    }\n\n    const defaultValidator = propertyValidator(translate, property);\n    return defaultValidator(value);\n  }, [ translate, property ]);\n\n  return Component({\n    debounce,\n    element,\n    getValue,\n    id,\n    label,\n    description: PropertyDescription({ description }),\n    setValue,\n    validate: validate,\n    disabled: editable === false,\n    tooltip: PropertyTooltip({ tooltip })\n  });\n}\n","import { forEach } from 'min-dash';\n\n\nimport { PropertyTooltip } from '../../components/PropertyTooltip';\n\nimport {\n  Group,\n  isSelectEntryEdited,\n  isCheckboxEntryEdited,\n  isTextAreaEntryEdited,\n  isTextFieldEntryEdited,\n  isFeelEntryEdited,\n  isNumberFieldEntryEdited\n} from '@bpmn-io/properties-panel';\n\nimport {\n  PROPERTY_TYPE,\n  ZEEBE_TASK_DEFINITION_TYPE_TYPE,\n  ZEEBE_TASK_DEFINITION,\n  ZEBBE_INPUT_TYPE,\n  ZEEBE_OUTPUT_TYPE,\n  ZEEBE_PROPERTY_TYPE,\n  ZEEBE_TASK_HEADER_TYPE\n} from '../../../util/bindingTypes';\n\nimport { groupByGroupId, findCustomGroup } from './util';\nimport { TextAreaProperty } from './TextAreaProperty';\nimport { StringProperty } from './StringProperty';\nimport { FeelProperty } from './FeelProperty';\nimport { FeelTextAreaProperty } from './FeelTextAreaProperty';\nimport { DropdownProperty } from './DropdownProperty';\nimport { BooleanProperty } from './BooleanProperty';\nimport { NumberProperty } from './NumberProperty';\n\n\nexport function CustomProperties(props) {\n  const {\n    element,\n    elementTemplate,\n    injector\n  } = props;\n\n  const translate = injector.get('translate');\n\n  const groups = [];\n\n  const {\n    id,\n    properties,\n    groups: propertyGroups\n  } = elementTemplate;\n\n  // (1) group properties by group id\n  const groupedProperties = groupByGroupId(properties);\n  const defaultProps = [];\n\n  forEach(groupedProperties, (properties, groupId) => {\n\n    const group = findCustomGroup(propertyGroups, groupId);\n\n    if (!group) {\n      return defaultProps.push(...properties);\n    }\n\n    addCustomGroup(groups, {\n      element,\n      id: `ElementTemplates__CustomProperties-${groupId}`,\n      label: translate(group.label),\n      openByDefault: group.openByDefault,\n      properties: properties,\n      templateId: `${id}-${groupId}`,\n      tooltip: PropertyTooltip({ tooltip: group.tooltip })\n    });\n  });\n\n  // (2) add default custom props\n  if (defaultProps.length) {\n    addCustomGroup(groups, {\n      id: 'ElementTemplates__CustomProperties',\n      label: translate('Custom properties'),\n      element,\n      properties: defaultProps,\n      templateId: id\n    });\n  }\n\n  return groups;\n}\n\nfunction addCustomGroup(groups, props) {\n\n  const {\n    element,\n    id,\n    label,\n    openByDefault = true,\n    properties,\n    templateId,\n    tooltip\n  } = props;\n\n  const customPropertiesGroup = {\n    id,\n    label,\n    component: Group,\n    entries: [],\n    shouldOpen: openByDefault,\n    tooltip\n  };\n\n  properties.forEach((property, index) => {\n    const entry = createCustomEntry(`custom-entry-${ templateId }-${ index }`, element, property);\n\n    if (entry) {\n      customPropertiesGroup.entries.push(entry);\n    }\n  });\n\n  if (customPropertiesGroup.entries.length) {\n    groups.push(customPropertiesGroup);\n  }\n}\n\nfunction createCustomEntry(id, element, property) {\n  let { type, feel } = property;\n\n  if (!type) {\n    type = getDefaultType(property);\n  }\n\n  if (feel === 'required') {\n    return {\n      id,\n      component: FeelProperty,\n      isEdited: isFeelEntryEdited,\n      property\n    };\n  }\n\n  if (type === 'Number') {\n    return {\n      id,\n      component: NumberProperty,\n      isEdited: isNumberFieldEntryEdited,\n      property\n    };\n  }\n\n  if (type === 'Boolean') {\n    return {\n      id,\n      component: BooleanProperty,\n      isEdited: isCheckboxEntryEdited,\n      property\n    };\n  }\n\n  if (type === 'Dropdown') {\n    return {\n      id,\n      component: DropdownProperty,\n      isEdited: isSelectEntryEdited,\n      property\n    };\n  }\n\n  if (type === 'String') {\n    if (feel) {\n      return {\n        id,\n        component: FeelProperty,\n        isEdited: isFeelEntryEdited,\n        property\n      };\n    }\n    return {\n      id,\n      component: StringProperty,\n      isEdited: isTextFieldEntryEdited,\n      property\n    };\n  }\n\n  if (type === 'Text') {\n    if (feel) {\n      return {\n        id,\n        component: FeelTextAreaProperty,\n        isEdited: isFeelEntryEdited,\n        property\n      };\n    }\n    return {\n      id,\n      component: TextAreaProperty,\n      isEdited: isTextAreaEntryEdited,\n      property\n    };\n  }\n}\n\nfunction getDefaultType(property) {\n  const { binding } = property;\n\n  const { type } = binding;\n\n  if ([\n    PROPERTY_TYPE,\n    ZEEBE_TASK_DEFINITION_TYPE_TYPE,\n    ZEEBE_TASK_DEFINITION,\n    ZEBBE_INPUT_TYPE,\n    ZEEBE_OUTPUT_TYPE,\n    ZEEBE_PROPERTY_TYPE,\n    ZEEBE_TASK_HEADER_TYPE\n  ].includes(type)) {\n    return 'String';\n  }\n}\n\n\n","import {\n  useEffect\n} from '@bpmn-io/properties-panel/preact/hooks';\n\nimport {\n  query as domQuery\n} from 'min-dom';\n\nimport {\n  SelectEntry,\n  usePrevious\n} from '@bpmn-io/properties-panel';\n\n\nexport default function ReferenceSelectEntry(props) {\n  const {\n    autoFocusEntry,\n    element,\n    getOptions\n  } = props;\n\n  const options = getOptions(element);\n  const prevOptions = usePrevious(options);\n\n  // auto focus specifc other entry when options changed\n  useEffect(() => {\n    if (autoFocusEntry && prevOptions && options.length > prevOptions.length) {\n\n      const entry = domQuery(`[data-entry-id=\"${autoFocusEntry}\"]`);\n\n      const focusableInput = domQuery('.bio-properties-panel-input', entry);\n\n      if (focusableInput) {\n        focusableInput.select();\n      }\n    }\n  }, [ options ]);\n\n  return (\n    <SelectEntry { ...props } />\n  );\n}","import {\n  getBusinessObject,\n  is,\n  isAny\n} from 'bpmn-js/lib/util/ModelUtil';\n\nimport {\n  find\n} from 'min-dash';\n\nexport function isErrorSupported(element) {\n  return isAny(element, [\n    'bpmn:StartEvent',\n    'bpmn:BoundaryEvent',\n    'bpmn:EndEvent'\n  ]) && !!getErrorEventDefinition(element);\n}\n\nexport function getErrorEventDefinition(element) {\n  return getEventDefinition(element, 'bpmn:ErrorEventDefinition');\n}\n\nexport function isTimerSupported(element) {\n  return isAny(element, [\n    'bpmn:StartEvent',\n    'bpmn:IntermediateCatchEvent',\n    'bpmn:BoundaryEvent'\n  ]) && !!getTimerEventDefinition(element);\n}\n\n/**\n * Get the timer definition type for a given timer event definition.\n *\n * @param {ModdleElement<bpmn:TimerEventDefinition>} timer\n *\n * @return {string|undefined} the timer definition type\n */\nexport function getTimerDefinitionType(timer) {\n\n  if (!timer) {\n    return;\n  }\n\n  const timeDate = timer.get('timeDate');\n  if (typeof timeDate !== 'undefined') {\n    return 'timeDate';\n  }\n\n  const timeCycle = timer.get('timeCycle');\n  if (typeof timeCycle !== 'undefined') {\n    return 'timeCycle';\n  }\n\n  const timeDuration = timer.get('timeDuration');\n  if (typeof timeDuration !== 'undefined') {\n    return 'timeDuration';\n  }\n}\n\nexport function getTimerEventDefinition(element) {\n  return getEventDefinition(element, 'bpmn:TimerEventDefinition');\n}\n\nexport function getError(element) {\n  const errorEventDefinition = getErrorEventDefinition(element);\n\n  return errorEventDefinition && errorEventDefinition.get('errorRef');\n}\n\nexport function getEventDefinition(element, eventType) {\n  const businessObject = getBusinessObject(element);\n\n  const eventDefinitions = businessObject.get('eventDefinitions') || [];\n\n  return find(eventDefinitions, function(definition) {\n    return is(definition, eventType);\n  });\n}\n\nexport function isMessageSupported(element) {\n  return is(element, 'bpmn:ReceiveTask') || (\n    isAny(element, [\n      'bpmn:StartEvent',\n      'bpmn:EndEvent',\n      'bpmn:IntermediateThrowEvent',\n      'bpmn:BoundaryEvent',\n      'bpmn:IntermediateCatchEvent'\n    ]) && !!getMessageEventDefinition(element)\n  );\n}\n\nexport function getMessageEventDefinition(element) {\n  if (is(element, 'bpmn:ReceiveTask')) {\n    return getBusinessObject(element);\n  }\n\n  return getEventDefinition(element, 'bpmn:MessageEventDefinition');\n}\n\nexport function getMessage(element) {\n  const messageEventDefinition = getMessageEventDefinition(element);\n\n  return messageEventDefinition && messageEventDefinition.get('messageRef');\n}\n\nexport function getLinkEventDefinition(element) {\n  return getEventDefinition(element, 'bpmn:LinkEventDefinition');\n}\n\nexport function getSignalEventDefinition(element) {\n  return getEventDefinition(element, 'bpmn:SignalEventDefinition');\n}\n\nexport function isLinkSupported(element) {\n  return isAny(element, [\n    'bpmn:IntermediateThrowEvent',\n    'bpmn:IntermediateCatchEvent'\n  ]) && !!getLinkEventDefinition(element);\n}\n\nexport function isSignalSupported(element) {\n  return is(element, 'bpmn:Event') && !!getSignalEventDefinition(element);\n}\n\nexport function getSignal(element) {\n  const signalEventDefinition = getSignalEventDefinition(element);\n\n  return signalEventDefinition && signalEventDefinition.get('signalRef');\n}\n\nexport function getEscalationEventDefinition(element) {\n  return getEventDefinition(element, 'bpmn:EscalationEventDefinition');\n}\n\nexport function isEscalationSupported(element) {\n  return is(element, 'bpmn:Event') && !!getEscalationEventDefinition(element);\n}\n\nexport function getEscalation(element) {\n  const escalationEventDefinition = getEscalationEventDefinition(element);\n\n  return escalationEventDefinition && escalationEventDefinition.get('escalationRef');\n}\n\nexport function isCompensationSupported(element) {\n  return isAny(element, [\n    'bpmn:EndEvent',\n    'bpmn:IntermediateThrowEvent'\n  ]) && !!getCompensateEventDefinition(element);\n}\n\nexport function getCompensateEventDefinition(element) {\n  return getEventDefinition(element, 'bpmn:CompensateEventDefinition');\n}\n\nexport function getCompensateActivity(element) {\n  const compensateEventDefinition = getCompensateEventDefinition(element);\n\n  return compensateEventDefinition && compensateEventDefinition.get('activityRef');\n}\n","import {\n  getBusinessObject\n} from 'bpmn-js/lib/util/ModelUtil';\n\nimport {\n  sortBy\n} from 'min-dash';\n\nimport { isSelectEntryEdited } from '@bpmn-io/properties-panel';\nimport ReferenceSelect from '../../../entries/ReferenceSelect';\n\nimport { useService } from 'bpmn-js-properties-panel';\n\nimport {\n  getMessage,\n  getMessageEventDefinition,\n  isMessageSupported\n} from '../../../utils/EventDefinitionUtil';\n\nimport {\n  createElement,\n  findRootElementById,\n  findRootElementsByType,\n  getRoot,\n  nextId\n} from '../../../utils/ElementUtil';\n\nexport const EMPTY_OPTION = '';\nexport const CREATE_NEW_OPTION = 'create-new';\n\n\n/**\n * @typedef { import('@bpmn-io/properties-panel').EntryDefinition } Entry\n */\n\n/**\n * @returns {Array<Entry>} entries\n */\nexport function MessageProps(props) {\n  const {\n    element\n  } = props;\n\n  if (!isMessageSupported(element)) {\n    return [];\n  }\n\n  return [\n    {\n      id: 'messageRef',\n      component: MessageRef,\n      isEdited: isSelectEntryEdited\n    }\n  ];\n}\n\nfunction MessageRef(props) {\n  const { element } = props;\n\n  const bpmnFactory = useService('bpmnFactory');\n  const modeling = useService('modeling');\n  const translate = useService('translate');\n\n  const messageEventDefinition = getMessageEventDefinition(element);\n\n  const getValue = () => {\n    const message = getMessage(element);\n\n    if (message) {\n      return message.get('id');\n    }\n\n    return EMPTY_OPTION;\n  };\n\n  const setValue = (value) => {\n    const root = getRoot(messageEventDefinition);\n\n    let message;\n\n    // (1) create new message\n    if (value === CREATE_NEW_OPTION) {\n      const id = nextId('Message_');\n\n      message = createElement(\n        'bpmn:Message',\n        { id, name: id },\n        root,\n        bpmnFactory\n      );\n\n      value = message.get('id');\n    }\n\n    // (2) update (or remove) messageRef\n    message = findRootElementById(messageEventDefinition, 'bpmn:Message', value) || message;\n\n    // (3) commit all updates\n    return modeling.updateModdleProperties(element, messageEventDefinition, {\n      messageRef: message\n    });\n  };\n\n  const getOptions = () => {\n\n    let options = [\n      { value: EMPTY_OPTION, label: translate('<none>') },\n      { value: CREATE_NEW_OPTION, label: translate('Create new ...') }\n    ];\n\n    const messages = findRootElementsByType(getBusinessObject(element), 'bpmn:Message');\n\n    const filteredMessages = withoutTemplatedMessages(messages);\n\n    sortByName(filteredMessages).forEach(message => {\n      options.push({\n        value: message.get('id'),\n        label: message.get('name')\n      });\n    });\n\n    return options;\n  };\n\n  return ReferenceSelect({\n    element,\n    id: 'messageRef',\n    label: translate('Global message reference'),\n    autoFocusEntry: 'messageName',\n    getValue,\n    setValue,\n    getOptions\n  });\n}\n\nfunction withoutTemplatedMessages(messages) {\n  return messages.filter(message => !message.get('zeebe:modelerTemplate'));\n}\n\n\n// helper /////////////////////////\n\nfunction sortByName(elements) {\n  return sortBy(elements, e => (e.name || '').toLowerCase());\n}","import {\n  createElementTemplatesGroup,\n  TemplateProps\n} from '../../components';\n\nimport {\n  CustomProperties,\n  MessageProps\n} from './properties';\n\nimport { getTemplateId } from '../Helper';\n\nimport { applyConditions } from '../Condition';\nimport { getPropertyValue } from '../util/propertyUtil';\n\nconst LOWER_PRIORITY = 300;\n\nconst ALWAYS_VISIBLE_GROUPS = [\n  'general',\n  'documentation',\n  'multiInstance',\n  'Zeebe__ExecutionListeners'\n];\n\n\nexport default class ElementTemplatesPropertiesProvider {\n\n  constructor(elementTemplates, propertiesPanel, injector) {\n    propertiesPanel.registerProvider(LOWER_PRIORITY, this);\n\n    this._elementTemplates = elementTemplates;\n    this._injector = injector;\n  }\n\n  getGroups(element) {\n    return (groups) => {\n      const injector = this._injector;\n\n      updateMessageGroup(groups, element);\n\n      if (!this._shouldShowTemplateProperties(element)) {\n        return groups;\n      }\n\n      const translate = injector.get('translate');\n\n      // (0) Copy provided groups\n      groups = groups.slice();\n\n      const templatesGroup = {\n        element,\n        id: 'ElementTemplates__Template',\n        label: translate('Template'),\n        component: createElementTemplatesGroup({\n          getTemplateId\n        }),\n        entries: TemplateProps({ element, elementTemplates: this._elementTemplates })\n      };\n\n      // (1) Add templates group\n      addGroupsAfter('documentation', groups, [ templatesGroup ]);\n\n      let elementTemplate = this._elementTemplates.get(element);\n\n      if (elementTemplate) {\n        elementTemplate = applyConditions(element, elementTemplate, getPropertyValue);\n\n        const templateSpecificGroups = [].concat(\n          CustomProperties({ element, elementTemplate, injector })\n        );\n\n        // (2) add template-specific properties groups\n        addGroupsAfter('ElementTemplates__Template', groups, templateSpecificGroups);\n      }\n\n      // (3) apply entries visible\n      if (getTemplateId(element)) {\n        groups = getVisibleGroups(elementTemplate || {}, groups);\n      }\n\n      return groups;\n    };\n  }\n\n  _shouldShowTemplateProperties(element) {\n    return getTemplateId(element) || this._elementTemplates.getAll(element).length;\n  }\n}\n\nElementTemplatesPropertiesProvider.$inject = [\n  'elementTemplates',\n  'propertiesPanel',\n  'injector'\n];\n\n\n// helper /////////////////////\n\nfunction updateMessageGroup(groups, element) {\n  const messageGroup = findGroup(groups, 'message');\n\n  if (!messageGroup) {\n    return;\n  }\n\n  messageGroup.entries = overrideGenericEntries(\n    messageGroup.entries,\n    MessageProps({ element })\n  );\n}\n\nfunction findGroup(groups, id) {\n  return groups.find(g => g.id === id);\n}\n\nfunction overrideGenericEntries(oldEntries, newEntries) {\n  return oldEntries.map(oldEntry => (\n    newEntries.find(newEntry => newEntry.id === oldEntry.id) || oldEntry\n  ));\n}\n\n/**\n *\n * @param {string|string[]} idOrIds\n * @param {Array<{ id: string }} groups\n * @param {Array<{ id: string }>} groupsToAdd\n */\nfunction addGroupsAfter(idOrIds, groups, groupsToAdd) {\n  let ids = idOrIds;\n  if (!Array.isArray(idOrIds)) {\n    ids = [ idOrIds ];\n  }\n\n  // find index of last group with provided id\n  const index = groups.reduce((acc, group, index) => {\n    return ids.includes(group.id) ? index : acc;\n  }, -1);\n\n  if (index !== -1) {\n    groups.splice(index + 1, 0, ...groupsToAdd);\n  } else {\n\n    // add in the beginning if group with provided id is missing\n    groups.unshift(...groupsToAdd);\n  }\n}\n\nfunction getVisibleGroups(template, groups) {\n  if (!template.entriesVisible) {\n    return groups.filter(group => {\n      return (\n        ALWAYS_VISIBLE_GROUPS.includes(group.id) ||\n        group.id.startsWith('ElementTemplates__')\n      );\n    });\n  }\n\n  return groups;\n}\n","import translateModule from 'diagram-js/lib/i18n/translate';\n\nimport ElementTemplatesPropertiesProvider from './ElementTemplatesPropertiesProvider';\n\nexport default {\n  __depends__: [\n    translateModule\n  ],\n  __init__: [\n    'elementTemplatesPropertiesProvider'\n  ],\n  elementTemplatesPropertiesProvider: [ 'type', ElementTemplatesPropertiesProvider ]\n};\n","import coreModule from './core';\nimport propertiesProviderModule from './properties-panel';\n\nexport default {\n  __depends__: [\n    coreModule,\n    propertiesProviderModule,\n  ]\n};\n","import {\n  assign,\n  forEach,\n  isObject,\n  keys\n} from 'min-dash';\n\n/**\n * Converts legacy scopes descriptor to newer supported array structure.\n *\n * For example, it transforms\n *\n * scopes: {\n *   'camunda:Connector':\n *     { properties: []\n *   }\n * }\n *\n * to\n *\n * scopes: [\n *   {\n *     type: 'camunda:Connector',\n *     properties: []\n *   }\n * ]\n *\n * @param {ScopesDescriptor} scopes\n *\n * @returns {Array}\n */\nexport default function handleLegacyScopes(scopes = []) {\n  const scopesAsArray = [];\n\n  if (!isObject(scopes)) {\n    return scopes;\n  }\n\n  forEach(keys(scopes), function(scopeName) {\n    scopesAsArray.push(assign({\n      type: scopeName\n    }, scopes[scopeName]));\n  });\n\n  return scopesAsArray;\n}\n","import { assign } from 'min-dash';\n\nimport { nextId } from '../utils/ElementUtil';\n\n\n/**\n * Create an input parameter representing the given\n * binding and value.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createInputParameter(binding, value, bpmnFactory) {\n  const {\n    name,\n    scriptFormat\n  } = binding;\n\n  let parameterValue,\n      parameterDefinition;\n\n  if (scriptFormat) {\n    parameterDefinition = bpmnFactory.create('camunda:Script', {\n      scriptFormat,\n      value\n    });\n  } else {\n    parameterValue = value;\n  }\n\n  return bpmnFactory.create('camunda:InputParameter', {\n    name,\n    value: parameterValue,\n    definition: parameterDefinition\n  });\n}\n\n\n/**\n * Create an output parameter representing the given\n * binding and value.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createOutputParameter(binding, value, bpmnFactory) {\n  const {\n    scriptFormat,\n    source\n  } = binding;\n\n  let parameterValue,\n      parameterDefinition;\n\n  if (scriptFormat) {\n    parameterDefinition = bpmnFactory.create('camunda:Script', {\n      scriptFormat,\n      value: source\n    });\n  } else {\n    parameterValue = source;\n  }\n\n  return bpmnFactory.create('camunda:OutputParameter', {\n    name: value,\n    value: parameterValue,\n    definition: parameterDefinition\n  });\n}\n\n\n/**\n * Create camunda property from the given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createCamundaProperty(binding, value = '', bpmnFactory) {\n  const { name } = binding;\n\n  return bpmnFactory.create('camunda:Property', {\n    name,\n    value\n  });\n}\n\n\n/**\n * Create camunda:in element from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createCamundaIn(binding, value, bpmnFactory) {\n  const attrs = createCamundaInOutAttrs(binding, value);\n\n  return bpmnFactory.create('camunda:In', attrs);\n}\n\n\n/**\n * Create camunda:in with businessKey element from given binding.\n *\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createCamundaInWithBusinessKey(value, bpmnFactory) {\n  return bpmnFactory.create('camunda:In', {\n    businessKey: value\n  });\n}\n\n\n/**\n * Create camunda:out element from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createCamundaOut(binding, value, bpmnFactory) {\n  const attrs = createCamundaInOutAttrs(binding, value);\n\n  return bpmnFactory.create('camunda:Out', attrs);\n}\n\n\n/**\n * Create camunda:executionListener element containing an inline script from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createCamundaExecutionListener(binding, value, bpmnFactory) {\n  const {\n    event,\n    implementationType,\n    scriptFormat\n  } = binding;\n\n  // To guarantee backwards compatibility scriptFormat is taken into account and has precedence before any other type\n  if (implementationType === 'script' || scriptFormat) {\n    return bpmnFactory.create('camunda:ExecutionListener', {\n      event,\n      script: bpmnFactory.create('camunda:Script', {\n        scriptFormat,\n        value\n      })\n    });\n  }\n\n  return bpmnFactory.create('camunda:ExecutionListener', {\n    event,\n    [implementationType]: value\n  });\n}\n\n/**\n * Create camunda:field element containing string or expression from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createCamundaFieldInjection(binding, value, bpmnFactory) {\n  const DEFAULT_PROPS = {\n    'string': undefined,\n    'expression': undefined,\n    'name': undefined\n  };\n\n  const props = assign({}, DEFAULT_PROPS);\n\n  const {\n    expression,\n    name\n  } = binding;\n\n  if (!expression) {\n    props.string = value;\n  } else {\n    props.expression = value;\n  }\n  props.name = name;\n\n  return bpmnFactory.create('camunda:Field', props);\n}\n\n\n/**\n * Create camunda:errorEventDefinition element containing expression and errorRef\n * from given binding.\n *\n * @param {String} expression\n * @param {ModdleElement} errorRef\n * @param {ModdleElement} parent\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createCamundaErrorEventDefinition(expression, errorRef, parent, bpmnFactory) {\n  const errorEventDefinition = bpmnFactory.create('camunda:ErrorEventDefinition', {\n    errorRef,\n    expression\n  });\n\n  errorEventDefinition.$parent = parent;\n\n  return errorEventDefinition;\n}\n\n\n/**\n * Create bpmn:error element containing a specific error id given by a binding.\n *\n * @param {String} bindingErrorRef\n * @param {ModdleElement} parent\n * @param {BpmnFactory} bpmnFactory\n *\n * @return { ModdleElement }\n */\nexport function createError(bindingErrorRef, parent, bpmnFactory) {\n  const error = bpmnFactory.create('bpmn:Error', {\n\n    // we need to later retrieve the error from a binding\n    id: nextId('Error_' + bindingErrorRef + '_')\n  });\n\n  error.$parent = parent;\n\n  return error;\n}\n\n\n// helpers //////////\n\n/**\n * Create properties for camunda:in and camunda:out types.\n */\nfunction createCamundaInOutAttrs(binding, value) {\n  const properties = {};\n\n  const {\n    expression,\n    source,\n    sourceExpression,\n    target,\n    type,\n    variables\n  } = binding;\n\n  // explicitly cover all conditions as specified here:\n  // https://github.com/camunda/camunda-modeler/blob/develop/docs/element-templates/README.md#camundain\n  if (type === 'camunda:in') {\n    if (target && !expression && !variables) {\n      properties.target = target;\n      properties.source = value;\n\n    } else if (target && expression === true && !variables) {\n      properties.target = target;\n      properties.sourceExpression = value;\n\n    } else if (!target && !expression && variables === 'local') {\n      properties.local = true;\n      properties.variables = 'all';\n\n    } else if (target && !expression && variables === 'local') {\n      properties.local = true;\n      properties.source = value;\n      properties.target = target;\n\n    } else if (target && expression && variables === 'local') {\n      properties.local = true;\n      properties.sourceExpression = value;\n      properties.target = target;\n\n    } else if (!target && !expression && variables === 'all') {\n      properties.variables = 'all';\n    } else {\n      throw new Error('invalid configuration for camunda:in element template binding');\n    }\n  }\n\n  // explicitly cover all conditions as specified here:\n  // https://github.com/camunda/camunda-modeler/blob/develop/docs/element-templates/README.md#camundaout\n  if (type === 'camunda:out') {\n    if (source && !sourceExpression && !variables) {\n      properties.target = value;\n      properties.source = source;\n\n    } else if (!source && sourceExpression && !variables) {\n      properties.target = value;\n      properties.sourceExpression = sourceExpression;\n\n    } else if (!source && !sourceExpression && variables === 'all') {\n      properties.variables = 'all';\n\n    } else if (source && !sourceExpression && variables === 'local') {\n      properties.local = true;\n      properties.source = source;\n      properties.target = value;\n\n    } else if (!source && sourceExpression && variables === 'local') {\n      properties.local = true;\n      properties.sourceExpression = sourceExpression;\n      properties.target = value;\n\n    } else if (!source && !sourceExpression && variables === 'local') {\n      properties.local = true;\n      properties.variables = 'all';\n    } else {\n      throw new Error('invalid configuration for camunda:out element template binding');\n    }\n  }\n\n  return properties;\n}\n","import {\n  getBusinessObject,\n  is,\n  isAny\n} from 'bpmn-js/lib/util/ModelUtil';\n\nimport {\n  findCamundaErrorEventDefinition,\n  findExtension,\n  findExtensions,\n  getTemplateId,\n  getTemplateVersion\n} from '../Helper';\n\nimport handleLegacyScopes from '../util/handleLegacyScopes';\n\nimport {\n  createCamundaExecutionListener,\n  createCamundaFieldInjection,\n  createCamundaIn,\n  createCamundaInWithBusinessKey,\n  createCamundaOut,\n  createCamundaProperty,\n  createInputParameter,\n  createOutputParameter,\n  createCamundaErrorEventDefinition,\n  createError\n} from '../CreateHelper';\n\nimport { getSignalEventDefinition } from '../../utils/EventDefinitionUtil';\n\nimport { getRoot } from '../../utils/ElementUtil';\n\nimport {\n  find,\n  isString,\n  isUndefined,\n  keys,\n  without\n} from 'min-dash';\n\nconst CAMUNDA_SERVICE_TASK_LIKE = [\n  'camunda:class',\n  'camunda:delegateExpression',\n  'camunda:expression'\n];\n\n/**\n * Applies an element template to an element. Sets `camunda:modelerTemplate` and\n * `camunda:modelerTemplateVersion`.\n */\nexport default class ChangeElementTemplateHandler {\n  constructor(bpmnFactory, bpmnReplace, commandStack, modeling) {\n    this._bpmnFactory = bpmnFactory;\n    this._bpmnReplace = bpmnReplace;\n    this._commandStack = commandStack;\n    this._modeling = modeling;\n  }\n\n  /**\n   * Change an element's template and update its properties as specified in `newTemplate`. Specify\n   * `oldTemplate` to update from one template to another. If `newTemplate` isn't specified the\n   * `camunda:modelerTemplate` and `camunda:modelerTemplateVersion` properties will be removed from\n   * the element.\n   *\n   * @param {Object} context\n   * @param {Object} context.element\n   * @param {Object} [context.oldTemplate]\n   * @param {Object} [context.newTemplate]\n   */\n  preExecute(context) {\n    const newTemplate = context.newTemplate,\n          oldTemplate = context.oldTemplate;\n\n    let element = context.element;\n\n    // update camunda:modelerTemplate attribute\n    this._updateCamundaModelerTemplate(element, newTemplate);\n\n    if (newTemplate) {\n\n      element = context.element = this._updateTaskType(element, newTemplate);\n\n      // update properties\n      this._updateProperties(element, oldTemplate, newTemplate);\n\n      // update camunda:ExecutionListener properties\n      this._updateCamundaExecutionListenerProperties(element, newTemplate);\n\n      // update camunda:Field properties\n      this._updateCamundaFieldProperties(element, oldTemplate, newTemplate);\n\n      // update camunda:In and camunda:Out properties\n      this._updateCamundaInOutProperties(element, oldTemplate, newTemplate);\n\n      // update camunda:InputParameter and camunda:OutputParameter properties\n      this._updateCamundaInputOutputParameterProperties(element, oldTemplate, newTemplate);\n\n      // update camunda:Property properties\n      this._updateCamundaPropertyProperties(element, oldTemplate, newTemplate);\n\n      // update camunda:ErrorEventDefinition properties\n      this._updateCamundaErrorEventDefinitionProperties(element, oldTemplate, newTemplate);\n\n      // update properties for each scope\n      handleLegacyScopes(newTemplate.scopes).forEach((newScopeTemplate) => {\n        this._updateScopeProperties(element, oldTemplate, newScopeTemplate, newTemplate);\n      });\n\n    }\n  }\n\n  _getOrCreateExtensionElements(element) {\n    const bpmnFactory = this._bpmnFactory,\n          modeling = this._modeling;\n\n    const businessObject = getBusinessObject(element);\n\n    let extensionElements = businessObject.get('extensionElements');\n\n    if (!extensionElements) {\n      extensionElements = bpmnFactory.create('bpmn:ExtensionElements', {\n        values: []\n      });\n\n      extensionElements.$parent = businessObject;\n\n      modeling.updateProperties(element, {\n        extensionElements: extensionElements\n      });\n    }\n\n    return extensionElements;\n  }\n\n  /**\n   * Update `camunda:ErrorEventDefinition` properties of specified business object. Event\n   * definitions can only exist in `bpmn:ExtensionElements`.\n   *\n   * Ensures an bpmn:Error exists for the event definition.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newTemplate\n   */\n  _updateCamundaErrorEventDefinitionProperties(element, oldTemplate, newTemplate) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    const newProperties = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return newBindingType === 'camunda:errorEventDefinition';\n    });\n\n    // (1) do not override if no updates\n    if (!newProperties.length) {\n      return;\n    }\n\n    const extensionElements = this._getOrCreateExtensionElements(element);\n\n    const oldErrorEventDefinitions = findExtensions(element, [ 'camunda:ErrorEventDefinition' ]);\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            oldEventDefinition = oldProperty && findOldBusinessObject(extensionElements, oldProperty),\n            newBinding = newProperty.binding;\n\n      // (2) update old event definitions\n      if (oldProperty && oldEventDefinition) {\n\n        if (!propertyChanged(oldEventDefinition, oldProperty)) {\n          commandStack.execute('element.updateModdleProperties', {\n            element,\n            moddleElement: oldEventDefinition,\n            properties: {\n              expression: newProperty.value\n            }\n          });\n        }\n\n        remove(oldErrorEventDefinitions, oldEventDefinition);\n      }\n\n      // (3) create new event definition + error\n      else {\n        const rootElement = getRoot(getBusinessObject(element)),\n              newError = createError(newBinding.errorRef, rootElement, bpmnFactory),\n              newEventDefinition = createCamundaErrorEventDefinition(newProperty.value, newError, extensionElements, bpmnFactory);\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: rootElement,\n          properties: {\n            rootElements: [ ...rootElement.get('rootElements'), newError ]\n          }\n        });\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: extensionElements,\n          properties: {\n            values: [ ...extensionElements.get('values'), newEventDefinition ]\n          }\n        });\n      }\n\n    });\n\n    // (4) remove old event definitions\n    if (oldErrorEventDefinitions.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: extensionElements,\n        properties: {\n          values: without(extensionElements.get('values'), value => oldErrorEventDefinitions.includes(value))\n        }\n      });\n    }\n  }\n\n  /**\n   * Update `camunda:ExecutionListener` properties of specified business object. Execution listeners\n   * will always be overridden. Execution listeners can only exist in `bpmn:ExtensionElements`.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} newTemplate\n   */\n  _updateCamundaExecutionListenerProperties(element, newTemplate) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    const newProperties = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return newBindingType === 'camunda:executionListener';\n    });\n\n    // (1) do not override old execution listeners if no new execution listeners specified\n    if (!newProperties.length) {\n      return;\n    }\n\n    const extensionElements = this._getOrCreateExtensionElements(element);\n\n    // (2) remove old execution listeners\n    const oldExecutionListeners = findExtensions(element, [ 'camunda:ExecutionListener' ]);\n\n    // (3) add new execution listeners\n    const newExecutionListeners = newProperties.map((newProperty) => {\n      const newBinding = newProperty.binding,\n            propertyValue = newProperty.value;\n\n      return createCamundaExecutionListener(newBinding, propertyValue, bpmnFactory);\n    });\n\n    commandStack.execute('element.updateModdleProperties', {\n      element,\n      moddleElement: extensionElements,\n      properties: {\n        values: [\n          ...without(extensionElements.get('values'), value => oldExecutionListeners.includes(value)),\n          ...newExecutionListeners\n        ]\n      }\n    });\n  }\n\n  /**\n   * Update `camunda:Field` properties of specified business object.\n   * If business object is `camunda:ExecutionListener` or `camunda:TaskListener` `fields` property\n   * will be updated. Otherwise `extensionElements.values` property will be updated.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newTemplate\n   * @param {ModdleElement} businessObject\n   */\n  _updateCamundaFieldProperties(element, oldTemplate, newTemplate, businessObject) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    const newProperties = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return newBindingType === 'camunda:field';\n    });\n\n    // (1) do not override old fields if no new fields specified\n    if (!newProperties.length) {\n      return;\n    }\n\n    if (!businessObject) {\n      businessObject = this._getOrCreateExtensionElements(element);\n    }\n\n    const propertyName = isAny(businessObject, [ 'camunda:ExecutionListener', 'camunda:TaskListener' ])\n      ? 'fields'\n      : 'values';\n\n    const oldFields = findExtensions(element, [ 'camunda:Field' ]);\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            oldField = oldProperty && findOldBusinessObject(businessObject, oldProperty),\n            newBinding = newProperty.binding;\n\n      // (2) update old fields\n      if (oldProperty && oldField) {\n\n        if (!propertyChanged(oldField, oldProperty)) {\n          commandStack.execute('element.updateModdleProperties', {\n            element,\n            moddleElement: oldField,\n            properties: {\n              string: newProperty.value\n            }\n          });\n        }\n\n        remove(oldFields, oldField);\n      }\n\n      // (3) add new fields\n      else {\n        const newCamundaFieldInjection = createCamundaFieldInjection(newBinding, newProperty.value, bpmnFactory);\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: businessObject,\n          properties: {\n            [ propertyName ]: [ ...businessObject.get(propertyName), newCamundaFieldInjection ]\n          }\n        });\n      }\n    });\n\n    // (4) remove old fields\n    if (oldFields.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties: {\n          [ propertyName ]: without(businessObject.get(propertyName), value => oldFields.includes(value))\n        }\n      });\n    }\n  }\n\n  /**\n   * Update `camunda:In` and `camunda:Out` properties of specified business object. Only\n   * `bpmn:CallActivity` and events with `bpmn:SignalEventDefinition` can have ins. Only\n   * `camunda:CallActivity` can have outs.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newTemplate\n   */\n  _updateCamundaInOutProperties(element, oldTemplate, newTemplate) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    const newProperties = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return newBindingType === 'camunda:in'\n      || newBindingType === 'camunda:in:businessKey'\n      || newBindingType === 'camunda:out';\n    });\n\n    // (1) do not override old fields if no new fields specified\n    if (!newProperties.length) {\n      return;\n    }\n\n    // get extension elements of either signal event definition or call activity\n    const extensionElements = this._getOrCreateExtensionElements(getSignalEventDefinition(element) || element);\n\n    const oldInsAndOuts = findExtensions(extensionElements, [ 'camunda:In', 'camunda:Out' ]);\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            oldBinding = oldProperty && oldProperty.binding,\n            oldInOurOut = oldProperty && findOldBusinessObject(extensionElements, oldProperty),\n            newPropertyValue = newProperty.value,\n            newBinding = newProperty.binding,\n            newBindingType = newBinding.type,\n            properties = {};\n\n      let newInOrOut;\n\n      // (2) update old ins and outs\n      if (oldProperty && oldInOurOut) {\n\n        if (!propertyChanged(oldInOurOut, oldProperty)) {\n          if (newBindingType === 'camunda:in') {\n            if (newBinding.expression) {\n              properties[ 'camunda:sourceExpression' ] = newPropertyValue;\n            } else {\n              properties[ 'camunda:source' ] = newPropertyValue;\n            }\n          } else if (newBindingType === 'camunda:in:businessKey') {\n            properties[ 'camunda:businessKey' ] = newPropertyValue;\n          } else if (newBindingType === 'camunda:out') {\n            properties[ 'camunda:target' ] = newPropertyValue;\n          }\n        }\n\n        // update camunda:local property if it changed\n        if ((oldBinding.local && !newBinding.local) || !oldBinding.local && newBinding.local) {\n          properties.local = newBinding.local;\n        }\n\n        if (keys(properties)) {\n          commandStack.execute('element.updateModdleProperties', {\n            element,\n            moddleElement: oldInOurOut,\n            properties\n          });\n        }\n\n        remove(oldInsAndOuts, oldInOurOut);\n      }\n\n      // (3) add new ins and outs\n      else {\n        if (newBindingType === 'camunda:in') {\n          newInOrOut = createCamundaIn(newBinding, newPropertyValue, bpmnFactory);\n        } else if (newBindingType === 'camunda:out') {\n          newInOrOut = createCamundaOut(newBinding, newPropertyValue, bpmnFactory);\n        } else if (newBindingType === 'camunda:in:businessKey') {\n          newInOrOut = createCamundaInWithBusinessKey(newPropertyValue, bpmnFactory);\n        }\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: extensionElements,\n          properties: {\n            values: [ ...extensionElements.get('values'), newInOrOut ]\n          }\n        });\n      }\n    });\n\n    // (4) remove old ins and outs\n    if (oldInsAndOuts.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: extensionElements,\n        properties: {\n          values: without(extensionElements.get('values'), value => oldInsAndOuts.includes(value))\n        }\n      });\n    }\n  }\n\n  /**\n   * Update `camunda:InputParameter` and `camunda:OutputParameter` properties of specified business\n   * object. Both can only exist in `camunda:InputOutput` which can exist in `bpmn:ExtensionElements`\n   * or `camunda:Connector`.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newTemplate\n   */\n  _updateCamundaInputOutputParameterProperties(element, oldTemplate, newTemplate, businessObject) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    const newProperties = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return newBindingType === 'camunda:inputParameter' || newBindingType === 'camunda:outputParameter';\n    });\n\n    // (1) do not override old inputs and outputs if no new inputs and outputs specified\n    if (!newProperties.length) {\n      return;\n    }\n\n    if (!businessObject) {\n      businessObject = this._getOrCreateExtensionElements(element);\n    }\n\n    let inputOutput;\n\n    if (is(businessObject, 'camunda:Connector')) {\n      inputOutput = businessObject.get('camunda:inputOutput');\n\n      if (!inputOutput) {\n        inputOutput = bpmnFactory.create('camunda:InputOutput');\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: businessObject,\n          properties: {\n            inputOutput\n          }\n        });\n      }\n    } else {\n      inputOutput = findExtension(businessObject, 'camunda:InputOutput');\n\n      if (!inputOutput) {\n        inputOutput = bpmnFactory.create('camunda:InputOutput');\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: businessObject,\n          properties: {\n            values: [ ...businessObject.get('values'), inputOutput ]\n          }\n        });\n      }\n    }\n\n    const oldInputs = inputOutput.get('camunda:inputParameters')\n      ? inputOutput.get('camunda:inputParameters').slice()\n      : [];\n\n    const oldOutputs = inputOutput.get('camunda:outputParameters')\n      ? inputOutput.get('camunda:outputParameters').slice()\n      : [];\n\n    let propertyName;\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            oldInputOrOutput = oldProperty && findOldBusinessObject(businessObject, oldProperty),\n            newPropertyValue = newProperty.value,\n            newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      let newInputOrOutput,\n          properties;\n\n      // (2) update old inputs and outputs\n      if (oldProperty && oldInputOrOutput) {\n\n        if (!propertyChanged(oldInputOrOutput, oldProperty)) {\n          if (is(oldInputOrOutput, 'camunda:InputParameter')) {\n            properties = {\n              value: newPropertyValue\n            };\n          } else {\n            properties = {\n              name: newPropertyValue\n            };\n          }\n\n          commandStack.execute('element.updateModdleProperties', {\n            element,\n            moddleElement: oldInputOrOutput,\n            properties\n          });\n        }\n\n        if (is(oldInputOrOutput, 'camunda:InputParameter')) {\n          remove(oldInputs, oldInputOrOutput);\n        } else {\n          remove(oldOutputs, oldInputOrOutput);\n        }\n      }\n\n      // (3) add new inputs and outputs\n      else {\n        if (newBindingType === 'camunda:inputParameter') {\n          propertyName = 'inputParameters';\n\n          newInputOrOutput = createInputParameter(newBinding, newPropertyValue, bpmnFactory);\n        } else {\n          propertyName = 'outputParameters';\n\n          newInputOrOutput = createOutputParameter(newBinding, newPropertyValue, bpmnFactory);\n        }\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: inputOutput,\n          properties: {\n            [ propertyName ]: [ ...inputOutput.get(propertyName), newInputOrOutput ]\n          }\n        });\n      }\n    });\n\n    // (4) remove old inputs and outputs\n    if (oldInputs.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: inputOutput,\n        properties: {\n          inputParameters: without(inputOutput.get('inputParameters'), inputParameter => oldInputs.includes(inputParameter))\n        }\n      });\n    }\n\n    if (oldOutputs.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: inputOutput,\n        properties: {\n          outputParameters: without(inputOutput.get('outputParameters'), outputParameter => oldOutputs.includes(outputParameter))\n        }\n      });\n    }\n  }\n\n  _updateCamundaModelerTemplate(element, newTemplate) {\n    const modeling = this._modeling;\n\n    const newId = newTemplate && newTemplate.id;\n    const newVersion = newTemplate && newTemplate.version;\n\n    if (getTemplateId(element) !== newId || getTemplateVersion(element) !== newVersion) {\n      modeling.updateProperties(element, {\n        'camunda:modelerTemplate': newId,\n        'camunda:modelerTemplateVersion': newVersion\n      });\n    }\n  }\n\n  /**\n   * Update `camunda:Property` properties of specified business object. `camunda:Property` can only\n   * exist in `camunda:Properties`.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newTemplate\n   * @param {ModdleElement} businessObject\n   */\n  _updateCamundaPropertyProperties(element, oldTemplate, newTemplate, businessObject) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    const newProperties = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return newBindingType === 'camunda:property';\n    });\n\n    // (1) do not override old properties if no new properties specified\n    if (!newProperties.length) {\n      return;\n    }\n\n    if (businessObject) {\n      businessObject = this._getOrCreateExtensionElements(businessObject);\n    } else {\n      businessObject = this._getOrCreateExtensionElements(element);\n    }\n\n    let camundaProperties = findExtension(businessObject, 'camunda:Properties');\n\n    if (!camundaProperties) {\n      camundaProperties = bpmnFactory.create('camunda:Properties');\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties: {\n          values: [ ...businessObject.get('values'), camundaProperties ]\n        }\n      });\n    }\n\n    const oldCamundaProperties = camundaProperties.get('camunda:values')\n      ? camundaProperties.get('camunda:values').slice()\n      : [];\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            oldCamundaProperty = oldProperty && findOldBusinessObject(businessObject, oldProperty),\n            newPropertyValue = newProperty.value,\n            newBinding = newProperty.binding;\n\n      // (2) update old properties\n      if (oldProperty && oldCamundaProperty) {\n\n        if (!propertyChanged(oldCamundaProperty, oldProperty)) {\n          commandStack.execute('element.updateModdleProperties', {\n            element,\n            moddleElement: oldCamundaProperty,\n            properties: {\n              value: newPropertyValue\n            }\n          });\n        }\n\n        remove(oldCamundaProperties, oldCamundaProperty);\n      }\n\n      // (3) add new properties\n      else {\n        const newCamundaProperty = createCamundaProperty(newBinding, newPropertyValue, bpmnFactory);\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: camundaProperties,\n          properties: {\n            values: [ ...camundaProperties.get('values'), newCamundaProperty ]\n          }\n        });\n      }\n    });\n\n    // (4) remove old properties\n    if (oldCamundaProperties.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: camundaProperties,\n        properties: {\n          values: without(camundaProperties.get('values'), value => oldCamundaProperties.includes(value))\n        }\n      });\n    }\n  }\n\n  /**\n   * Update `bpmn:conditionExpression` property of specified element. Since condition expression is\n   * is not primitive it needs special handling.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldProperty\n   * @param {Object} newProperty\n   */\n  _updateConditionExpression(element, oldProperty, newProperty) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack,\n          modeling = this._modeling;\n\n    const newBinding = newProperty.binding,\n          newPropertyValue = newProperty.value;\n\n    if (!oldProperty) {\n      modeling.updateProperties(element, {\n        conditionExpression: bpmnFactory.create('bpmn:FormalExpression', {\n          body: newPropertyValue,\n          language: newBinding.scriptFormat\n        })\n      });\n\n      return;\n    }\n\n    const oldBinding = oldProperty.binding,\n          oldPropertyValue = oldProperty.value;\n\n    const businessObject = getBusinessObject(element),\n          conditionExpression = businessObject.get('bpmn:conditionExpression');\n\n    const properties = {};\n\n    if (conditionExpression.get('body') === oldPropertyValue) {\n      properties.body = newPropertyValue;\n    }\n\n    if (conditionExpression.get('language') === oldBinding.scriptFormat) {\n      properties.language = newBinding.scriptFormat;\n    }\n\n    if (!keys(properties).length) {\n      return;\n    }\n\n    commandStack.execute('element.updateModdleProperties', {\n      element,\n      moddleElement: conditionExpression,\n      properties\n    });\n  }\n\n  _updateProperties(element, oldTemplate, newTemplate, businessObject) {\n    const commandStack = this._commandStack;\n\n    const newProperties = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return newBindingType === 'property';\n    });\n\n    const oldProperties = oldTemplate && oldTemplate.properties.filter((oldProperty) => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      return oldBindingType === 'property';\n    });\n\n    if (!newProperties.length) {\n      return;\n    }\n\n    if (!businessObject) {\n      businessObject = getBusinessObject(element);\n    }\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            newBinding = newProperty.binding,\n            newBindingName = newBinding.name,\n            newPropertyValue = newProperty.value;\n\n      let changedElement,\n          properties;\n\n      if (oldProperty) {\n        remove(oldProperties, oldProperty);\n      }\n\n      if (newBindingName === 'conditionExpression') {\n        this._updateConditionExpression(element, oldProperty, newProperty);\n      } else {\n\n        if (is(businessObject, 'bpmn:Error')) {\n          changedElement = businessObject;\n        } else {\n          changedElement = element;\n        }\n\n        if (oldProperty && propertyChanged(changedElement, oldProperty)) {\n          return;\n        }\n\n        properties = {};\n\n        properties[ newBindingName ] = newPropertyValue;\n\n        // only one of `camunda:class`, `camunda:delegateExpression` and `camunda:expression` can be set\n        // TODO(philippfromme): ensuring only one of these properties is set at a time should be\n        // implemented in a behavior and not in this handler and properties panel UI\n        if (CAMUNDA_SERVICE_TASK_LIKE.indexOf(newBindingName) !== -1) {\n          CAMUNDA_SERVICE_TASK_LIKE.forEach((camundaServiceTaskLikeProperty) => {\n            if (camundaServiceTaskLikeProperty !== newBindingName) {\n              properties[ camundaServiceTaskLikeProperty ] = undefined;\n            }\n          });\n        }\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: businessObject,\n          properties\n        });\n      }\n    });\n\n    // remove old properties not present in new template\n    oldProperties && oldProperties.forEach((oldProperty) => {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties: {\n          [oldProperty.binding.name]: null\n        }\n      });\n    });\n  }\n\n  /**\n   * Update properties for a specified scope.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newScopeTemplate\n   * @param {Object} newTemplate\n   */\n  _updateScopeProperties(element, oldTemplate, newScopeTemplate, newTemplate) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    const scopeName = newScopeTemplate.type;\n\n    let scopeElement;\n\n    scopeElement = findOldScopeElement(element, newScopeTemplate, newTemplate);\n\n    if (!scopeElement) {\n\n      scopeElement = bpmnFactory.create(scopeName);\n    }\n\n    const oldScopeTemplate = findOldScopeTemplate(newScopeTemplate, oldTemplate);\n\n    // update properties\n    this._updateProperties(element, oldScopeTemplate, newScopeTemplate, scopeElement);\n\n    // update camunda:ExecutionListener properties\n    this._updateCamundaExecutionListenerProperties(element, newScopeTemplate);\n\n    // update camunda:In and camunda:Out properties\n    this._updateCamundaInOutProperties(element, oldScopeTemplate, newScopeTemplate);\n\n    // update camunda:InputParameter and camunda:OutputParameter properties\n    this._updateCamundaInputOutputParameterProperties(element, oldScopeTemplate, newScopeTemplate, scopeElement);\n\n    // update camunda:Field properties\n    this._updateCamundaFieldProperties(element, oldScopeTemplate, newScopeTemplate, scopeElement);\n\n    // update camunda:Property properties\n    this._updateCamundaPropertyProperties(element, oldScopeTemplate, newScopeTemplate, scopeElement);\n\n    // assume that root elements were already created in root by referenced event definition binding\n    if (isRootElementScope(scopeName)) {\n      return;\n    }\n\n    const extensionElements = this._getOrCreateExtensionElements(element);\n\n    commandStack.execute('element.updateModdleProperties', {\n      element,\n      moddleElement: extensionElements,\n      properties: {\n        values: [ ...extensionElements.get('values'), scopeElement ]\n      }\n    });\n  }\n\n  /**\n   * Replaces the element with the specified elementType\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} newTemplate\n   */\n  _updateTaskType(element, newTemplate) {\n\n    // determine new task type\n    const newType = newTemplate.elementType;\n\n    if (!newType) {\n      return element;\n    }\n\n    // don't replace Task that is already the correct type\n    if (element.$type === newType.value) {\n      return element;\n    }\n\n    return this._bpmnReplace.replaceElement(element, { type: newType.value });\n  }\n}\n\nChangeElementTemplateHandler.$inject = [\n  'bpmnFactory',\n  'bpmnReplace',\n  'commandStack',\n  'modeling'\n];\n\n\n// helpers //////////\n\n/**\n * Find old business object matching specified old property.\n *\n * @param {djs.model.Base|ModdleElement} element\n * @param {Object} oldProperty\n *\n * @returns {ModdleElement}\n */\nfunction findOldBusinessObject(element, oldProperty) {\n  let businessObject = getBusinessObject(element),\n      propertyName;\n\n  const oldBinding = oldProperty.binding,\n        oldBindingType = oldBinding.type;\n\n  if (oldBindingType === 'camunda:field') {\n\n    if (isAny(businessObject, [ 'camunda:ExecutionListener', 'camunda:TaskListener' ])) {\n      propertyName = 'camunda:fields';\n    } else {\n      propertyName = 'bpmn:values';\n    }\n\n    if (!businessObject || !businessObject.get(propertyName) || !businessObject.get(propertyName).length) {\n      return;\n    }\n\n    return find(businessObject.get(propertyName), function(oldBusinessObject) {\n      return oldBusinessObject.get('camunda:name') === oldBinding.name;\n    });\n  }\n\n  if (oldBindingType === 'camunda:in') {\n    return find(businessObject.get('values'), function(oldBusinessObject) {\n      return oldBusinessObject.get('target') === oldBinding.target;\n    });\n  }\n\n  if (oldBindingType === 'camunda:in:businessKey') {\n    return find(businessObject.get('values'), function(oldBusinessObject) {\n      return isString(oldBusinessObject.get('businessKey'));\n    });\n  }\n\n  if (oldBindingType === 'camunda:out') {\n    return find(businessObject.get('values'), function(oldBusinessObject) {\n      return oldBusinessObject.get('source') === oldBinding.source ||\n        oldBusinessObject.get('sourceExpression') || oldBinding.sourceExpression;\n    });\n  }\n\n  if (oldBindingType === 'camunda:inputParameter' || oldBindingType === 'camunda:outputParameter') {\n\n    if (is(businessObject, 'camunda:Connector')) {\n      businessObject = businessObject.get('camunda:inputOutput');\n\n      if (!businessObject) {\n        return;\n      }\n    } else {\n      businessObject = findExtension(businessObject, 'camunda:InputOutput');\n\n      if (!businessObject) {\n        return;\n      }\n    }\n\n    if (oldBindingType === 'camunda:inputParameter') {\n      return find(businessObject.get('camunda:inputParameters'), function(oldBusinessObject) {\n        return oldBusinessObject.get('camunda:name') === oldBinding.name;\n      });\n    } else {\n      return find(businessObject.get('camunda:outputParameters'), function(oldBusinessObject) {\n        if (oldBinding.scriptFormat) {\n          const definition = oldBusinessObject.get('camunda:definition');\n\n          return definition && definition.get('camunda:value') === oldBinding.source;\n        } else {\n          return oldBusinessObject.get('camunda:value') === oldBinding.source;\n        }\n      });\n    }\n\n  }\n\n  if (oldBindingType === 'camunda:property') {\n    if (!businessObject || !businessObject.get('values') || !businessObject.get('values').length) {\n      return;\n    }\n\n    businessObject = findExtension(businessObject, 'camunda:Properties');\n\n    if (!businessObject) {\n      return;\n    }\n\n    return find(businessObject.get('values'), function(oldBusinessObject) {\n      return oldBusinessObject.get('camunda:name') === oldBinding.name;\n    });\n  }\n\n  if (oldBindingType === 'camunda:errorEventDefinition') {\n    return findCamundaErrorEventDefinition(element, oldBinding.errorRef);\n  }\n}\n\n/**\n * Find old property matching specified new property.\n *\n * @param {Object} oldTemplate\n * @param {Object} newProperty\n *\n * @returns {Object}\n */\nfunction findOldProperty(oldTemplate, newProperty) {\n  if (!oldTemplate) {\n    return;\n  }\n\n  const oldProperties = oldTemplate.properties,\n        newBinding = newProperty.binding,\n        newBindingName = newBinding.name,\n        newBindingType = newBinding.type;\n\n  if (newBindingType === 'property') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingName = oldBinding.name,\n            oldBindingType = oldBinding.type;\n\n      return oldBindingType === 'property' && oldBindingName === newBindingName;\n    });\n  }\n\n  if (newBindingType === 'camunda:field') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingName = oldBinding.name,\n            oldBindingType = oldBinding.type;\n\n      return oldBindingType === 'camunda:field' && oldBindingName === newBindingName;\n    });\n  }\n\n  if (newBindingType === 'camunda:in') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== 'camunda:in') {\n        return;\n      }\n\n      // always override if change from source to source expression or vice versa\n      if ((oldBinding.expression && !newBinding.expression) ||\n        !oldBinding.expression && newBinding.expression) {\n        return;\n      }\n\n      return oldBinding.target === newBinding.target;\n    });\n  }\n\n  if (newBindingType === 'camunda:in:businessKey') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      return oldBindingType === 'camunda:in:businessKey';\n    });\n  }\n\n  if (newBindingType === 'camunda:out') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      return oldBindingType === 'camunda:out' && (\n        oldBinding.source === newBinding.source ||\n        oldBinding.sourceExpression === newBinding.sourceExpression\n      );\n    });\n  }\n\n  if (newBindingType === 'camunda:inputParameter') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingName = oldBinding.name,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== 'camunda:inputParameter') {\n        return;\n      }\n\n      return oldBindingName === newBindingName\n        && oldBinding.scriptFormat === newBinding.scriptFormat;\n    });\n  }\n\n  if (newBindingType === 'camunda:outputParameter') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== 'camunda:outputParameter') {\n        return;\n      }\n\n      return oldBinding.source === newBinding.source\n        && oldBinding.scriptFormat === newBinding.scriptFormat;\n    });\n  }\n\n  if (newBindingType === 'camunda:property') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingName = oldBinding.name,\n            oldBindingType = oldBinding.type;\n\n      return oldBindingType === 'camunda:property' && oldBindingName === newBindingName;\n    });\n  }\n\n  if (newBindingType === 'camunda:errorEventDefinition') {\n    return find(oldProperties, function(oldProperty) {\n      const newBindingRef = newBinding.errorRef,\n            oldBinding = oldProperty.binding,\n            oldBindingRef = oldBinding.errorRef,\n            oldBindingType = oldBinding.type;\n\n      return oldBindingType === 'camunda:errorEventDefinition'\n        && oldBindingRef === newBindingRef;\n    });\n  }\n}\n\nfunction findOldScopeElement(element, scopeTemplate, template) {\n  const scopeName = scopeTemplate.type,\n        id = scopeTemplate.id;\n\n  if (scopeName === 'camunda:Connector') {\n    return findExtension(element, 'camunda:Connector');\n  }\n\n  if (scopeName === 'bpmn:Error') {\n\n    // (1) find by error event definition binding\n    const errorEventDefinitionBinding = findErrorEventDefinitionBinding(template, id);\n\n    if (!errorEventDefinitionBinding) {\n      return;\n    }\n\n    // (2) find error event definition\n    const errorEventDefinition = findOldBusinessObject(element, errorEventDefinitionBinding);\n\n    if (!errorEventDefinition) {\n      return;\n    }\n\n    // (3) retrieve referenced error\n    return errorEventDefinition.errorRef;\n  }\n}\n\nfunction isRootElementScope(scopeName) {\n  return [ 'bpmn:Error' ].includes(scopeName);\n}\n\nfunction findOldScopeTemplate(scopeTemplate, oldTemplate) {\n  const scopeName = scopeTemplate.type,\n        scopeId = scopeTemplate.id,\n        scopes = oldTemplate && handleLegacyScopes(oldTemplate.scopes);\n\n  return scopes && find(scopes, function(scope) {\n\n    if (isRootElementScope(scopeName)) {\n      return scope.id === scopeId;\n    }\n\n    return scope.type === scopeName;\n  });\n}\n\nfunction findErrorEventDefinitionBinding(template, templateErrorId) {\n  return find(template.properties, function(property) {\n    return property.binding.errorRef === templateErrorId;\n  });\n}\n\n/**\n * Check whether property was changed after being set by template.\n *\n * @param {djs.model.Base|ModdleElement} element\n * @param {Object} oldProperty\n *\n * @returns {boolean}\n */\nfunction propertyChanged(element, oldProperty) {\n  const businessObject = getBusinessObject(element);\n\n  const oldBinding = oldProperty.binding,\n        oldBindingName = oldBinding.name,\n        oldBindingType = oldBinding.type,\n        oldPropertyValue = oldProperty.value;\n\n  let conditionExpression,\n      definition;\n\n  if (oldBindingType === 'property') {\n    if (oldBindingName === 'conditionExpression') {\n      conditionExpression = businessObject.get('bpmn:conditionExpression');\n\n      return conditionExpression.get('bpmn:body') !== oldPropertyValue;\n    }\n\n    return businessObject.get(oldBindingName) !== oldPropertyValue;\n  }\n\n  if (oldBindingType === 'camunda:field') {\n    return businessObject.get('camunda:string') !== oldPropertyValue;\n  }\n\n  if (oldBindingType === 'camunda:in') {\n    if (oldBinding.expression) {\n      return businessObject.get('sourceExpression') !== oldPropertyValue;\n    } else {\n      return businessObject.get('camunda:source') !== oldPropertyValue;\n    }\n  }\n\n  if (oldBindingType === 'camunda:in:businessKey') {\n    return businessObject.get('camunda:businessKey') !== oldPropertyValue;\n  }\n\n  if (oldBindingType === 'camunda:out') {\n    return businessObject.get('camunda:target') !== oldPropertyValue;\n  }\n\n  if (oldBindingType === 'camunda:inputParameter') {\n    if (oldBinding.scriptFormat) {\n      definition = businessObject.get('camunda:definition');\n\n      return definition && definition.get('camunda:value') !== oldPropertyValue;\n    } else {\n      return businessObject.get('camunda:value') !== oldPropertyValue;\n    }\n  }\n\n  if (oldBindingType === 'camunda:outputParameter') {\n    return businessObject.get('camunda:name') !== oldPropertyValue;\n  }\n\n  if (oldBindingType === 'camunda:property') {\n    return businessObject.get('camunda:value') !== oldPropertyValue;\n  }\n\n  if (oldBindingType === 'camunda:errorEventDefinition') {\n    return businessObject.get('expression') !== oldPropertyValue;\n  }\n}\n\nfunction remove(array, item) {\n  const index = array.indexOf(item);\n\n  if (isUndefined(index)) {\n    return array;\n  }\n\n  array.splice(index, 1);\n\n  return array;\n}","import { getLabel, setLabel } from 'bpmn-js/lib/features/label-editing/LabelUtil';\nimport { getShapeIdFromPlane, isPlane } from 'bpmn-js/lib/util/DrilldownUtil';\nimport { getBusinessObject, is } from 'bpmn-js/lib/util/ModelUtil';\n\nexport default class RemoveElementTemplateHandler {\n  constructor(\n      modeling,\n      elementFactory,\n      elementRegistry,\n      canvas,\n      bpmnFactory,\n      replace,\n      commandStack\n  ) {\n    this._modeling = modeling;\n    this._elementFactory = elementFactory;\n    this._elementRegistry = elementRegistry;\n    this._canvas = canvas;\n    this._bpmnFactory = bpmnFactory;\n    this._replace = replace;\n    this._commandStack = commandStack;\n  }\n\n  preExecute(context) {\n    const {\n      element\n    } = context;\n\n    if (element.parent) {\n      context.newElement = this._removeTemplate(element);\n    } else {\n      context.newElement = this._removeRootTemplate(element);\n    }\n  }\n\n  _removeTemplate(element) {\n    const replace = this._replace;\n\n    const businessObject = getBusinessObject(element);\n\n    const type = businessObject.$type,\n          eventDefinitionType = this._getEventDefinitionType(businessObject);\n\n    const newBusinessObject = this._createBlankBusinessObject(element);\n\n    return replace.replaceElement(element,\n      {\n        type: type,\n        businessObject: newBusinessObject,\n        eventDefinitionType: eventDefinitionType,\n      },\n      {\n        createElementsBehavior: false\n      }\n    );\n  }\n\n  /**\n   * Remove template from a given element.\n   *\n   * @param {djs.model.Base} element\n   *\n   * @return {djs.model.Base} the updated element\n   */\n  _removeRootTemplate(element) {\n    var modeling = this._modeling,\n        elementFactory = this._elementFactory,\n        elementRegistry = this._elementRegistry,\n        canvas = this._canvas;\n\n    // We are inside a collapsed subprocess, move up to the parent before replacing the collapsed object\n    if (isPlane(element)) {\n      const shapeId = getShapeIdFromPlane(element);\n      const shape = elementRegistry.get(shapeId);\n\n      if (shape && shape !== element) {\n        canvas.setRootElement(canvas.findRoot(shape));\n        return this._removeTemplate(shape);\n      }\n    }\n\n    const businessObject = getBusinessObject(element);\n\n    const type = businessObject.$type;\n\n    const newBusinessObject = this._createBlankBusinessObject(element);\n\n    const newRoot = elementFactory.create('root', {\n      type: type,\n      businessObject: newBusinessObject\n    });\n\n    this._commandStack.execute('canvas.updateRoot', {\n      newRoot: newRoot,\n      oldRoot: element\n    });\n\n    modeling.moveElements(element.children, { x: 0, y: 0 }, newRoot);\n\n    return newRoot;\n  }\n\n  _getEventDefinitionType(businessObject) {\n    if (!businessObject.eventDefinitions) {\n      return null;\n    }\n\n    const eventDefinition = businessObject.eventDefinitions[ 0 ];\n\n    if (!eventDefinition) {\n      return null;\n    }\n\n    return eventDefinition.$type;\n  }\n\n  _createBlankBusinessObject(element) {\n    const bpmnFactory = this._bpmnFactory;\n\n    const bo = getBusinessObject(element),\n          newBo = bpmnFactory.create(bo.$type),\n          label = getLabel(element);\n\n    if (!label) {\n      return newBo;\n    }\n\n    if (is(element, 'bpmn:Group')) {\n      newBo.categoryValueRef = bpmnFactory.create('bpmn:CategoryValue');\n    }\n\n    setLabel({ businessObject: newBo }, label);\n\n    return newBo;\n  }\n}\n\n\nRemoveElementTemplateHandler.$inject = [\n  'modeling',\n  'elementFactory',\n  'elementRegistry',\n  'canvas',\n  'bpmnFactory',\n  'replace',\n  'commandStack'\n];\n","import ChangeElementTemplateHandler from './ChangeElementTemplateHandler';\nimport RemoveElementTemplateHandler from './RemoveElementTemplateHandler';\nimport MultiCommandHandler from './MultiCommandHandler';\n\nexport default class ElementTemplatesCommands {\n  constructor(commandStack, elementTemplates, eventBus) {\n    commandStack.registerHandler(\n      'element-templates.multi-command-executor',\n      MultiCommandHandler\n    );\n\n    commandStack.registerHandler(\n      'propertiesPanel.camunda.changeTemplate',\n      ChangeElementTemplateHandler\n    );\n\n    commandStack.registerHandler(\n      'propertiesPanel.removeTemplate',\n      RemoveElementTemplateHandler\n    );\n\n    // apply default element templates on shape creation\n    eventBus.on([ 'commandStack.shape.create.postExecuted' ], function(event) {\n      const {\n        context: {\n          hints = {},\n          shape\n        }\n      } = event;\n\n      if (hints.createElementsBehavior !== false) {\n        applyDefaultTemplate(shape, elementTemplates, commandStack);\n      }\n    });\n\n    // apply default element templates on connection creation\n    eventBus.on([ 'commandStack.connection.create.postExecuted' ], function(event) {\n      const {\n        context: {\n          hints = {},\n          connection\n        }\n      } = event;\n\n      if (hints.createElementsBehavior !== false) {\n        applyDefaultTemplate(connection, elementTemplates, commandStack);\n      }\n    });\n  }\n}\n\nElementTemplatesCommands.$inject = [ 'commandStack', 'elementTemplates', 'eventBus' ];\n\nfunction applyDefaultTemplate(element, elementTemplates, commandStack) {\n\n  if (!elementTemplates.get(element) && elementTemplates.getDefault(element)) {\n\n    const command = 'propertiesPanel.camunda.changeTemplate';\n    const commandContext = {\n      element: element,\n      newTemplate: elementTemplates.getDefault(element)\n    };\n\n    commandStack.execute(command, commandContext);\n  }\n}\n","import ElementTemplateCommands from './ElementTemplateCommands';\n\nexport default {\n  __init__: [ 'elementTemplateCommands' ],\n  elementTemplateCommands: [ 'type', ElementTemplateCommands ]\n};","import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { getBusinessObject, is } from 'bpmn-js/lib/util/ModelUtil';\n\n/**\n * This Behavior checks if the new element's type is in\n * the list of elements the template applies to and unlinks\n * it if not.\n */\nexport default class ReplaceBehavior extends CommandInterceptor {\n  constructor(elementTemplates, injector) {\n    super(injector.get('eventBus'));\n\n    this.postExecuted('shape.replace', function(e) {\n      var context = e.context,\n          oldShape = context.oldShape,\n          oldBo = getBusinessObject(oldShape),\n          newShape = context.newShape,\n          newBo = getBusinessObject(newShape);\n\n      if (!oldBo.modelerTemplate) {\n        return;\n      }\n\n      const template = newBo.modelerTemplate;\n      const version = newBo.modelerTemplateVersion;\n\n      const elementTemplate = elementTemplates.get(template, version);\n\n      if (!elementTemplate) {\n        elementTemplates.unlinkTemplate(newShape, injector);\n        return;\n      }\n\n      const { appliesTo, elementType } = elementTemplate;\n\n      if (elementType) {\n        if (!is(newShape, elementType.value)) {\n          elementTemplates.unlinkTemplate(newShape, injector);\n        }\n\n        return;\n      }\n\n      const allowed = appliesTo.reduce((allowed, type) => {\n        return allowed || is(newBo, type);\n      }, false);\n\n      if (!allowed) {\n        elementTemplates.unlinkTemplate(newShape, injector);\n      }\n    });\n  }\n}\n\nReplaceBehavior.$inject = [\n  'elementTemplates',\n  'injector'\n];\n","import ReplaceBehavior from './ReplaceBehavior';\n\nexport default {\n  __init__: [\n    'elementTemplatesReplaceBehavior'\n  ],\n  elementTemplatesReplaceBehavior: [ 'type', ReplaceBehavior ]\n};\n","import ElementTemplates from '../ElementTemplates';\nimport ElementTemplatesLoader from '../ElementTemplatesLoader';\n\nimport commandsModule from '../cmd';\nimport behaviorModule from '../behavior';\n\nexport default {\n  __depends__: [\n    commandsModule,\n    behaviorModule\n  ],\n  __init__: [\n    'elementTemplatesLoader'\n  ],\n  elementTemplates: [ 'type', ElementTemplates ],\n  elementTemplatesLoader: [ 'type', ElementTemplatesLoader ]\n};\n","export const CAMUNDA_ERROR_EVENT_DEFINITION_TYPE = 'camunda:errorEventDefinition';\nexport const CAMUNDA_EXECUTION_LISTENER_TYPE = 'camunda:executionListener';\nexport const CAMUNDA_FIELD_TYPE = 'camunda:field';\nexport const CAMUNDA_IN_BUSINESS_KEY_TYPE = 'camunda:in:businessKey';\nexport const CAMUNDA_IN_TYPE = 'camunda:in';\nexport const CAMUNDA_INPUT_PARAMETER_TYPE = 'camunda:inputParameter';\nexport const CAMUNDA_OUT_TYPE = 'camunda:out';\nexport const CAMUNDA_OUTPUT_PARAMETER_TYPE = 'camunda:outputParameter';\nexport const CAMUNDA_PROPERTY_TYPE = 'camunda:property';\nexport const PROPERTY_TYPE = 'property';\n\nexport const EXTENSION_BINDING_TYPES = [\n  CAMUNDA_ERROR_EVENT_DEFINITION_TYPE,\n  CAMUNDA_FIELD_TYPE,\n  CAMUNDA_IN_TYPE,\n  CAMUNDA_IN_BUSINESS_KEY_TYPE,\n  CAMUNDA_INPUT_PARAMETER_TYPE,\n  CAMUNDA_OUT_TYPE,\n  CAMUNDA_OUTPUT_PARAMETER_TYPE,\n  CAMUNDA_PROPERTY_TYPE\n];\n\nexport const IO_BINDING_TYPES = [\n  CAMUNDA_INPUT_PARAMETER_TYPE,\n  CAMUNDA_OUTPUT_PARAMETER_TYPE\n];\n\nexport const IN_OUT_BINDING_TYPES = [\n  CAMUNDA_IN_BUSINESS_KEY_TYPE,\n  CAMUNDA_IN_TYPE,\n  CAMUNDA_OUT_TYPE\n];","import {\n  forEach,\n  find,\n  groupBy,\n  isArray,\n  isString,\n  isUndefined\n} from 'min-dash';\n\nimport { getBusinessObject } from 'bpmn-js/lib/util/ModelUtil';\n\nimport { useService } from 'bpmn-js-properties-panel';\n\nimport {\n  Group,\n  SelectEntry, isSelectEntryEdited,\n  CheckboxEntry, isCheckboxEntryEdited,\n  TextAreaEntry, isTextAreaEntryEdited,\n  TextFieldEntry, isTextFieldEntryEdited\n} from '@bpmn-io/properties-panel';\n\nimport { PropertyDescription } from '../../../components/PropertyDescription';\n\nimport {\n  findCamundaErrorEventDefinition,\n  findCamundaInOut,\n  findCamundaProperty,\n  findExtension,\n  findExtensions,\n  findInputParameter,\n  findOutputParameter\n} from '../../Helper';\n\nimport {\n  createElement,\n  getRoot\n} from '../../../utils/ElementUtil';\n\nimport {\n  createCamundaErrorEventDefinition,\n  createCamundaFieldInjection,\n  createCamundaIn,\n  createCamundaInWithBusinessKey,\n  createCamundaOut,\n  createCamundaProperty,\n  createError,\n  createInputParameter,\n  createOutputParameter\n} from '../../CreateHelper';\n\nimport {\n  CAMUNDA_ERROR_EVENT_DEFINITION_TYPE,\n  CAMUNDA_EXECUTION_LISTENER_TYPE,\n  CAMUNDA_FIELD_TYPE,\n  CAMUNDA_IN_BUSINESS_KEY_TYPE,\n  CAMUNDA_IN_TYPE,\n  CAMUNDA_INPUT_PARAMETER_TYPE,\n  CAMUNDA_OUT_TYPE,\n  CAMUNDA_OUTPUT_PARAMETER_TYPE,\n  CAMUNDA_PROPERTY_TYPE,\n  PROPERTY_TYPE,\n  EXTENSION_BINDING_TYPES,\n  IO_BINDING_TYPES,\n  IN_OUT_BINDING_TYPES\n} from '../../util/bindingTypes';\n\nconst PRIMITIVE_MODDLE_TYPES = [\n  'Boolean',\n  'Integer',\n  'String'\n];\n\nexport function CustomProperties(props) {\n  const {\n    element,\n    elementTemplate,\n    injector\n  } = props;\n\n  const translate = injector.get('translate');\n\n  const groups = [];\n\n  const {\n    id,\n    properties,\n    groups: propertyGroups,\n    scopes\n  } = elementTemplate;\n\n  // (1) group properties by group id\n  const groupedProperties = groupByGroupId(properties);\n  const defaultProps = [];\n\n  forEach(groupedProperties, (properties, groupId) => {\n\n    const group = findCustomGroup(propertyGroups, groupId);\n\n    if (!group) {\n      return defaultProps.push(...properties);\n    }\n\n    addCustomGroup(groups, {\n      element,\n      id: `ElementTemplates__CustomProperties-${groupId}`,\n      label: translate(group.label),\n      properties: properties,\n      templateId: `${id}-${groupId}`\n    });\n  });\n\n  // (2) add default custom props\n  if (defaultProps.length) {\n    addCustomGroup(groups, {\n      id: 'ElementTemplates__CustomProperties',\n      label: translate('Custom properties'),\n      element,\n      properties: defaultProps,\n      templateId: id\n    });\n  }\n\n  // (3) add custom scopes props\n  if (isArray(scopes)) {\n    scopes.forEach((scope) => {\n      const {\n        properties,\n        type\n      } = scope;\n\n      const id = type.replace(/:/g, '-');\n\n      addCustomGroup(groups, {\n        element,\n        id: `ElementTemplates__CustomGroup-${ id }`,\n        label: translate(`Custom properties for scope <${ type }>`),\n        properties,\n        templateId: id,\n        scope\n      });\n    });\n  }\n\n  return groups;\n}\n\nfunction addCustomGroup(groups, props) {\n\n  const {\n    element,\n    id,\n    label,\n    properties,\n    scope,\n    templateId\n  } = props;\n\n  const customPropertiesGroup = {\n    id,\n    label,\n    component: Group,\n    entries: [],\n    shouldOpen: true\n  };\n\n  properties.forEach((property, index) => {\n    const entry = createCustomEntry(\n      `custom-entry-${ templateId }-${ index }`,\n      element,\n      property,\n      scope\n    );\n\n    if (entry) {\n      customPropertiesGroup.entries.push(entry);\n    }\n  });\n\n  if (customPropertiesGroup.entries.length) {\n    groups.push(customPropertiesGroup);\n  }\n}\n\nfunction createCustomEntry(id, element, property, scope) {\n  let { type } = property;\n\n  if (!type) {\n    type = getDefaultType(property);\n  }\n\n  if (type === 'Boolean') {\n    return {\n      id,\n      component: BooleanProperty,\n      isEdited: isCheckboxEntryEdited,\n      property,\n      scope\n    };\n  }\n\n  if (type === 'Dropdown') {\n    return {\n      id,\n      component: DropdownProperty,\n      isEdited: isSelectEntryEdited,\n      property,\n      scope\n    };\n  }\n\n  if (type === 'String') {\n    return {\n      id,\n      component: StringProperty,\n      isEdited: isTextFieldEntryEdited,\n      property,\n      scope\n    };\n  }\n\n  if (type === 'Text') {\n    return {\n      id,\n      component: TextAreaProperty,\n      isEdited: isTextAreaEntryEdited,\n      property,\n      scope\n    };\n  }\n}\n\nfunction getDefaultType(property) {\n  const { binding } = property;\n\n  const { type } = binding;\n\n  if ([\n    PROPERTY_TYPE,\n    CAMUNDA_PROPERTY_TYPE,\n    CAMUNDA_IN_TYPE,\n    CAMUNDA_IN_BUSINESS_KEY_TYPE,\n    CAMUNDA_OUT_TYPE,\n    CAMUNDA_FIELD_TYPE\n  ].includes(type)) {\n    return 'String';\n  }\n\n  if (type === CAMUNDA_EXECUTION_LISTENER_TYPE) {\n    return 'Hidden';\n  }\n}\n\nfunction BooleanProperty(props) {\n  const {\n    element,\n    id,\n    property,\n    scope\n  } = props;\n\n  const {\n    description,\n    editable,\n    label\n  } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        commandStack = useService('commandStack'),\n        translate = useService('translate');\n\n  return CheckboxEntry({\n    element,\n    getValue: propertyGetter(element, property, scope),\n    id,\n    label: label ? translate(label) : label,\n    description: PropertyDescription({ description }),\n    setValue: propertySetter(bpmnFactory, commandStack, element, property, scope),\n    disabled: editable === false\n  });\n}\n\nfunction DropdownProperty(props) {\n  const {\n    element,\n    id,\n    property,\n    scope\n  } = props;\n\n  const {\n    description,\n    editable,\n    label\n  } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        commandStack = useService('commandStack'),\n        translate = useService('translate');\n\n  const getOptions = () => {\n    const { choices } = property;\n\n    return choices.map(({ name, value }) => {\n      return {\n        label: translate(name),\n        value\n      };\n    });\n  };\n\n  return SelectEntry({\n    element,\n    id,\n    label: label ? translate(label) : label,\n    getOptions,\n    description: PropertyDescription({ description }),\n    getValue: propertyGetter(element, property, scope),\n    setValue: propertySetter(bpmnFactory, commandStack, element, property, scope),\n    disabled: editable === false,\n    validate: propertyValidator(translate, property)\n  });\n}\n\nfunction StringProperty(props) {\n  const {\n    element,\n    id,\n    property,\n    scope\n  } = props;\n\n  const {\n    description,\n    editable,\n    label,\n    placeholder\n  } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        commandStack = useService('commandStack'),\n        debounce = useService('debounceInput'),\n        translate = useService('translate');\n\n  return TextFieldEntry({\n    debounce,\n    element,\n    getValue: propertyGetter(element, property, scope),\n    id,\n    placeholder,\n    label: label ? translate(label) : label,\n    description: PropertyDescription({ description }),\n    setValue: propertySetter(bpmnFactory, commandStack, element, property, scope),\n    validate: propertyValidator(translate, property),\n    disabled: editable === false\n  });\n}\n\nfunction TextAreaProperty(props) {\n  const {\n    element,\n    id,\n    property,\n    scope\n  } = props;\n\n  const {\n    description,\n    editable,\n    label,\n    placeholder\n  } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        commandStack = useService('commandStack'),\n        debounce = useService('debounceInput'),\n        translate = useService('translate');\n\n  return TextAreaEntry({\n    debounce,\n    element,\n    id,\n    placeholder,\n    label: label ? translate(label) : label,\n    description: PropertyDescription({ description }),\n    getValue: propertyGetter(element, property, scope),\n    setValue: propertySetter(bpmnFactory, commandStack, element, property, scope),\n    disabled: editable === false,\n    validate: propertyValidator(translate, property)\n  });\n}\n\nfunction propertyGetter(element, property, scope) {\n  return function getValue() {\n    let businessObject = getBusinessObject(element);\n\n    const {\n      binding,\n      value: defaultValue = ''\n    } = property;\n\n    const {\n      name,\n      type\n    } = binding;\n\n    if (scope) {\n      businessObject = getScopeBusinessObject(businessObject, scope);\n\n      if (!businessObject) {\n        return defaultValue;\n      }\n    }\n\n    // property\n    if (type === 'property') {\n      const value = businessObject.get(name);\n\n      if (name === 'conditionExpression') {\n        if (value) {\n          return value.get('body');\n        }\n\n        return defaultValue;\n      } else {\n        if (!isUndefined(value)) {\n          return value;\n        }\n\n        return defaultValue;\n      }\n    }\n\n    // camunda:ErrorEventDefinition\n    if (type === CAMUNDA_ERROR_EVENT_DEFINITION_TYPE) {\n      const { errorRef } = binding;\n\n      const errorEventDefinition = findCamundaErrorEventDefinition(businessObject, errorRef);\n\n      if (errorEventDefinition) {\n        return errorEventDefinition.get('camunda:expression');\n      } else {\n        return '';\n      }\n    }\n\n    // camunda:Field\n    if (type === CAMUNDA_FIELD_TYPE) {\n      const camundaFields = findExtensions(businessObject, [ 'camunda:Field' ]);\n\n      const camundaField = camundaFields.find((camundaField) => {\n        return camundaField.get('camunda:name') === name;\n      });\n\n      if (camundaField) {\n        return camundaField.get('camunda:string') || camundaField.get('camunda:expression');\n      } else {\n        return '';\n      }\n    }\n\n    // camunda:Property\n    if (type === CAMUNDA_PROPERTY_TYPE) {\n      let camundaProperties;\n\n      if (scope) {\n\n        // TODO(philippfromme): as only bpmn:Error and camunda:Connector are supported this code is practically dead\n        camundaProperties = businessObject.get('properties');\n      } else {\n        camundaProperties = findExtension(businessObject, 'camunda:Properties');\n      }\n\n      if (camundaProperties) {\n        const camundaProperty = findCamundaProperty(camundaProperties, binding);\n\n        if (camundaProperty) {\n          return camundaProperty.get('camunda:value');\n        }\n      }\n\n      return defaultValue;\n    }\n\n    if (IO_BINDING_TYPES.includes(type)) {\n      let inputOutput;\n\n      if (scope) {\n        inputOutput = businessObject.get('inputOutput');\n      } else {\n        inputOutput = findExtension(businessObject, 'camunda:InputOutput');\n      }\n\n      if (!inputOutput) {\n        return defaultValue;\n      }\n\n      // camunda:InputParameter\n      if (type === CAMUNDA_INPUT_PARAMETER_TYPE) {\n        const inputParameter = findInputParameter(inputOutput, binding);\n\n        if (inputParameter) {\n          const { scriptFormat } = binding;\n\n          if (scriptFormat) {\n            const definition = inputParameter.get('camunda:definition');\n\n            if (definition) {\n              return definition.get('camunda:value');\n            }\n          } else {\n            return inputParameter.get('value') || '';\n          }\n        }\n\n        return defaultValue;\n      }\n\n      // camunda:OutputParameter\n      if (type === CAMUNDA_OUTPUT_PARAMETER_TYPE) {\n        const outputParameter = findOutputParameter(inputOutput, binding);\n\n        if (outputParameter) {\n          return outputParameter.get('camunda:name');\n        }\n\n        return defaultValue;\n      }\n    }\n\n    // camunda:In and camunda:Out\n    if (IN_OUT_BINDING_TYPES.includes(type)) {\n      const camundaInOut = findCamundaInOut(businessObject, binding);\n\n      if (camundaInOut) {\n        if (type === CAMUNDA_IN_BUSINESS_KEY_TYPE) {\n          return camundaInOut.get('camunda:businessKey');\n        } else if (type === CAMUNDA_OUT_TYPE) {\n          return camundaInOut.get('camunda:target');\n        } else if (type === CAMUNDA_IN_TYPE) {\n          const { expression } = binding;\n\n          if (expression) {\n            return camundaInOut.get('camunda:sourceExpression');\n          } else {\n            return camundaInOut.get('camunda:source');\n          }\n        }\n      }\n\n      return defaultValue;\n    }\n\n    // should never throw as templates are validated beforehand\n    throw unknownBindingError(element, property);\n  };\n}\n\nfunction propertySetter(bpmnFactory, commandStack, element, property, scope) {\n  return function setValue(value) {\n    let businessObject = getBusinessObject(element);\n\n    const { binding } = property;\n\n    const {\n      name,\n      type\n    } = binding;\n\n    const rootElement = getRoot(businessObject);\n\n    let extensionElements;\n\n    let propertyValue;\n\n    const commands = [];\n\n    if (EXTENSION_BINDING_TYPES.includes(type)) {\n      extensionElements = businessObject.get('extensionElements');\n\n      if (!extensionElements) {\n        extensionElements = createElement('bpmn:ExtensionElements', null, businessObject, bpmnFactory);\n\n        commands.push({\n          cmd: 'element.updateModdleProperties',\n          context: {\n            element,\n            moddleElement: businessObject,\n            properties: { extensionElements }\n          }\n        });\n      }\n    }\n\n    if (scope) {\n      businessObject = getScopeBusinessObject(businessObject, scope);\n\n      if (!businessObject) {\n\n        // bpmn:Error\n        if (scope.type === 'bpmn:Error') {\n          businessObject = createError(scope.id, rootElement, bpmnFactory);\n\n          commands.push({\n            cmd: 'element.updateModdleProperties',\n            context: {\n              element,\n              moddleElement: rootElement,\n              properties: { rootElements: [ ...rootElement.get('rootElements'), businessObject ] }\n            }\n          });\n        } else {\n          businessObject = createElement(scope.type, null, element, bpmnFactory);\n\n          commands.push({\n            cmd: 'element.updateModdleProperties',\n            context: {\n              element,\n              moddleElement: extensionElements,\n              properties: { values: [ ...extensionElements.get('values'), businessObject ] }\n            }\n          });\n        }\n      }\n    }\n\n    // property\n    if (type === 'property') {\n\n      if (name === 'conditionExpression') {\n        const { scriptFormat } = binding;\n\n        propertyValue = createElement('bpmn:FormalExpression', {\n          body: value,\n          language: scriptFormat\n        }, businessObject, bpmnFactory);\n      } else {\n        const propertyDescriptor = businessObject.$descriptor.propertiesByName[ name ];\n\n        const { type: propertyType } = propertyDescriptor;\n\n        // do not override non-primitive types\n        if (!PRIMITIVE_MODDLE_TYPES.includes(propertyType)) {\n          throw new Error(`cannot set property of type <${ propertyType }>`);\n        }\n\n        if (propertyType === 'Boolean') {\n          propertyValue = !!value;\n        } else if (propertyType === 'Integer') {\n          propertyValue = parseInt(value, 10);\n\n          if (isNaN(propertyValue)) {\n\n            // do not set NaN value\n            propertyValue = undefined;\n          }\n        } else {\n\n          // make sure we don't remove the property\n          propertyValue = value || '';\n        }\n      }\n\n      if (!isUndefined(propertyValue)) {\n        commands.push({\n          cmd: 'element.updateModdleProperties',\n          context: {\n            element,\n            moddleElement: businessObject,\n            properties: { [ name ]: propertyValue }\n          }\n        });\n      }\n    }\n\n    // camunda:ErrorEventDefinition\n    if (type === CAMUNDA_ERROR_EVENT_DEFINITION_TYPE) {\n      const { errorRef } = binding;\n\n      const oldCamundaErrorEventDefinition = findCamundaErrorEventDefinition(businessObject, errorRef);\n\n      if (oldCamundaErrorEventDefinition) {\n        commands.push({\n          cmd: 'element.updateModdleProperties',\n          context: {\n            element,\n            moddleElement: oldCamundaErrorEventDefinition,\n            properties: { 'camunda:expression': value }\n          }\n        });\n      } else {\n        const newError = createError(binding.errorRef, rootElement, bpmnFactory),\n              newCamundaErrorEventDefinition = createCamundaErrorEventDefinition(value, newError, extensionElements, bpmnFactory);\n\n        commands.push({\n          cmd: 'element.updateModdleProperties',\n          context: {\n            element,\n            moddleElement: rootElement,\n            properties: { rootElements: [ ...rootElement.get('rootElements'), newError ] }\n          }\n        });\n\n        commands.push({\n          cmd: 'element.updateModdleProperties',\n          context: {\n            element,\n            moddleElement: extensionElements,\n            properties: { values: [ ...extensionElements.get('values'), newCamundaErrorEventDefinition ] }\n          }\n        });\n      }\n    }\n\n    // camunda:Field\n    if (type === CAMUNDA_FIELD_TYPE) {\n      const oldCamundaFields = findExtensions(businessObject, [ 'camunda:Field' ]);\n\n      const newCamundaFields = [];\n\n      if (oldCamundaFields.length) {\n        oldCamundaFields.forEach((camundaField) => {\n          if (camundaField.name === name) {\n            newCamundaFields.push(createCamundaFieldInjection(binding, value, bpmnFactory));\n          } else {\n            newCamundaFields.push(camundaField);\n          }\n        });\n      } else {\n        newCamundaFields.push(createCamundaFieldInjection(binding, value, bpmnFactory));\n      }\n\n      const values = extensionElements.get('values').filter((value) => !oldCamundaFields.includes(value));\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          element,\n          moddleElement: extensionElements,\n          properties: {\n            values:\n            [ ...values, ...newCamundaFields ]\n          }\n        }\n      });\n    }\n\n    // camunda:Property\n    if (type === CAMUNDA_PROPERTY_TYPE) {\n      let camundaProperties;\n\n      if (scope) {\n        camundaProperties = businessObject.get('properties');\n      } else {\n        camundaProperties = findExtension(extensionElements, 'camunda:Properties');\n      }\n\n      if (!camundaProperties) {\n        camundaProperties = createElement('camunda:Properties', null, businessObject, bpmnFactory);\n\n        if (scope) {\n          commands.push({\n            cmd: 'element.updateModdleProperties',\n            context: {\n              element,\n              moddleElement: businessObject,\n              properties: { properties: camundaProperties }\n            }\n          });\n        } else {\n          commands.push({\n            cmd: 'element.updateModdleProperties',\n            context: {\n              element,\n              moddleElement: extensionElements,\n              properties: { values: [ ...extensionElements.get('values'), camundaProperties ] }\n            }\n          });\n        }\n      }\n\n      const oldCamundaProperty = findCamundaProperty(camundaProperties, binding);\n\n      const newCamundaProperty = createCamundaProperty(binding, value, bpmnFactory);\n\n      const values = camundaProperties.get('values').filter((value) => value !== oldCamundaProperty);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          element,\n          moddleElement: camundaProperties,\n          properties: { values: [ ...values, newCamundaProperty ] }\n        }\n      });\n    }\n\n    if (IO_BINDING_TYPES.includes(type)) {\n      let inputOutput;\n\n      if (scope) {\n        inputOutput = businessObject.get('inputOutput');\n      } else {\n        inputOutput = findExtension(extensionElements, 'camunda:InputOutput');\n      }\n\n      if (!inputOutput) {\n        inputOutput = createElement('camunda:InputOutput', null, businessObject, bpmnFactory);\n\n        if (scope) {\n          commands.push({\n            cmd: 'element.updateModdleProperties',\n            context: {\n              element,\n              moddleElement: businessObject,\n              properties: { inputOutput }\n            }\n          });\n        }\n        else {\n          commands.push({\n            cmd: 'element.updateModdleProperties',\n            context: {\n              element,\n              moddleElement: extensionElements,\n              properties: { values: [ ...extensionElements.get('values'), inputOutput ] }\n            }\n          });\n        }\n      }\n\n      // camunda:InputParameter\n      if (type === CAMUNDA_INPUT_PARAMETER_TYPE) {\n        const oldCamundaInputParameter = findInputParameter(inputOutput, binding);\n\n        const newCamundaInputParameter = createInputParameter(binding, value, bpmnFactory);\n\n        const values = inputOutput.get('camunda:inputParameters').filter((value) => value !== oldCamundaInputParameter);\n\n        commands.push({\n          cmd: 'element.updateModdleProperties',\n          context: {\n            element,\n            moddleElement: inputOutput,\n            properties: { 'camunda:inputParameters': [ ...values, newCamundaInputParameter ] }\n          }\n        });\n      }\n\n      // camunda:OutputParameter\n      if (type === CAMUNDA_OUTPUT_PARAMETER_TYPE) {\n        const oldCamundaOutputParameter = findOutputParameter(inputOutput, binding);\n\n        const newCamundaOutputParameter = createOutputParameter(binding, value, bpmnFactory);\n\n        const values = inputOutput.get('camunda:outputParameters').filter((value) => value !== oldCamundaOutputParameter);\n\n        commands.push({\n          cmd: 'element.updateModdleProperties',\n          context: {\n            element,\n            moddleElement: inputOutput,\n            properties: { 'camunda:outputParameters': [ ...values, newCamundaOutputParameter ] }\n          }\n        });\n      }\n    }\n\n    // camunda:In and camunda:Out\n    if (IN_OUT_BINDING_TYPES.includes(type)) {\n      const oldCamundaInOut = findCamundaInOut(businessObject, binding);\n\n      let newCamundaInOut;\n\n      if (type === CAMUNDA_IN_TYPE) {\n        newCamundaInOut = createCamundaIn(binding, value, bpmnFactory);\n      } else if (type === CAMUNDA_OUT_TYPE) {\n        newCamundaInOut = createCamundaOut(binding, value, bpmnFactory);\n      } else {\n        newCamundaInOut = createCamundaInWithBusinessKey(value, bpmnFactory);\n      }\n\n      const values = extensionElements.get('values').filter((value) => value !== oldCamundaInOut);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          element,\n          moddleElement: extensionElements,\n          properties: { values: [ ...values, newCamundaInOut ] }\n        }\n      });\n    }\n\n    if (commands.length) {\n      commandStack.execute(\n        'element-templates.multi-command-executor',\n        commands\n      );\n\n      return;\n    }\n\n    // should never throw as templates are validated beforehand\n    throw unknownBindingError(element, property);\n  };\n}\n\nfunction propertyValidator(translate, property) {\n  return function validate(value) {\n    const { constraints = {} } = property;\n\n    const {\n      maxLength,\n      minLength,\n      notEmpty\n    } = constraints;\n\n    if (notEmpty && isEmptyString(value)) {\n      return translate('Must not be empty.');\n    }\n\n    if (property.feel && isFeel(value)) {\n      return;\n    }\n\n    if (maxLength && value.length > maxLength) {\n      return translate('Must have max length {maxLength}.', { maxLength });\n    }\n\n    if (minLength && value.length < minLength) {\n      return translate('Must have min length {minLength}.', { minLength });\n    }\n\n    let { pattern } = constraints;\n\n    if (pattern) {\n      let message;\n\n      if (!isString(pattern)) {\n        message = pattern.message;\n        pattern = pattern.value;\n      }\n\n      if (!matchesPattern(value, pattern)) {\n        return message || translate('Must match pattern {pattern}.', { pattern });\n      }\n    }\n  };\n}\n\nfunction getScopeBusinessObject(businessObject, scope) {\n  const {\n    id,\n    type\n  } = scope;\n\n  if (type === 'bpmn:Error') {\n\n    // retrieve error through referenced error event definition\n    const errorEventDefinition = findCamundaErrorEventDefinition(businessObject, id);\n\n    if (errorEventDefinition) {\n      return errorEventDefinition.get('errorRef');\n    }\n  }\n\n  return findExtension(businessObject, type);\n}\n\nfunction unknownBindingError(element, property) {\n  const businessObject = getBusinessObject(element);\n\n  const id = businessObject.get('id');\n\n  const { binding } = property;\n\n  const { type } = binding;\n\n  return new Error(`unknown binding <${ type }> for element <${ id }>, this should never happen`);\n}\n\nfunction isEmptyString(string) {\n  return !string || !string.trim().length;\n}\n\nfunction matchesPattern(string, pattern) {\n  return new RegExp(pattern).test(string);\n}\n\nfunction groupByGroupId(properties) {\n  return groupBy(properties, 'group');\n}\n\nfunction findCustomGroup(groups, id) {\n  return find(groups, g => g.id === id);\n}\n\nfunction isFeel(value) {\n  return isString(value) && value.trim().startsWith('=');\n}","import { without } from 'min-dash';\n\nimport { getBusinessObject } from 'bpmn-js/lib/util/ModelUtil';\n\nimport { TextFieldEntry } from '@bpmn-io/properties-panel';\n\nimport {\n  findCamundaErrorEventDefinition,\n  findExtensions\n} from '../../Helper';\n\nimport { useService } from 'bpmn-js-properties-panel';\n\n\nexport function ErrorProperties(props) {\n  const {\n    element,\n    index,\n    property,\n    groups\n  } = props;\n\n  const {\n    binding,\n    label\n  } = property;\n\n  const {\n    errorRef\n  } = binding;\n\n  const businessObject = getBusinessObject(element),\n        errorEventDefinitions = findExtensions(businessObject, [ 'camunda:ErrorEventDefinition' ]);\n\n  if (!errorEventDefinitions.length) {\n    return;\n  }\n\n  const errorEventDefinition = findCamundaErrorEventDefinition(element, errorRef);\n\n  const id = `${ element.id }-error-${ index }`;\n\n  let entries = [];\n\n  const errorGroup = groups.find(({ id }) => id === 'CamundaPlatform__Errors');\n  const originalItem = errorGroup.items.find(({ entries }) => entries[0].errorEventDefinition === errorEventDefinition);\n  entries = originalItem.entries;\n\n  // (1) remove global error referenced entry\n  // entries.shift();\n  entries = removeEntry(entries, '-errorRef');\n\n  // (2) remove throw expression input\n  // entries.pop();\n  entries = removeEntry(entries, '-expression');\n\n  // (3) add disabled throw expression input\n  entries.push({\n    id: `${ id }-expression`,\n    component: Expression,\n    errorEventDefinition,\n    property\n  });\n\n  const item = {\n    id,\n    label: label || getErrorLabel(errorEventDefinition),\n    entries\n  };\n\n  return item;\n}\n\nfunction Expression(props) {\n  const {\n    errorEventDefinition,\n    id\n  } = props;\n\n  const translate = useService('translate');\n  const debounce = useService('debounceInput');\n\n  const setValue = () => {};\n\n  const getValue = () => {\n    return errorEventDefinition.get('camunda:expression');\n  };\n\n  return TextFieldEntry({\n    element: errorEventDefinition,\n    id,\n    label: translate('Throw expression'),\n    getValue,\n    setValue,\n    debounce,\n    disabled: true\n  });\n}\n\nfunction removeEntry(entries, suffix) {\n  const entry = entries.find(({ id }) => id.endsWith(suffix));\n\n  return without(entries, entry);\n}\n\nfunction getErrorLabel(errorEventDefinition) {\n  const error = errorEventDefinition.get('errorRef');\n\n  if (!error) {\n    return '<no reference>';\n  }\n\n  const errorCode = error.get('errorCode'),\n        name = error.get('name') || '<unnamed>';\n\n  if (errorCode) {\n    return `${ name } (code = ${ errorCode })`;\n  }\n\n  return name;\n}\n","import { getBusinessObject } from 'bpmn-js/lib/util/ModelUtil';\n\nimport { ToggleSwitchEntry } from '@bpmn-io/properties-panel';\n\nimport {\n  findExtension,\n  findInputParameter\n} from '../../Helper';\n\nimport { useService } from 'bpmn-js-properties-panel';\n\nimport { without } from 'min-dash';\n\nimport { createElement } from '../../../utils/ElementUtil';\n\nimport { PropertyDescription } from '../../../components/PropertyDescription';\n\nimport { createInputParameter } from '../../CreateHelper';\n\n\nexport function InputProperties(props) {\n  const {\n    element,\n    index,\n    property,\n    groups\n  } = props;\n\n  const {\n    binding,\n    description,\n    label\n  } = property;\n\n  const { name } = binding;\n\n  const businessObject = getBusinessObject(element),\n        inputOutput = findExtension(businessObject, 'camunda:InputOutput');\n\n  const inputParameter = inputOutput && findInputParameter(inputOutput, binding);\n\n  const id = `${ element.id }-inputParameter-${ index }`;\n\n  let entries = [];\n\n  if (inputParameter) {\n    const inputGroup = groups.find(({ id }) => id === 'CamundaPlatform__Input');\n    const item = inputGroup.items.find(({ entries }) => entries[0].parameter === inputParameter);\n    entries = item.entries;\n\n    // (1) remove name entry\n    entries = removeEntry(entries, '-name');\n  }\n\n  // (2) add local variable assignment entry\n  entries.unshift({\n    id: `${ id }-local-variable-assignment`,\n    component: LocalVariableAssignment,\n    inputParameter,\n    property\n  });\n\n  // (3) add description entry\n  if (description) {\n    entries.unshift({\n      id: `${ id }-description`,\n      component: Description,\n      text: description\n    });\n  }\n\n  // @barmac: binding#name is required so there is no third option\n  const item = {\n    id,\n    label: label || name,\n    entries\n  };\n\n  return item;\n}\n\n// TODO(philippfromme): add text entry to properties-panel\nfunction Description(props) {\n  const {\n    id,\n    text\n  } = props;\n\n  return <div class=\"bio-properties-panel-entry\" data-entry-id={ id }>\n    <div class=\"bio-properties-panel-description\">\n      <PropertyDescription description={ text } />\n    </div>\n  </div>;\n}\n\nfunction LocalVariableAssignment(props) {\n  const {\n    element,\n    id,\n    property,\n    inputParameter\n  } = props;\n\n  const { binding } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        modeling = useService('modeling'),\n        translate = useService('translate');\n\n  const getValue = () => {\n    return inputParameter;\n  };\n\n  const setValue = (value) => {\n    if (value) {\n      addInputParameter(element, property, bpmnFactory, modeling);\n    } else {\n      removeInputParameter(element, binding, modeling);\n    }\n  };\n\n  return ToggleSwitchEntry({\n    id,\n    label: translate('Local variable assignment'),\n    switcherLabel: inputParameter ?\n      translate('On') :\n      translate('Off'),\n    description: inputParameter ?\n      '' :\n      translate('Parameter won\\'t be created as local variable.'),\n    getValue,\n    setValue\n  });\n}\n\nfunction addInputParameter(element, property, bpmnFactory, modeling) {\n  const {\n    binding,\n    value\n  } = property;\n\n  const businessObject = getBusinessObject(element);\n\n  const extensionElements = businessObject.get('extensionElements');\n  const inputOutput = findExtension(businessObject, 'camunda:InputOutput');\n\n  let updatedBusinessObject, update;\n\n  if (!extensionElements) {\n    updatedBusinessObject = businessObject;\n\n    const extensionElements = createExtensionElements(businessObject, bpmnFactory),\n          inputOutput = createInputOutput(binding, value, bpmnFactory, extensionElements);\n    extensionElements.values.push(inputOutput);\n\n    update = { extensionElements };\n  } else if (!inputOutput) {\n    updatedBusinessObject = extensionElements;\n\n    const inputOutput = createInputOutput(binding, value, bpmnFactory, extensionElements);\n\n    update = { values: extensionElements.get('values').concat(inputOutput) };\n  } else {\n    updatedBusinessObject = inputOutput;\n\n    const inputParameter = createInputParameter(binding, value, bpmnFactory);\n    inputParameter.$parent = inputOutput;\n\n    update = { inputParameters: inputOutput.get('camunda:inputParameters').concat(inputParameter) };\n  }\n\n  modeling.updateModdleProperties(element, updatedBusinessObject, update);\n}\n\nfunction removeInputParameter(element, binding, modeling) {\n  const businessObject = getBusinessObject(element);\n\n  const inputOutput = findExtension(businessObject, 'camunda:InputOutput'),\n        inputParameters = inputOutput.get('camunda:inputParameters');\n\n  const inputParameter = findInputParameter(inputOutput, binding);\n\n  modeling.updateModdleProperties(element, inputOutput, {\n    inputParameters: without(inputParameters, inputParameter)\n  });\n}\n\nfunction removeEntry(entries, suffix) {\n  const entry = entries.find(({ id }) => id.endsWith(suffix));\n\n  return without(entries, entry);\n}\n\nfunction createExtensionElements(businessObject, bpmnFactory) {\n  return createElement(\n    'bpmn:ExtensionElements',\n    { values: [] },\n    businessObject,\n    bpmnFactory\n  );\n}\n\nfunction createInputOutput(binding, value, bpmnFactory, extensionElements) {\n  const inputParameter = createInputParameter(binding, value, bpmnFactory);\n  const inputOutput = createElement('camunda:InputOutput', {\n    inputParameters: [ inputParameter ],\n    outputParameters: []\n  }, extensionElements, bpmnFactory);\n\n  inputParameter.$parent = inputOutput;\n  return inputOutput;\n}\n","const SPACE_REGEX = /\\s/;\n\n// for QName validation as per http://www.w3.org/TR/REC-xml/#NT-NameChar\nconst QNAME_REGEX = /^([a-z][\\w-.]*:)?[a-z_][\\w-.]*$/i;\n\n// for ID validation as per BPMN Schema (QName - Namespace)\nconst ID_REGEX = /^[a-z_][\\w-.]*$/i;\n\n/**\n * checks whether the id value is valid\n *\n * @param {ModdleElement} element\n * @param {String} idValue\n * @param {Function} translate\n *\n * @return {String} error message\n */\nexport function isIdValid(element, idValue, translate) {\n  const assigned = element.$model.ids.assigned(idValue);\n  const idAlreadyExists = assigned && assigned !== element;\n\n  if (!idValue) {\n    return translate('ID must not be empty.');\n  }\n\n  if (idAlreadyExists) {\n    return translate('ID must be unique.');\n  }\n\n  return validateId(idValue, translate);\n}\n\nexport function validateId(idValue, translate) {\n\n  if (containsSpace(idValue)) {\n    return translate('ID must not contain spaces.');\n  }\n\n  if (!ID_REGEX.test(idValue)) {\n\n    if (QNAME_REGEX.test(idValue)) {\n      return translate('ID must not contain prefix.');\n    }\n\n    return translate('ID must be a valid QName.');\n  }\n}\n\nexport function containsSpace(value) {\n  return SPACE_REGEX.test(value);\n}","import { getBusinessObject } from 'bpmn-js/lib/util/ModelUtil';\n\nimport { TextFieldEntry, ToggleSwitchEntry } from '@bpmn-io/properties-panel';\n\nimport { containsSpace } from '../../util/validationUtil';\n\nimport {\n  findExtension,\n  findOutputParameter\n} from '../../Helper';\n\nimport { useService } from 'bpmn-js-properties-panel';\n\nimport { without } from 'min-dash';\n\nimport { PropertyDescription } from '../../../components/PropertyDescription';\n\nimport { createElement } from '../../../utils/ElementUtil';\n\nimport { createOutputParameter } from '../../CreateHelper';\n\n\nexport function OutputProperties(props) {\n  const {\n    element,\n    index,\n    injector,\n    property\n  } = props;\n\n  const {\n    binding,\n    description,\n    label\n  } = property;\n\n  const { name } = binding;\n\n  const businessObject = getBusinessObject(element),\n        inputOutput = findExtension(businessObject, 'camunda:InputOutput');\n\n  const translate = injector.get('translate');\n\n  const outputParameter = inputOutput && findOutputParameter(inputOutput, binding);\n\n  const id = `${ element.id }-outputParameter-${ index }`;\n\n  let entries = [];\n\n  // (1) add description entry\n  if (description) {\n    entries.push({\n      id: `${ id }-description`,\n      component: Description,\n      text: description\n    });\n  }\n\n  // (2) add local variable assignment entry\n  entries.push({\n    id: `${ id }-local-variable-assignment`,\n    component: ProcessVariableAssignment,\n    outputParameter,\n    property\n  });\n\n  if (outputParameter) {\n\n    // (3) add assign to process variable entry\n    entries.push({\n      id: `${ id }-assign-to-process-variable`,\n      component: AssignToProcessVariable,\n      property\n    });\n  }\n\n  const item = {\n    id,\n    label: label || name || translate('<unnamed>'),\n    entries\n  };\n\n  return item;\n}\n\n// TODO(philippfromme): add text entry to properties-panel\nfunction Description(props) {\n  const {\n    id,\n    text\n  } = props;\n\n  return <div class=\"bio-properties-panel-entry\" data-entry-id={ id }>\n    <div class=\"bio-properties-panel-description\">\n      <PropertyDescription description={ text } />\n    </div>\n  </div>;\n}\n\nfunction ProcessVariableAssignment(props) {\n  const {\n    element,\n    id,\n    property,\n    outputParameter\n  } = props;\n\n  const { binding } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        modeling = useService('modeling'),\n        translate = useService('translate');\n\n  const getValue = () => {\n    return outputParameter;\n  };\n\n  const setValue = (value) => {\n    if (value) {\n      addOutputParameter(element, property, bpmnFactory, modeling);\n    } else {\n      removeOutputParameter(element, binding, modeling);\n    }\n  };\n\n  return ToggleSwitchEntry({\n    id,\n    label: translate('Process variable assignment'),\n    switcherLabel: outputParameter ?\n      translate('On') :\n      translate('Off'),\n    description: outputParameter ?\n      '' :\n      translate('Parameter won\\'t be available in process scope.'),\n    getValue,\n    setValue\n  });\n}\n\nfunction AssignToProcessVariable(props) {\n  const {\n    element,\n    id,\n    property\n  } = props;\n\n  const { binding } = property;\n\n  const inputOutput = findExtension(element, 'camunda:InputOutput'),\n        outputParameter = findOutputParameter(inputOutput, binding);\n\n  const commandStack = useService('commandStack'),\n        debounce = useService('debounceInput'),\n        translate = useService('translate');\n\n  const setValue = (value) => {\n    commandStack.execute('element.updateModdleProperties', {\n      element,\n      moddleElement: outputParameter,\n      properties: { name: value }\n    });\n  };\n\n  const getValue = () => {\n    return outputParameter.get('camunda:name');\n  };\n\n  const validate = (value) => {\n    if (!value) {\n      return translate('Process variable name must not be empty.');\n    } else if (containsSpace(value)) {\n      return translate('Process variable name must not contain spaces.');\n    }\n  };\n\n  return TextFieldEntry({\n    debounce,\n    element: outputParameter,\n    id,\n    label: translate('Assign to process variable'),\n    getValue,\n    setValue,\n    validate\n  });\n}\n\nfunction addOutputParameter(element, property, bpmnFactory, modeling) {\n  const {\n    binding,\n    value\n  } = property;\n\n  const businessObject = getBusinessObject(element);\n\n  const extensionElements = businessObject.get('extensionElements');\n  const inputOutput = findExtension(businessObject, 'camunda:InputOutput');\n\n  let updatedBusinessObject, update;\n\n  if (!extensionElements) {\n    updatedBusinessObject = businessObject;\n\n    const extensionElements = createExtensionElements(businessObject, bpmnFactory),\n          inputOutput = createInputOutput(binding, value, bpmnFactory, extensionElements);\n    extensionElements.values.push(inputOutput);\n\n    update = { extensionElements };\n  } else if (!inputOutput) {\n    updatedBusinessObject = extensionElements;\n\n    const inputOutput = createInputOutput(binding, value, bpmnFactory, extensionElements);\n\n    update = { values: extensionElements.get('values').concat(inputOutput) };\n  } else {\n    updatedBusinessObject = inputOutput;\n\n    const outputParameter = createOutputParameter(binding, value, bpmnFactory);\n    outputParameter.$parent = inputOutput;\n\n    update = { outputParameters: inputOutput.get('camunda:outputParameters').concat(outputParameter) };\n  }\n\n  modeling.updateModdleProperties(element, updatedBusinessObject, update);\n}\n\nfunction removeOutputParameter(element, binding, modeling) {\n  const businessObject = getBusinessObject(element);\n\n  const inputOutput = findExtension(businessObject, 'camunda:InputOutput'),\n        outputParameters = inputOutput.get('camunda:outputParameters');\n\n  const outputParameter = findOutputParameter(inputOutput, binding);\n\n  modeling.updateModdleProperties(element, inputOutput, {\n    outputParameters: without(outputParameters, outputParameter)\n  });\n}\n\nfunction createExtensionElements(businessObject, bpmnFactory) {\n  return createElement(\n    'bpmn:ExtensionElements',\n    { values: [] },\n    businessObject,\n    bpmnFactory\n  );\n}\n\nfunction createInputOutput(binding, value, bpmnFactory, extensionElements) {\n  const outputParameter = createOutputParameter(binding, value, bpmnFactory);\n  const inputOutput = createElement('camunda:InputOutput', {\n    inputParameters: [],\n    outputParameters: [ outputParameter ],\n  }, extensionElements, bpmnFactory);\n\n  outputParameter.$parent = inputOutput;\n  return inputOutput;\n}\n","import { ListGroup } from '@bpmn-io/properties-panel';\n\nimport {\n  createElementTemplatesGroup,\n  TemplateProps\n} from '../../components';\n\nimport {\n  CustomProperties,\n  ErrorProperties,\n  InputProperties,\n  OutputProperties\n} from './properties';\n\nimport { getTemplateId } from '../Helper';\n\nconst CAMUNDA_ERROR_EVENT_DEFINITION_TYPE = 'camunda:errorEventDefinition',\n      CAMUNDA_INPUT_PARAMETER_TYPE = 'camunda:inputParameter',\n      CAMUNDA_OUTPUT_PARAMETER_TYPE = 'camunda:outputParameter';\n\nconst LOWER_PRIORITY = 300;\n\nconst ALWAYS_DISPLAYED_GROUPS = [\n  'general',\n  'documentation',\n  'multiInstance'\n];\n\n\nexport default class ElementTemplatesPropertiesProvider {\n\n  constructor(elementTemplates, propertiesPanel, injector) {\n    propertiesPanel.registerProvider(LOWER_PRIORITY, this);\n\n    this._elementTemplates = elementTemplates;\n    this._injector = injector;\n  }\n\n  getGroups(element) {\n    return (groups) => {\n      const injector = this._injector;\n\n      if (!this._shouldShowTemplateProperties(element)) {\n        return groups;\n      }\n\n      const translate = injector.get('translate');\n\n      // (0) Copy provided groups\n      groups = groups.slice();\n\n      const templatesGroup = {\n        element,\n        id: 'ElementTemplates__Template',\n        label: translate('Template'),\n        component: createElementTemplatesGroup(),\n        entries: TemplateProps({ element, elementTemplates: this._elementTemplates })\n      };\n\n      // (1) Add templates group\n      addGroupsAfter(ALWAYS_DISPLAYED_GROUPS, groups, [ templatesGroup ]);\n\n      const elementTemplate = this._elementTemplates.get(element);\n\n      if (elementTemplate) {\n        const templateSpecificGroups = [].concat(\n          createInputGroup(element, elementTemplate, injector, groups) || [],\n          createOutputGroup(element, elementTemplate, injector, groups) || [],\n          createErrorGroup(element, elementTemplate, injector, groups) || [],\n          CustomProperties({ element, elementTemplate, injector })\n        );\n\n        // (2) add template-specific properties groups\n        addGroupsAfter('ElementTemplates__Template', groups, templateSpecificGroups);\n      }\n\n      // (3) apply entries visible\n      if (getTemplateId(element)) {\n        groups = filterWithEntriesVisible(elementTemplate || {}, groups);\n      }\n\n      return groups;\n    };\n  }\n\n  _shouldShowTemplateProperties(element) {\n    return getTemplateId(element) || this._elementTemplates.getAll(element).length;\n  }\n}\n\nElementTemplatesPropertiesProvider.$inject = [\n  'elementTemplates',\n  'propertiesPanel',\n  'injector'\n];\n\n\n// helper /////////////////////\n\nfunction createInputGroup(element, elementTemplate, injector, groups) {\n  const translate = injector.get('translate');\n\n  const group = {\n    label: translate('Inputs'),\n    id: 'ElementTemplates__Input',\n    component: ListGroup,\n    items: []\n  };\n\n  const properties = elementTemplate.properties.filter(({ binding, type }) => {\n    return !type && binding.type === CAMUNDA_INPUT_PARAMETER_TYPE;\n  });\n\n  properties.forEach((property, index) => {\n    const item = InputProperties({ element, index, property, groups });\n\n    if (item) {\n      group.items.push(item);\n    }\n  });\n\n  // remove if empty\n  if (!group.items.length) {\n    return null;\n  }\n\n  return group;\n}\n\nfunction createOutputGroup(element, elementTemplate, injector, groups) {\n  const translate = injector.get('translate');\n\n  const group = {\n    label: translate('Outputs'),\n    id: 'ElementTemplates__Output',\n    component: ListGroup,\n    items: []\n  };\n\n  const properties = elementTemplate.properties.filter(({ binding, type }) => {\n    return !type && binding.type === CAMUNDA_OUTPUT_PARAMETER_TYPE;\n  });\n\n  properties.forEach((property, index) => {\n    const item = OutputProperties({ element, index, property, injector });\n\n    if (item) {\n      group.items.push(item);\n    }\n  });\n\n  // remove if empty\n  if (!group.items.length) {\n    return null;\n  }\n\n  return group;\n}\n\nfunction createErrorGroup(element, elementTemplate, injector, groups) {\n  const translate = injector.get('translate');\n\n  const group = {\n    label: translate('Errors'),\n    id: 'ElementTemplates__Error',\n    component: ListGroup,\n    items: []\n  };\n\n  const properties = elementTemplate.properties.filter(({ binding, type }) => {\n    return !type && binding.type === CAMUNDA_ERROR_EVENT_DEFINITION_TYPE;\n  });\n\n  properties.forEach((property, index) => {\n    const item = ErrorProperties({ element, index, property, groups });\n\n    if (item) {\n      group.items.push(item);\n    }\n  });\n\n  // remove if empty\n  if (!group.items.length) {\n    return null;\n  }\n\n  return group;\n}\n\n/**\n *\n * @param {string|string[]} idOrIds\n * @param {Array<{ id: string }} groups\n * @param {Array<{ id: string }>} groupsToAdd\n */\nfunction addGroupsAfter(idOrIds, groups, groupsToAdd) {\n  let ids = idOrIds;\n  if (!Array.isArray(idOrIds)) {\n    ids = [ idOrIds ];\n  }\n\n  // find index of last group with provided id\n  const index = groups.reduce((acc, group, index) => {\n    return ids.includes(group.id) ? index : acc;\n  }, -1);\n\n  if (index !== -1) {\n    groups.splice(index + 1, 0, ...groupsToAdd);\n  } else {\n\n    // add in the beginning if group with provided id is missing\n    groups.unshift(...groupsToAdd);\n  }\n}\n\nfunction filterWithEntriesVisible(template, groups) {\n  if (!template.entriesVisible) {\n    return groups.filter(group => {\n      return (\n        ALWAYS_DISPLAYED_GROUPS.includes(group.id) ||\n        group.id.startsWith('ElementTemplates__')\n      );\n    });\n  }\n\n  return groups;\n}\n","import translateModule from 'diagram-js/lib/i18n/translate';\n\nimport ElementTemplatesPropertiesProvider from './ElementTemplatesPropertiesProvider';\n\nimport { CamundaPlatformPropertiesProviderModule } from 'bpmn-js-properties-panel';\n\nexport default {\n  __depends__: [\n    translateModule,\n    CamundaPlatformPropertiesProviderModule\n  ],\n  __init__: [\n    'elementTemplatesPropertiesProvider'\n  ],\n  elementTemplatesPropertiesProvider: [ 'type', ElementTemplatesPropertiesProvider ]\n};\n","import coreModule from './core';\nimport propertiesProviderModule from './properties-panel';\n\nexport default {\n  __depends__: [\n    coreModule,\n    propertiesProviderModule,\n  ]\n};\n","import { forEach, bind, pick, assign, isString, isObject, set } from 'min-dash';\n\n/**\n * Moddle base element.\n */\nfunction Base() { }\n\nBase.prototype.get = function(name) {\n  return this.$model.properties.get(this, name);\n};\n\nBase.prototype.set = function(name, value) {\n  this.$model.properties.set(this, name, value);\n};\n\n/**\n * A model element factory.\n *\n * @param {Moddle} model\n * @param {Properties} properties\n */\nfunction Factory(model, properties) {\n  this.model = model;\n  this.properties = properties;\n}\n\n\nFactory.prototype.createType = function(descriptor) {\n\n  var model = this.model;\n\n  var props = this.properties,\n      prototype = Object.create(Base.prototype);\n\n  // initialize default values\n  forEach(descriptor.properties, function(p) {\n    if (!p.isMany && p.default !== undefined) {\n      prototype[p.name] = p.default;\n    }\n  });\n\n  props.defineModel(prototype, model);\n  props.defineDescriptor(prototype, descriptor);\n\n  var name = descriptor.ns.name;\n\n  /**\n   * The new type constructor\n   */\n  function ModdleElement(attrs) {\n    props.define(this, '$type', { value: name, enumerable: true });\n    props.define(this, '$attrs', { value: {} });\n    props.define(this, '$parent', { writable: true });\n\n    forEach(attrs, bind(function(val, key) {\n      this.set(key, val);\n    }, this));\n  }\n\n  ModdleElement.prototype = prototype;\n\n  ModdleElement.hasType = prototype.$instanceOf = this.model.hasType;\n\n  // static links\n  props.defineModel(ModdleElement, model);\n  props.defineDescriptor(ModdleElement, descriptor);\n\n  return ModdleElement;\n};\n\n/**\n * Built-in moddle types\n */\nvar BUILTINS = {\n  String: true,\n  Boolean: true,\n  Integer: true,\n  Real: true,\n  Element: true\n};\n\n/**\n * Converters for built in types from string representations\n */\nvar TYPE_CONVERTERS = {\n  String: function(s) { return s; },\n  Boolean: function(s) { return s === 'true'; },\n  Integer: function(s) { return parseInt(s, 10); },\n  Real: function(s) { return parseFloat(s); }\n};\n\n/**\n * Convert a type to its real representation\n */\nfunction coerceType(type, value) {\n\n  var converter = TYPE_CONVERTERS[type];\n\n  if (converter) {\n    return converter(value);\n  } else {\n    return value;\n  }\n}\n\n/**\n * Return whether the given type is built-in\n */\nfunction isBuiltIn(type) {\n  return !!BUILTINS[type];\n}\n\n/**\n * Return whether the given type is simple\n */\nfunction isSimple(type) {\n  return !!TYPE_CONVERTERS[type];\n}\n\n/**\n * Parses a namespaced attribute name of the form (ns:)localName to an object,\n * given a default prefix to assume in case no explicit namespace is given.\n *\n * @param {String} name\n * @param {String} [defaultPrefix] the default prefix to take, if none is present.\n *\n * @return {Object} the parsed name\n */\nfunction parseName(name, defaultPrefix) {\n  var parts = name.split(/:/),\n      localName, prefix;\n\n  // no prefix (i.e. only local name)\n  if (parts.length === 1) {\n    localName = name;\n    prefix = defaultPrefix;\n  }\n\n  // prefix + local name\n  else if (parts.length === 2) {\n    localName = parts[1];\n    prefix = parts[0];\n  }\n\n  else {\n    throw new Error('expected <prefix:localName> or <localName>, got ' + name);\n  }\n\n  name = (prefix ? prefix + ':' : '') + localName;\n\n  return {\n    name: name,\n    prefix: prefix,\n    localName: localName\n  };\n}\n\n/**\n * A utility to build element descriptors.\n */\nfunction DescriptorBuilder(nameNs) {\n  this.ns = nameNs;\n  this.name = nameNs.name;\n  this.allTypes = [];\n  this.allTypesByName = {};\n  this.properties = [];\n  this.propertiesByName = {};\n}\n\n\nDescriptorBuilder.prototype.build = function() {\n  return pick(this, [\n    'ns',\n    'name',\n    'allTypes',\n    'allTypesByName',\n    'properties',\n    'propertiesByName',\n    'bodyProperty',\n    'idProperty'\n  ]);\n};\n\n/**\n * Add property at given index.\n *\n * @param {Object} p\n * @param {Number} [idx]\n * @param {Boolean} [validate=true]\n */\nDescriptorBuilder.prototype.addProperty = function(p, idx, validate) {\n\n  if (typeof idx === 'boolean') {\n    validate = idx;\n    idx = undefined;\n  }\n\n  this.addNamedProperty(p, validate !== false);\n\n  var properties = this.properties;\n\n  if (idx !== undefined) {\n    properties.splice(idx, 0, p);\n  } else {\n    properties.push(p);\n  }\n};\n\n\nDescriptorBuilder.prototype.replaceProperty = function(oldProperty, newProperty, replace) {\n  var oldNameNs = oldProperty.ns;\n\n  var props = this.properties,\n      propertiesByName = this.propertiesByName,\n      rename = oldProperty.name !== newProperty.name;\n\n  if (oldProperty.isId) {\n    if (!newProperty.isId) {\n      throw new Error(\n        'property <' + newProperty.ns.name + '> must be id property ' +\n        'to refine <' + oldProperty.ns.name + '>');\n    }\n\n    this.setIdProperty(newProperty, false);\n  }\n\n  if (oldProperty.isBody) {\n\n    if (!newProperty.isBody) {\n      throw new Error(\n        'property <' + newProperty.ns.name + '> must be body property ' +\n        'to refine <' + oldProperty.ns.name + '>');\n    }\n\n    // TODO: Check compatibility\n    this.setBodyProperty(newProperty, false);\n  }\n\n  // validate existence and get location of old property\n  var idx = props.indexOf(oldProperty);\n  if (idx === -1) {\n    throw new Error('property <' + oldNameNs.name + '> not found in property list');\n  }\n\n  // remove old property\n  props.splice(idx, 1);\n\n  // replacing the named property is intentional\n  //\n  //  * validate only if this is a \"rename\" operation\n  //  * add at specific index unless we \"replace\"\n  //\n  this.addProperty(newProperty, replace ? undefined : idx, rename);\n\n  // make new property available under old name\n  propertiesByName[oldNameNs.name] = propertiesByName[oldNameNs.localName] = newProperty;\n};\n\n\nDescriptorBuilder.prototype.redefineProperty = function(p, targetPropertyName, replace) {\n\n  var nsPrefix = p.ns.prefix;\n  var parts = targetPropertyName.split('#');\n\n  var name = parseName(parts[0], nsPrefix);\n  var attrName = parseName(parts[1], name.prefix).name;\n\n  var redefinedProperty = this.propertiesByName[attrName];\n  if (!redefinedProperty) {\n    throw new Error('refined property <' + attrName + '> not found');\n  } else {\n    this.replaceProperty(redefinedProperty, p, replace);\n  }\n\n  delete p.redefines;\n};\n\nDescriptorBuilder.prototype.addNamedProperty = function(p, validate) {\n  var ns = p.ns,\n      propsByName = this.propertiesByName;\n\n  if (validate) {\n    this.assertNotDefined(p, ns.name);\n    this.assertNotDefined(p, ns.localName);\n  }\n\n  propsByName[ns.name] = propsByName[ns.localName] = p;\n};\n\nDescriptorBuilder.prototype.removeNamedProperty = function(p) {\n  var ns = p.ns,\n      propsByName = this.propertiesByName;\n\n  delete propsByName[ns.name];\n  delete propsByName[ns.localName];\n};\n\nDescriptorBuilder.prototype.setBodyProperty = function(p, validate) {\n\n  if (validate && this.bodyProperty) {\n    throw new Error(\n      'body property defined multiple times ' +\n      '(<' + this.bodyProperty.ns.name + '>, <' + p.ns.name + '>)');\n  }\n\n  this.bodyProperty = p;\n};\n\nDescriptorBuilder.prototype.setIdProperty = function(p, validate) {\n\n  if (validate && this.idProperty) {\n    throw new Error(\n      'id property defined multiple times ' +\n      '(<' + this.idProperty.ns.name + '>, <' + p.ns.name + '>)');\n  }\n\n  this.idProperty = p;\n};\n\nDescriptorBuilder.prototype.assertNotTrait = function(typeDescriptor) {\n\n  const _extends = typeDescriptor.extends || [];\n\n  if (_extends.length) {\n    throw new Error(\n      `cannot create <${ typeDescriptor.name }> extending <${ typeDescriptor.extends }>`\n    );\n  }\n};\n\nDescriptorBuilder.prototype.assertNotDefined = function(p, name) {\n  var propertyName = p.name,\n      definedProperty = this.propertiesByName[propertyName];\n\n  if (definedProperty) {\n    throw new Error(\n      'property <' + propertyName + '> already defined; ' +\n      'override of <' + definedProperty.definedBy.ns.name + '#' + definedProperty.ns.name + '> by ' +\n      '<' + p.definedBy.ns.name + '#' + p.ns.name + '> not allowed without redefines');\n  }\n};\n\nDescriptorBuilder.prototype.hasProperty = function(name) {\n  return this.propertiesByName[name];\n};\n\nDescriptorBuilder.prototype.addTrait = function(t, inherited) {\n\n  if (inherited) {\n    this.assertNotTrait(t);\n  }\n\n  var typesByName = this.allTypesByName,\n      types = this.allTypes;\n\n  var typeName = t.name;\n\n  if (typeName in typesByName) {\n    return;\n  }\n\n  forEach(t.properties, bind(function(p) {\n\n    // clone property to allow extensions\n    p = assign({}, p, {\n      name: p.ns.localName,\n      inherited: inherited\n    });\n\n    Object.defineProperty(p, 'definedBy', {\n      value: t\n    });\n\n    var replaces = p.replaces,\n        redefines = p.redefines;\n\n    // add replace/redefine support\n    if (replaces || redefines) {\n      this.redefineProperty(p, replaces || redefines, replaces);\n    } else {\n      if (p.isBody) {\n        this.setBodyProperty(p);\n      }\n      if (p.isId) {\n        this.setIdProperty(p);\n      }\n      this.addProperty(p);\n    }\n  }, this));\n\n  types.push(t);\n  typesByName[typeName] = t;\n};\n\n/**\n * A registry of Moddle packages.\n *\n * @param {Array<Package>} packages\n * @param {Properties} properties\n */\nfunction Registry(packages, properties) {\n  this.packageMap = {};\n  this.typeMap = {};\n\n  this.packages = [];\n\n  this.properties = properties;\n\n  forEach(packages, bind(this.registerPackage, this));\n}\n\n\nRegistry.prototype.getPackage = function(uriOrPrefix) {\n  return this.packageMap[uriOrPrefix];\n};\n\nRegistry.prototype.getPackages = function() {\n  return this.packages;\n};\n\n\nRegistry.prototype.registerPackage = function(pkg) {\n\n  // copy package\n  pkg = assign({}, pkg);\n\n  var pkgMap = this.packageMap;\n\n  ensureAvailable(pkgMap, pkg, 'prefix');\n  ensureAvailable(pkgMap, pkg, 'uri');\n\n  // register types\n  forEach(pkg.types, bind(function(descriptor) {\n    this.registerType(descriptor, pkg);\n  }, this));\n\n  pkgMap[pkg.uri] = pkgMap[pkg.prefix] = pkg;\n  this.packages.push(pkg);\n};\n\n\n/**\n * Register a type from a specific package with us\n */\nRegistry.prototype.registerType = function(type, pkg) {\n\n  type = assign({}, type, {\n    superClass: (type.superClass || []).slice(),\n    extends: (type.extends || []).slice(),\n    properties: (type.properties || []).slice(),\n    meta: assign((type.meta || {}))\n  });\n\n  var ns = parseName(type.name, pkg.prefix),\n      name = ns.name,\n      propertiesByName = {};\n\n  // parse properties\n  forEach(type.properties, bind(function(p) {\n\n    // namespace property names\n    var propertyNs = parseName(p.name, ns.prefix),\n        propertyName = propertyNs.name;\n\n    // namespace property types\n    if (!isBuiltIn(p.type)) {\n      p.type = parseName(p.type, propertyNs.prefix).name;\n    }\n\n    assign(p, {\n      ns: propertyNs,\n      name: propertyName\n    });\n\n    propertiesByName[propertyName] = p;\n  }, this));\n\n  // update ns + name\n  assign(type, {\n    ns: ns,\n    name: name,\n    propertiesByName: propertiesByName\n  });\n\n  forEach(type.extends, bind(function(extendsName) {\n    var extendsNameNs = parseName(extendsName, ns.prefix);\n\n    var extended = this.typeMap[extendsNameNs.name];\n\n    extended.traits = extended.traits || [];\n    extended.traits.push(name);\n  }, this));\n\n  // link to package\n  this.definePackage(type, pkg);\n\n  // register\n  this.typeMap[name] = type;\n};\n\n\n/**\n * Traverse the type hierarchy from bottom to top,\n * calling iterator with (type, inherited) for all elements in\n * the inheritance chain.\n *\n * @param {Object} nsName\n * @param {Function} iterator\n * @param {Boolean} [trait=false]\n */\nRegistry.prototype.mapTypes = function(nsName, iterator, trait) {\n\n  var type = isBuiltIn(nsName.name) ? { name: nsName.name } : this.typeMap[nsName.name];\n\n  var self = this;\n\n  /**\n   * Traverse the selected super type or trait\n   *\n   * @param {String} cls\n   * @param {Boolean} [trait=false]\n   */\n  function traverse(cls, trait) {\n    var parentNs = parseName(cls, isBuiltIn(cls) ? '' : nsName.prefix);\n    self.mapTypes(parentNs, iterator, trait);\n  }\n\n  /**\n   * Traverse the selected trait.\n   *\n   * @param {String} cls\n   */\n  function traverseTrait(cls) {\n    return traverse(cls, true);\n  }\n\n  /**\n   * Traverse the selected super type\n   *\n   * @param {String} cls\n   */\n  function traverseSuper(cls) {\n    return traverse(cls, false);\n  }\n\n  if (!type) {\n    throw new Error('unknown type <' + nsName.name + '>');\n  }\n\n  forEach(type.superClass, trait ? traverseTrait : traverseSuper);\n\n  // call iterator with (type, inherited=!trait)\n  iterator(type, !trait);\n\n  forEach(type.traits, traverseTrait);\n};\n\n\n/**\n * Returns the effective descriptor for a type.\n *\n * @param  {String} type the namespaced name (ns:localName) of the type\n *\n * @return {Descriptor} the resulting effective descriptor\n */\nRegistry.prototype.getEffectiveDescriptor = function(name) {\n\n  var nsName = parseName(name);\n\n  var builder = new DescriptorBuilder(nsName);\n\n  this.mapTypes(nsName, function(type, inherited) {\n    builder.addTrait(type, inherited);\n  });\n\n  var descriptor = builder.build();\n\n  // define package link\n  this.definePackage(descriptor, descriptor.allTypes[descriptor.allTypes.length - 1].$pkg);\n\n  return descriptor;\n};\n\n\nRegistry.prototype.definePackage = function(target, pkg) {\n  this.properties.define(target, '$pkg', { value: pkg });\n};\n\n\n\n// helpers ////////////////////////////\n\nfunction ensureAvailable(packageMap, pkg, identifierKey) {\n\n  var value = pkg[identifierKey];\n\n  if (value in packageMap) {\n    throw new Error('package with ' + identifierKey + ' <' + value + '> already defined');\n  }\n}\n\n/**\n * A utility that gets and sets properties of model elements.\n *\n * @param {Model} model\n */\nfunction Properties(model) {\n  this.model = model;\n}\n\n\n/**\n * Sets a named property on the target element.\n * If the value is undefined, the property gets deleted.\n *\n * @param {Object} target\n * @param {String} name\n * @param {Object} value\n */\nProperties.prototype.set = function(target, name, value) {\n\n  if (!isString(name) || !name.length) {\n    throw new TypeError('property name must be a non-empty string');\n  }\n\n  var property = this.getProperty(target, name);\n\n  var propertyName = property && property.name;\n\n  if (isUndefined(value)) {\n\n    // unset the property, if the specified value is undefined;\n    // delete from $attrs (for extensions) or the target itself\n    if (property) {\n      delete target[propertyName];\n    } else {\n      delete target.$attrs[stripGlobal(name)];\n    }\n  } else {\n\n    // set the property, defining well defined properties on the fly\n    // or simply updating them in target.$attrs (for extensions)\n    if (property) {\n      if (propertyName in target) {\n        target[propertyName] = value;\n      } else {\n        defineProperty(target, property, value);\n      }\n    } else {\n      target.$attrs[stripGlobal(name)] = value;\n    }\n  }\n};\n\n/**\n * Returns the named property of the given element\n *\n * @param  {Object} target\n * @param  {String} name\n *\n * @return {Object}\n */\nProperties.prototype.get = function(target, name) {\n\n  var property = this.getProperty(target, name);\n\n  if (!property) {\n    return target.$attrs[stripGlobal(name)];\n  }\n\n  var propertyName = property.name;\n\n  // check if access to collection property and lazily initialize it\n  if (!target[propertyName] && property.isMany) {\n    defineProperty(target, property, []);\n  }\n\n  return target[propertyName];\n};\n\n\n/**\n * Define a property on the target element\n *\n * @param  {Object} target\n * @param  {String} name\n * @param  {Object} options\n */\nProperties.prototype.define = function(target, name, options) {\n\n  if (!options.writable) {\n\n    var value = options.value;\n\n    // use getters for read-only variables to support ES6 proxies\n    // cf. https://github.com/bpmn-io/internal-docs/issues/386\n    options = assign({}, options, {\n      get: function() { return value; }\n    });\n\n    delete options.value;\n  }\n\n  Object.defineProperty(target, name, options);\n};\n\n\n/**\n * Define the descriptor for an element\n */\nProperties.prototype.defineDescriptor = function(target, descriptor) {\n  this.define(target, '$descriptor', { value: descriptor });\n};\n\n/**\n * Define the model for an element\n */\nProperties.prototype.defineModel = function(target, model) {\n  this.define(target, '$model', { value: model });\n};\n\n/**\n * Return property with the given name on the element.\n *\n * @param {any} target\n * @param {string} name\n *\n * @return {object | null} property\n */\nProperties.prototype.getProperty = function(target, name) {\n\n  var model = this.model;\n\n  var property = model.getPropertyDescriptor(target, name);\n\n  if (property) {\n    return property;\n  }\n\n  if (name.includes(':')) {\n    return null;\n  }\n\n  const strict = model.config.strict;\n\n  if (typeof strict !== 'undefined') {\n    const error = new TypeError(`unknown property <${ name }> on <${ target.$type }>`);\n\n    if (strict) {\n      throw error;\n    } else {\n\n      // eslint-disable-next-line no-undef\n      typeof console !== 'undefined' && console.warn(error);\n    }\n  }\n\n  return null;\n};\n\nfunction isUndefined(val) {\n  return typeof val === 'undefined';\n}\n\nfunction defineProperty(target, property, value) {\n  Object.defineProperty(target, property.name, {\n    enumerable: !property.isReference,\n    writable: true,\n    value: value,\n    configurable: true\n  });\n}\n\nfunction stripGlobal(name) {\n  return name.replace(/^:/, '');\n}\n\n// Moddle implementation /////////////////////////////////////////////////\n\n/**\n * @class Moddle\n *\n * A model that can be used to create elements of a specific type.\n *\n * @example\n *\n * var Moddle = require('moddle');\n *\n * var pkg = {\n *   name: 'mypackage',\n *   prefix: 'my',\n *   types: [\n *     { name: 'Root' }\n *   ]\n * };\n *\n * var moddle = new Moddle([pkg]);\n *\n * @param {Array<Package>} packages the packages to contain\n *\n * @param { { strict?: boolean } } [config] moddle configuration\n */\nfunction Moddle(packages, config = {}) {\n\n  this.properties = new Properties(this);\n\n  this.factory = new Factory(this, this.properties);\n  this.registry = new Registry(packages, this.properties);\n\n  this.typeCache = {};\n\n  this.config = config;\n}\n\n\n/**\n * Create an instance of the specified type.\n *\n * @method Moddle#create\n *\n * @example\n *\n * var foo = moddle.create('my:Foo');\n * var bar = moddle.create('my:Bar', { id: 'BAR_1' });\n *\n * @param  {String|Object} descriptor the type descriptor or name know to the model\n * @param  {Object} attrs   a number of attributes to initialize the model instance with\n * @return {Object}         model instance\n */\nModdle.prototype.create = function(descriptor, attrs) {\n  var Type = this.getType(descriptor);\n\n  if (!Type) {\n    throw new Error('unknown type <' + descriptor + '>');\n  }\n\n  return new Type(attrs);\n};\n\n\n/**\n * Returns the type representing a given descriptor\n *\n * @method Moddle#getType\n *\n * @example\n *\n * var Foo = moddle.getType('my:Foo');\n * var foo = new Foo({ 'id' : 'FOO_1' });\n *\n * @param  {String|Object} descriptor the type descriptor or name know to the model\n * @return {Object}         the type representing the descriptor\n */\nModdle.prototype.getType = function(descriptor) {\n\n  var cache = this.typeCache;\n\n  var name = isString(descriptor) ? descriptor : descriptor.ns.name;\n\n  var type = cache[name];\n\n  if (!type) {\n    descriptor = this.registry.getEffectiveDescriptor(name);\n    type = cache[name] = this.factory.createType(descriptor);\n  }\n\n  return type;\n};\n\n\n/**\n * Creates an any-element type to be used within model instances.\n *\n * This can be used to create custom elements that lie outside the meta-model.\n * The created element contains all the meta-data required to serialize it\n * as part of meta-model elements.\n *\n * @method Moddle#createAny\n *\n * @example\n *\n * var foo = moddle.createAny('vendor:Foo', 'http://vendor', {\n *   value: 'bar'\n * });\n *\n * var container = moddle.create('my:Container', 'http://my', {\n *   any: [ foo ]\n * });\n *\n * // go ahead and serialize the stuff\n *\n *\n * @param  {String} name  the name of the element\n * @param  {String} nsUri the namespace uri of the element\n * @param  {Object} [properties] a map of properties to initialize the instance with\n * @return {Object} the any type instance\n */\nModdle.prototype.createAny = function(name, nsUri, properties) {\n\n  var nameNs = parseName(name);\n\n  var element = {\n    $type: name,\n    $instanceOf: function(type) {\n      return type === this.$type;\n    },\n    get: function(key) {\n      return this[key];\n    },\n    set: function(key, value) {\n      set(this, [ key ], value);\n    }\n  };\n\n  var descriptor = {\n    name: name,\n    isGeneric: true,\n    ns: {\n      prefix: nameNs.prefix,\n      localName: nameNs.localName,\n      uri: nsUri\n    }\n  };\n\n  this.properties.defineDescriptor(element, descriptor);\n  this.properties.defineModel(element, this);\n  this.properties.define(element, 'get', { enumerable: false, writable: true });\n  this.properties.define(element, 'set', { enumerable: false, writable: true });\n  this.properties.define(element, '$parent', { enumerable: false, writable: true });\n  this.properties.define(element, '$instanceOf', { enumerable: false, writable: true });\n\n  forEach(properties, function(a, key) {\n    if (isObject(a) && a.value !== undefined) {\n      element[a.name] = a.value;\n    } else {\n      element[key] = a;\n    }\n  });\n\n  return element;\n};\n\n/**\n * Returns a registered package by uri or prefix\n *\n * @return {Object} the package\n */\nModdle.prototype.getPackage = function(uriOrPrefix) {\n  return this.registry.getPackage(uriOrPrefix);\n};\n\n/**\n * Returns a snapshot of all known packages\n *\n * @return {Object} the package\n */\nModdle.prototype.getPackages = function() {\n  return this.registry.getPackages();\n};\n\n/**\n * Returns the descriptor for an element\n */\nModdle.prototype.getElementDescriptor = function(element) {\n  return element.$descriptor;\n};\n\n/**\n * Returns true if the given descriptor or instance\n * represents the given type.\n *\n * May be applied to this, if element is omitted.\n */\nModdle.prototype.hasType = function(element, type) {\n  if (type === undefined) {\n    type = element;\n    element = this;\n  }\n\n  var descriptor = element.$model.getElementDescriptor(element);\n\n  return (type in descriptor.allTypesByName);\n};\n\n/**\n * Returns the descriptor of an elements named property\n */\nModdle.prototype.getPropertyDescriptor = function(element, property) {\n  return this.getElementDescriptor(element).propertiesByName[property];\n};\n\n/**\n * Returns a mapped type's descriptor\n */\nModdle.prototype.getTypeDescriptor = function(type) {\n  return this.registry.typeMap[type];\n};\n\nexport { Moddle, coerceType, isBuiltIn as isBuiltInType, isSimple as isSimpleType, parseName as parseNameNS };\n//# sourceMappingURL=index.js.map\n","var fromCharCode = String.fromCharCode;\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nvar ENTITY_PATTERN = /&#(\\d+);|&#x([0-9a-f]+);|&(\\w+);/ig;\n\nvar ENTITY_MAPPING = {\n  'amp': '&',\n  'apos': '\\'',\n  'gt': '>',\n  'lt': '<',\n  'quot': '\"'\n};\n\n// map UPPERCASE variants of supported special chars\nObject.keys(ENTITY_MAPPING).forEach(function(k) {\n  ENTITY_MAPPING[k.toUpperCase()] = ENTITY_MAPPING[k];\n});\n\n\nfunction replaceEntities(_, d, x, z) {\n\n  // reserved names, i.e. &nbsp;\n  if (z) {\n    if (hasOwnProperty.call(ENTITY_MAPPING, z)) {\n      return ENTITY_MAPPING[z];\n    } else {\n\n      // fall back to original value\n      return '&' + z + ';';\n    }\n  }\n\n  // decimal encoded char\n  if (d) {\n    return fromCharCode(d);\n  }\n\n  // hex encoded char\n  return fromCharCode(parseInt(x, 16));\n}\n\n\n/**\n * A basic entity decoder that can decode a minimal\n * sub-set of reserved names (&amp;) as well as\n * hex (&#xaaf;) and decimal (&#1231;) encoded characters.\n *\n * @param {string} s\n *\n * @return {string} decoded string\n */\nfunction decodeEntities(s) {\n  if (s.length > 3 && s.indexOf('&') !== -1) {\n    return s.replace(ENTITY_PATTERN, replaceEntities);\n  }\n\n  return s;\n}\n\nvar NON_WHITESPACE_OUTSIDE_ROOT_NODE = 'non-whitespace outside of root node';\n\nfunction error(msg) {\n  return new Error(msg);\n}\n\nfunction missingNamespaceForPrefix(prefix) {\n  return 'missing namespace for prefix <' + prefix + '>';\n}\n\nfunction getter(getFn) {\n  return {\n    'get': getFn,\n    'enumerable': true\n  };\n}\n\nfunction cloneNsMatrix(nsMatrix) {\n  var clone = {}, key;\n  for (key in nsMatrix) {\n    clone[key] = nsMatrix[key];\n  }\n  return clone;\n}\n\nfunction uriPrefix(prefix) {\n  return prefix + '$uri';\n}\n\nfunction buildNsMatrix(nsUriToPrefix) {\n  var nsMatrix = {},\n      uri,\n      prefix;\n\n  for (uri in nsUriToPrefix) {\n    prefix = nsUriToPrefix[uri];\n    nsMatrix[prefix] = prefix;\n    nsMatrix[uriPrefix(prefix)] = uri;\n  }\n\n  return nsMatrix;\n}\n\nfunction noopGetContext() {\n  return { line: 0, column: 0 };\n}\n\nfunction throwFunc(err) {\n  throw err;\n}\n\n/**\n * Creates a new parser with the given options.\n *\n * @constructor\n *\n * @param  {!Object<string, ?>=} options\n */\nfunction Parser(options) {\n\n  if (!this) {\n    return new Parser(options);\n  }\n\n  var proxy = options && options['proxy'];\n\n  var onText,\n      onOpenTag,\n      onCloseTag,\n      onCDATA,\n      onError = throwFunc,\n      onWarning,\n      onComment,\n      onQuestion,\n      onAttention;\n\n  var getContext = noopGetContext;\n\n  /**\n   * Do we need to parse the current elements attributes for namespaces?\n   *\n   * @type {boolean}\n   */\n  var maybeNS = false;\n\n  /**\n   * Do we process namespaces at all?\n   *\n   * @type {boolean}\n   */\n  var isNamespace = false;\n\n  /**\n   * The caught error returned on parse end\n   *\n   * @type {Error}\n   */\n  var returnError = null;\n\n  /**\n   * Should we stop parsing?\n   *\n   * @type {boolean}\n   */\n  var parseStop = false;\n\n  /**\n   * A map of { uri: prefix } used by the parser.\n   *\n   * This map will ensure we can normalize prefixes during processing;\n   * for each uri, only one prefix will be exposed to the handlers.\n   *\n   * @type {!Object<string, string>}}\n   */\n  var nsUriToPrefix;\n\n  /**\n   * Handle parse error.\n   *\n   * @param  {string|Error} err\n   */\n  function handleError(err) {\n    if (!(err instanceof Error)) {\n      err = error(err);\n    }\n\n    returnError = err;\n\n    onError(err, getContext);\n  }\n\n  /**\n   * Handle parse error.\n   *\n   * @param  {string|Error} err\n   */\n  function handleWarning(err) {\n\n    if (!onWarning) {\n      return;\n    }\n\n    if (!(err instanceof Error)) {\n      err = error(err);\n    }\n\n    onWarning(err, getContext);\n  }\n\n  /**\n   * Register parse listener.\n   *\n   * @param  {string}   name\n   * @param  {Function} cb\n   *\n   * @return {Parser}\n   */\n  this['on'] = function(name, cb) {\n\n    if (typeof cb !== 'function') {\n      throw error('required args <name, cb>');\n    }\n\n    switch (name) {\n    case 'openTag': onOpenTag = cb; break;\n    case 'text': onText = cb; break;\n    case 'closeTag': onCloseTag = cb; break;\n    case 'error': onError = cb; break;\n    case 'warn': onWarning = cb; break;\n    case 'cdata': onCDATA = cb; break;\n    case 'attention': onAttention = cb; break; // <!XXXXX zzzz=\"eeee\">\n    case 'question': onQuestion = cb; break; // <? ....  ?>\n    case 'comment': onComment = cb; break;\n    default:\n      throw error('unsupported event: ' + name);\n    }\n\n    return this;\n  };\n\n  /**\n   * Set the namespace to prefix mapping.\n   *\n   * @example\n   *\n   * parser.ns({\n   *   'http://foo': 'foo',\n   *   'http://bar': 'bar'\n   * });\n   *\n   * @param  {!Object<string, string>} nsMap\n   *\n   * @return {Parser}\n   */\n  this['ns'] = function(nsMap) {\n\n    if (typeof nsMap === 'undefined') {\n      nsMap = {};\n    }\n\n    if (typeof nsMap !== 'object') {\n      throw error('required args <nsMap={}>');\n    }\n\n    var _nsUriToPrefix = {}, k;\n\n    for (k in nsMap) {\n      _nsUriToPrefix[k] = nsMap[k];\n    }\n\n    isNamespace = true;\n    nsUriToPrefix = _nsUriToPrefix;\n\n    return this;\n  };\n\n  /**\n   * Parse xml string.\n   *\n   * @param  {string} xml\n   *\n   * @return {Error} returnError, if not thrown\n   */\n  this['parse'] = function(xml) {\n    if (typeof xml !== 'string') {\n      throw error('required args <xml=string>');\n    }\n\n    returnError = null;\n\n    parse(xml);\n\n    getContext = noopGetContext;\n    parseStop = false;\n\n    return returnError;\n  };\n\n  /**\n   * Stop parsing.\n   */\n  this['stop'] = function() {\n    parseStop = true;\n  };\n\n  /**\n   * Parse string, invoking configured listeners on element.\n   *\n   * @param  {string} xml\n   */\n  function parse(xml) {\n    var nsMatrixStack = isNamespace ? [] : null,\n        nsMatrix = isNamespace ? buildNsMatrix(nsUriToPrefix) : null,\n        _nsMatrix,\n        nodeStack = [],\n        anonymousNsCount = 0,\n        tagStart = false,\n        tagEnd = false,\n        i = 0, j = 0,\n        x, y, q, w, v,\n        xmlns,\n        elementName,\n        _elementName,\n        elementProxy\n        ;\n\n    var attrsString = '',\n        attrsStart = 0,\n        cachedAttrs // false = parsed with errors, null = needs parsing\n        ;\n\n    /**\n     * Parse attributes on demand and returns the parsed attributes.\n     *\n     * Return semantics: (1) `false` on attribute parse error,\n     * (2) object hash on extracted attrs.\n     *\n     * @return {boolean|Object}\n     */\n    function getAttrs() {\n      if (cachedAttrs !== null) {\n        return cachedAttrs;\n      }\n\n      var nsUri,\n          nsUriPrefix,\n          nsName,\n          defaultAlias = isNamespace && nsMatrix['xmlns'],\n          attrList = isNamespace && maybeNS ? [] : null,\n          i = attrsStart,\n          s = attrsString,\n          l = s.length,\n          hasNewMatrix,\n          newalias,\n          value,\n          alias,\n          name,\n          attrs = {},\n          seenAttrs = {},\n          skipAttr,\n          w,\n          j;\n\n      parseAttr:\n      for (; i < l; i++) {\n        skipAttr = false;\n        w = s.charCodeAt(i);\n\n        if (w === 32 || (w < 14 && w > 8)) { // WHITESPACE={ \\f\\n\\r\\t\\v}\n          continue;\n        }\n\n        // wait for non whitespace character\n        if (w < 65 || w > 122 || (w > 90 && w < 97)) {\n          if (w !== 95 && w !== 58) { // char 95\"_\" 58\":\"\n            handleWarning('illegal first char attribute name');\n            skipAttr = true;\n          }\n        }\n\n        // parse attribute name\n        for (j = i + 1; j < l; j++) {\n          w = s.charCodeAt(j);\n\n          if (\n            w > 96 && w < 123 ||\n            w > 64 && w < 91 ||\n            w > 47 && w < 59 ||\n            w === 46 || // '.'\n            w === 45 || // '-'\n            w === 95 // '_'\n          ) {\n            continue;\n          }\n\n          // unexpected whitespace\n          if (w === 32 || (w < 14 && w > 8)) { // WHITESPACE\n            handleWarning('missing attribute value');\n            i = j;\n\n            continue parseAttr;\n          }\n\n          // expected \"=\"\n          if (w === 61) { // \"=\" == 61\n            break;\n          }\n\n          handleWarning('illegal attribute name char');\n          skipAttr = true;\n        }\n\n        name = s.substring(i, j);\n\n        if (name === 'xmlns:xmlns') {\n          handleWarning('illegal declaration of xmlns');\n          skipAttr = true;\n        }\n\n        w = s.charCodeAt(j + 1);\n\n        if (w === 34) { // '\"'\n          j = s.indexOf('\"', i = j + 2);\n\n          if (j === -1) {\n            j = s.indexOf('\\'', i);\n\n            if (j !== -1) {\n              handleWarning('attribute value quote missmatch');\n              skipAttr = true;\n            }\n          }\n\n        } else if (w === 39) { // \"'\"\n          j = s.indexOf('\\'', i = j + 2);\n\n          if (j === -1) {\n            j = s.indexOf('\"', i);\n\n            if (j !== -1) {\n              handleWarning('attribute value quote missmatch');\n              skipAttr = true;\n            }\n          }\n\n        } else {\n          handleWarning('missing attribute value quotes');\n          skipAttr = true;\n\n          // skip to next space\n          for (j = j + 1; j < l; j++) {\n            w = s.charCodeAt(j + 1);\n\n            if (w === 32 || (w < 14 && w > 8)) { // WHITESPACE\n              break;\n            }\n          }\n\n        }\n\n        if (j === -1) {\n          handleWarning('missing closing quotes');\n\n          j = l;\n          skipAttr = true;\n        }\n\n        if (!skipAttr) {\n          value = s.substring(i, j);\n        }\n\n        i = j;\n\n        // ensure SPACE follows attribute\n        // skip illegal content otherwise\n        // example a=\"b\"c\n        for (; j + 1 < l; j++) {\n          w = s.charCodeAt(j + 1);\n\n          if (w === 32 || (w < 14 && w > 8)) { // WHITESPACE\n            break;\n          }\n\n          // FIRST ILLEGAL CHAR\n          if (i === j) {\n            handleWarning('illegal character after attribute end');\n            skipAttr = true;\n          }\n        }\n\n        // advance cursor to next attribute\n        i = j + 1;\n\n        if (skipAttr) {\n          continue parseAttr;\n        }\n\n        // check attribute re-declaration\n        if (name in seenAttrs) {\n          handleWarning('attribute <' + name + '> already defined');\n          continue;\n        }\n\n        seenAttrs[name] = true;\n\n        if (!isNamespace) {\n          attrs[name] = value;\n          continue;\n        }\n\n        // try to extract namespace information\n        if (maybeNS) {\n          newalias = (\n            name === 'xmlns'\n              ? 'xmlns'\n              : (name.charCodeAt(0) === 120 && name.substr(0, 6) === 'xmlns:')\n                ? name.substr(6)\n                : null\n          );\n\n          // handle xmlns(:alias) assignment\n          if (newalias !== null) {\n            nsUri = decodeEntities(value);\n            nsUriPrefix = uriPrefix(newalias);\n\n            alias = nsUriToPrefix[nsUri];\n\n            if (!alias) {\n\n              // no prefix defined or prefix collision\n              if (\n                (newalias === 'xmlns') ||\n                (nsUriPrefix in nsMatrix && nsMatrix[nsUriPrefix] !== nsUri)\n              ) {\n\n                // alocate free ns prefix\n                do {\n                  alias = 'ns' + (anonymousNsCount++);\n                } while (typeof nsMatrix[alias] !== 'undefined');\n              } else {\n                alias = newalias;\n              }\n\n              nsUriToPrefix[nsUri] = alias;\n            }\n\n            if (nsMatrix[newalias] !== alias) {\n              if (!hasNewMatrix) {\n                nsMatrix = cloneNsMatrix(nsMatrix);\n                hasNewMatrix = true;\n              }\n\n              nsMatrix[newalias] = alias;\n              if (newalias === 'xmlns') {\n                nsMatrix[uriPrefix(alias)] = nsUri;\n                defaultAlias = alias;\n              }\n\n              nsMatrix[nsUriPrefix] = nsUri;\n            }\n\n            // expose xmlns(:asd)=\"...\" in attributes\n            attrs[name] = value;\n            continue;\n          }\n\n          // collect attributes until all namespace\n          // declarations are processed\n          attrList.push(name, value);\n          continue;\n\n        } /** end if (maybeNs) */\n\n        // handle attributes on element without\n        // namespace declarations\n        w = name.indexOf(':');\n        if (w === -1) {\n          attrs[name] = value;\n          continue;\n        }\n\n        // normalize ns attribute name\n        if (!(nsName = nsMatrix[name.substring(0, w)])) {\n          handleWarning(missingNamespaceForPrefix(name.substring(0, w)));\n          continue;\n        }\n\n        name = defaultAlias === nsName\n          ? name.substr(w + 1)\n          : nsName + name.substr(w);\n\n        // end: normalize ns attribute name\n\n        attrs[name] = value;\n      }\n\n\n      // handle deferred, possibly namespaced attributes\n      if (maybeNS) {\n\n        // normalize captured attributes\n        for (i = 0, l = attrList.length; i < l; i++) {\n\n          name = attrList[i++];\n          value = attrList[i];\n\n          w = name.indexOf(':');\n\n          if (w !== -1) {\n\n            // normalize ns attribute name\n            if (!(nsName = nsMatrix[name.substring(0, w)])) {\n              handleWarning(missingNamespaceForPrefix(name.substring(0, w)));\n              continue;\n            }\n\n            name = defaultAlias === nsName\n              ? name.substr(w + 1)\n              : nsName + name.substr(w);\n\n            // end: normalize ns attribute name\n          }\n\n          attrs[name] = value;\n        }\n\n        // end: normalize captured attributes\n      }\n\n      return cachedAttrs = attrs;\n    }\n\n    /**\n     * Extract the parse context { line, column, part }\n     * from the current parser position.\n     *\n     * @return {Object} parse context\n     */\n    function getParseContext() {\n      var splitsRe = /(\\r\\n|\\r|\\n)/g;\n\n      var line = 0;\n      var column = 0;\n      var startOfLine = 0;\n      var endOfLine = j;\n      var match;\n      var data;\n\n      while (i >= startOfLine) {\n\n        match = splitsRe.exec(xml);\n\n        if (!match) {\n          break;\n        }\n\n        // end of line = (break idx + break chars)\n        endOfLine = match[0].length + match.index;\n\n        if (endOfLine > i) {\n          break;\n        }\n\n        // advance to next line\n        line += 1;\n\n        startOfLine = endOfLine;\n      }\n\n      // EOF errors\n      if (i == -1) {\n        column = endOfLine;\n        data = xml.substring(j);\n      } else\n\n      // start errors\n      if (j === 0) {\n        data = xml.substring(j, i);\n      }\n\n      // other errors\n      else {\n        column = i - startOfLine;\n        data = (j == -1 ? xml.substring(i) : xml.substring(i, j + 1));\n      }\n\n      return {\n        'data': data,\n        'line': line,\n        'column': column\n      };\n    }\n\n    getContext = getParseContext;\n\n\n    if (proxy) {\n      elementProxy = Object.create({}, {\n        'name': getter(function() {\n          return elementName;\n        }),\n        'originalName': getter(function() {\n          return _elementName;\n        }),\n        'attrs': getter(getAttrs),\n        'ns': getter(function() {\n          return nsMatrix;\n        })\n      });\n    }\n\n    // actual parse logic\n    while (j !== -1) {\n\n      if (xml.charCodeAt(j) === 60) { // \"<\"\n        i = j;\n      } else {\n        i = xml.indexOf('<', j);\n      }\n\n      // parse end\n      if (i === -1) {\n        if (nodeStack.length) {\n          return handleError('unexpected end of file');\n        }\n\n        if (j === 0) {\n          return handleError('missing start tag');\n        }\n\n        if (j < xml.length) {\n          if (xml.substring(j).trim()) {\n            handleWarning(NON_WHITESPACE_OUTSIDE_ROOT_NODE);\n          }\n        }\n\n        return;\n      }\n\n      // parse text\n      if (j !== i) {\n\n        if (nodeStack.length) {\n          if (onText) {\n            onText(xml.substring(j, i), decodeEntities, getContext);\n\n            if (parseStop) {\n              return;\n            }\n          }\n        } else {\n          if (xml.substring(j, i).trim()) {\n            handleWarning(NON_WHITESPACE_OUTSIDE_ROOT_NODE);\n\n            if (parseStop) {\n              return;\n            }\n          }\n        }\n      }\n\n      w = xml.charCodeAt(i + 1);\n\n      // parse comments + CDATA\n      if (w === 33) { // \"!\"\n        q = xml.charCodeAt(i + 2);\n\n        // CDATA section\n        if (q === 91 && xml.substr(i + 3, 6) === 'CDATA[') { // 91 == \"[\"\n          j = xml.indexOf(']]>', i);\n          if (j === -1) {\n            return handleError('unclosed cdata');\n          }\n\n          if (onCDATA) {\n            onCDATA(xml.substring(i + 9, j), getContext);\n            if (parseStop) {\n              return;\n            }\n          }\n\n          j += 3;\n          continue;\n        }\n\n        // comment\n        if (q === 45 && xml.charCodeAt(i + 3) === 45) { // 45 == \"-\"\n          j = xml.indexOf('-->', i);\n          if (j === -1) {\n            return handleError('unclosed comment');\n          }\n\n\n          if (onComment) {\n            onComment(xml.substring(i + 4, j), decodeEntities, getContext);\n            if (parseStop) {\n              return;\n            }\n          }\n\n          j += 3;\n          continue;\n        }\n      }\n\n      // parse question <? ... ?>\n      if (w === 63) { // \"?\"\n        j = xml.indexOf('?>', i);\n        if (j === -1) {\n          return handleError('unclosed question');\n        }\n\n        if (onQuestion) {\n          onQuestion(xml.substring(i, j + 2), getContext);\n          if (parseStop) {\n            return;\n          }\n        }\n\n        j += 2;\n        continue;\n      }\n\n      // find matching closing tag for attention or standard tags\n      // for that we must skip through attribute values\n      // (enclosed in single or double quotes)\n      for (x = i + 1; ; x++) {\n        v = xml.charCodeAt(x);\n        if (isNaN(v)) {\n          j = -1;\n          return handleError('unclosed tag');\n        }\n\n        // [10] AttValue ::= '\"' ([^<&\"] | Reference)* '\"' | \"'\" ([^<&'] | Reference)* \"'\"\n        // skips the quoted string\n        // (double quotes) does not appear in a literal enclosed by (double quotes)\n        // (single quote) does not appear in a literal enclosed by (single quote)\n        if (v === 34) { //  '\"'\n          q = xml.indexOf('\"', x + 1);\n          x = q !== -1 ? q : x;\n        } else if (v === 39) { // \"'\"\n          q = xml.indexOf(\"'\", x + 1);\n          x = q !== -1 ? q : x;\n        } else if (v === 62) { // '>'\n          j = x;\n          break;\n        }\n      }\n\n\n      // parse attention <! ...>\n      // previously comment and CDATA have already been parsed\n      if (w === 33) { // \"!\"\n\n        if (onAttention) {\n          onAttention(xml.substring(i, j + 1), decodeEntities, getContext);\n          if (parseStop) {\n            return;\n          }\n        }\n\n        j += 1;\n        continue;\n      }\n\n      // don't process attributes;\n      // there are none\n      cachedAttrs = {};\n\n      // if (xml.charCodeAt(i+1) === 47) { // </...\n      if (w === 47) { // </...\n        tagStart = false;\n        tagEnd = true;\n\n        if (!nodeStack.length) {\n          return handleError('missing open tag');\n        }\n\n        // verify open <-> close tag match\n        x = elementName = nodeStack.pop();\n        q = i + 2 + x.length;\n\n        if (xml.substring(i + 2, q) !== x) {\n          return handleError('closing tag mismatch');\n        }\n\n        // verify chars in close tag\n        for (; q < j; q++) {\n          w = xml.charCodeAt(q);\n\n          if (w === 32 || (w > 8 && w < 14)) { // \\f\\n\\r\\t\\v space\n            continue;\n          }\n\n          return handleError('close tag');\n        }\n\n      } else {\n        if (xml.charCodeAt(j - 1) === 47) { // .../>\n          x = elementName = xml.substring(i + 1, j - 1);\n\n          tagStart = true;\n          tagEnd = true;\n\n        } else {\n          x = elementName = xml.substring(i + 1, j);\n\n          tagStart = true;\n          tagEnd = false;\n        }\n\n        if (!(w > 96 && w < 123 || w > 64 && w < 91 || w === 95 || w === 58)) { // char 95\"_\" 58\":\"\n          return handleError('illegal first char nodeName');\n        }\n\n        for (q = 1, y = x.length; q < y; q++) {\n          w = x.charCodeAt(q);\n\n          if (w > 96 && w < 123 || w > 64 && w < 91 || w > 47 && w < 59 || w === 45 || w === 95 || w == 46) {\n            continue;\n          }\n\n          if (w === 32 || (w < 14 && w > 8)) { // \\f\\n\\r\\t\\v space\n            elementName = x.substring(0, q);\n\n            // maybe there are attributes\n            cachedAttrs = null;\n            break;\n          }\n\n          return handleError('invalid nodeName');\n        }\n\n        if (!tagEnd) {\n          nodeStack.push(elementName);\n        }\n      }\n\n      if (isNamespace) {\n\n        _nsMatrix = nsMatrix;\n\n        if (tagStart) {\n\n          // remember old namespace\n          // unless we're self-closing\n          if (!tagEnd) {\n            nsMatrixStack.push(_nsMatrix);\n          }\n\n          if (cachedAttrs === null) {\n\n            // quick check, whether there may be namespace\n            // declarations on the node; if that is the case\n            // we need to eagerly parse the node attributes\n            if ((maybeNS = x.indexOf('xmlns', q) !== -1)) {\n              attrsStart = q;\n              attrsString = x;\n\n              getAttrs();\n\n              maybeNS = false;\n            }\n          }\n        }\n\n        _elementName = elementName;\n\n        w = elementName.indexOf(':');\n        if (w !== -1) {\n          xmlns = nsMatrix[elementName.substring(0, w)];\n\n          // prefix given; namespace must exist\n          if (!xmlns) {\n            return handleError('missing namespace on <' + _elementName + '>');\n          }\n\n          elementName = elementName.substr(w + 1);\n        } else {\n          xmlns = nsMatrix['xmlns'];\n\n          // if no default namespace is defined,\n          // we'll import the element as anonymous.\n          //\n          // it is up to users to correct that to the document defined\n          // targetNamespace, or whatever their undersanding of the\n          // XML spec mandates.\n        }\n\n        // adjust namespace prefixs as configured\n        if (xmlns) {\n          elementName = xmlns + ':' + elementName;\n        }\n\n      }\n\n      if (tagStart) {\n        attrsStart = q;\n        attrsString = x;\n\n        if (onOpenTag) {\n          if (proxy) {\n            onOpenTag(elementProxy, decodeEntities, tagEnd, getContext);\n          } else {\n            onOpenTag(elementName, getAttrs, decodeEntities, tagEnd, getContext);\n          }\n\n          if (parseStop) {\n            return;\n          }\n        }\n\n      }\n\n      if (tagEnd) {\n\n        if (onCloseTag) {\n          onCloseTag(proxy ? elementProxy : elementName, decodeEntities, tagStart, getContext);\n\n          if (parseStop) {\n            return;\n          }\n        }\n\n        // restore old namespace\n        if (isNamespace) {\n          if (!tagStart) {\n            nsMatrix = nsMatrixStack.pop();\n          } else {\n            nsMatrix = _nsMatrix;\n          }\n        }\n      }\n\n      j += 1;\n    }\n  } /** end parse */\n\n}\n\nexport { Parser, decodeEntities as decode };\n//# sourceMappingURL=index.js.map\n","import { forEach, assign, find, isString, findIndex, filter, has } from 'min-dash';\nimport { Parser } from 'saxen';\nimport { coerceType, parseNameNS, isSimpleType, Moddle } from 'moddle';\n\nfunction hasLowerCaseAlias(pkg) {\n  return pkg.xml && pkg.xml.tagAlias === 'lowerCase';\n}\n\nvar DEFAULT_NS_MAP = {\n  'xsi': 'http://www.w3.org/2001/XMLSchema-instance',\n  'xml': 'http://www.w3.org/XML/1998/namespace'\n};\n\nvar SERIALIZE_PROPERTY = 'property';\n\nfunction getSerialization(element) {\n  return element.xml && element.xml.serialize;\n}\n\nfunction getSerializationType(element) {\n  const type = getSerialization(element);\n\n  return type !== SERIALIZE_PROPERTY && (type || null);\n}\n\nfunction capitalize(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\n\nfunction aliasToName(aliasNs, pkg) {\n\n  if (!hasLowerCaseAlias(pkg)) {\n    return aliasNs.name;\n  }\n\n  return aliasNs.prefix + ':' + capitalize(aliasNs.localName);\n}\n\n/**\n * Un-prefix a potentially prefixed type name.\n *\n * @param {NsName} nameNs\n * @param {Object} [pkg]\n *\n * @return {string}\n */\nfunction prefixedToName(nameNs, pkg) {\n\n  var name = nameNs.name,\n      localName = nameNs.localName;\n\n  var typePrefix = pkg && pkg.xml && pkg.xml.typePrefix;\n\n  if (typePrefix && localName.indexOf(typePrefix) === 0) {\n    return nameNs.prefix + ':' + localName.slice(typePrefix.length);\n  } else {\n    return name;\n  }\n}\n\nfunction normalizeTypeName(name, nsMap, model) {\n\n  // normalize against actual NS\n  const nameNs = parseNameNS(name, nsMap.xmlns);\n\n  const normalizedName = `${ nsMap[nameNs.prefix] || nameNs.prefix }:${ nameNs.localName }`;\n\n  const normalizedNameNs = parseNameNS(normalizedName);\n\n  // determine actual type name, based on package-defined prefix\n  var pkg = model.getPackage(normalizedNameNs.prefix);\n\n  return prefixedToName(normalizedNameNs, pkg);\n}\n\nfunction error(message) {\n  return new Error(message);\n}\n\n/**\n * Get the moddle descriptor for a given instance or type.\n *\n * @param  {ModdleElement|Function} element\n *\n * @return {Object} the moddle descriptor\n */\nfunction getModdleDescriptor(element) {\n  return element.$descriptor;\n}\n\n\n/**\n * A parse context.\n *\n * @class\n *\n * @param {Object} options\n * @param {ElementHandler} options.rootHandler the root handler for parsing a document\n * @param {boolean} [options.lax=false] whether or not to ignore invalid elements\n */\nfunction Context(options) {\n\n  /**\n   * @property {ElementHandler} rootHandler\n   */\n\n  /**\n   * @property {Boolean} lax\n   */\n\n  assign(this, options);\n\n  this.elementsById = {};\n  this.references = [];\n  this.warnings = [];\n\n  /**\n   * Add an unresolved reference.\n   *\n   * @param {Object} reference\n   */\n  this.addReference = function(reference) {\n    this.references.push(reference);\n  };\n\n  /**\n   * Add a processed element.\n   *\n   * @param {ModdleElement} element\n   */\n  this.addElement = function(element) {\n\n    if (!element) {\n      throw error('expected element');\n    }\n\n    var elementsById = this.elementsById;\n\n    var descriptor = getModdleDescriptor(element);\n\n    var idProperty = descriptor.idProperty,\n        id;\n\n    if (idProperty) {\n      id = element.get(idProperty.name);\n\n      if (id) {\n\n        // for QName validation as per http://www.w3.org/TR/REC-xml/#NT-NameChar\n        if (!/^([a-z][\\w-.]*:)?[a-z_][\\w-.]*$/i.test(id)) {\n          throw new Error('illegal ID <' + id + '>');\n        }\n\n        if (elementsById[id]) {\n          throw error('duplicate ID <' + id + '>');\n        }\n\n        elementsById[id] = element;\n      }\n    }\n  };\n\n  /**\n   * Add an import warning.\n   *\n   * @param {Object} warning\n   * @param {String} warning.message\n   * @param {Error} [warning.error]\n   */\n  this.addWarning = function(warning) {\n    this.warnings.push(warning);\n  };\n}\n\nfunction BaseHandler() {}\n\nBaseHandler.prototype.handleEnd = function() {};\nBaseHandler.prototype.handleText = function() {};\nBaseHandler.prototype.handleNode = function() {};\n\n\n/**\n * A simple pass through handler that does nothing except for\n * ignoring all input it receives.\n *\n * This is used to ignore unknown elements and\n * attributes.\n */\nfunction NoopHandler() { }\n\nNoopHandler.prototype = Object.create(BaseHandler.prototype);\n\nNoopHandler.prototype.handleNode = function() {\n  return this;\n};\n\nfunction BodyHandler() {}\n\nBodyHandler.prototype = Object.create(BaseHandler.prototype);\n\nBodyHandler.prototype.handleText = function(text) {\n  this.body = (this.body || '') + text;\n};\n\nfunction ReferenceHandler(property, context) {\n  this.property = property;\n  this.context = context;\n}\n\nReferenceHandler.prototype = Object.create(BodyHandler.prototype);\n\nReferenceHandler.prototype.handleNode = function(node) {\n\n  if (this.element) {\n    throw error('expected no sub nodes');\n  } else {\n    this.element = this.createReference(node);\n  }\n\n  return this;\n};\n\nReferenceHandler.prototype.handleEnd = function() {\n  this.element.id = this.body;\n};\n\nReferenceHandler.prototype.createReference = function(node) {\n  return {\n    property: this.property.ns.name,\n    id: ''\n  };\n};\n\nfunction ValueHandler(propertyDesc, element) {\n  this.element = element;\n  this.propertyDesc = propertyDesc;\n}\n\nValueHandler.prototype = Object.create(BodyHandler.prototype);\n\nValueHandler.prototype.handleEnd = function() {\n\n  var value = this.body || '',\n      element = this.element,\n      propertyDesc = this.propertyDesc;\n\n  value = coerceType(propertyDesc.type, value);\n\n  if (propertyDesc.isMany) {\n    element.get(propertyDesc.name).push(value);\n  } else {\n    element.set(propertyDesc.name, value);\n  }\n};\n\n\nfunction BaseElementHandler() {}\n\nBaseElementHandler.prototype = Object.create(BodyHandler.prototype);\n\nBaseElementHandler.prototype.handleNode = function(node) {\n  var parser = this,\n      element = this.element;\n\n  if (!element) {\n    element = this.element = this.createElement(node);\n\n    this.context.addElement(element);\n  } else {\n    parser = this.handleChild(node);\n  }\n\n  return parser;\n};\n\n/**\n * @class Reader.ElementHandler\n *\n */\nfunction ElementHandler(model, typeName, context) {\n  this.model = model;\n  this.type = model.getType(typeName);\n  this.context = context;\n}\n\nElementHandler.prototype = Object.create(BaseElementHandler.prototype);\n\nElementHandler.prototype.addReference = function(reference) {\n  this.context.addReference(reference);\n};\n\nElementHandler.prototype.handleText = function(text) {\n\n  var element = this.element,\n      descriptor = getModdleDescriptor(element),\n      bodyProperty = descriptor.bodyProperty;\n\n  if (!bodyProperty) {\n    throw error('unexpected body text <' + text + '>');\n  }\n\n  BodyHandler.prototype.handleText.call(this, text);\n};\n\nElementHandler.prototype.handleEnd = function() {\n\n  var value = this.body,\n      element = this.element,\n      descriptor = getModdleDescriptor(element),\n      bodyProperty = descriptor.bodyProperty;\n\n  if (bodyProperty && value !== undefined) {\n    value = coerceType(bodyProperty.type, value);\n    element.set(bodyProperty.name, value);\n  }\n};\n\n/**\n * Create an instance of the model from the given node.\n *\n * @param  {Element} node the xml node\n */\nElementHandler.prototype.createElement = function(node) {\n  var attributes = node.attributes,\n      Type = this.type,\n      descriptor = getModdleDescriptor(Type),\n      context = this.context,\n      instance = new Type({}),\n      model = this.model,\n      propNameNs;\n\n  forEach(attributes, function(value, name) {\n\n    var prop = descriptor.propertiesByName[name],\n        values;\n\n    if (prop && prop.isReference) {\n\n      if (!prop.isMany) {\n        context.addReference({\n          element: instance,\n          property: prop.ns.name,\n          id: value\n        });\n      } else {\n\n        // IDREFS: parse references as whitespace-separated list\n        values = value.split(' ');\n\n        forEach(values, function(v) {\n          context.addReference({\n            element: instance,\n            property: prop.ns.name,\n            id: v\n          });\n        });\n      }\n\n    } else {\n      if (prop) {\n        value = coerceType(prop.type, value);\n      } else if (name === 'xmlns') {\n        name = ':' + name;\n      } else {\n        propNameNs = parseNameNS(name, descriptor.ns.prefix);\n\n        // check whether attribute is defined in a well-known namespace\n        // if that is the case we emit a warning to indicate potential misuse\n        if (model.getPackage(propNameNs.prefix)) {\n\n          context.addWarning({\n            message: 'unknown attribute <' + name + '>',\n            element: instance,\n            property: name,\n            value: value\n          });\n        }\n      }\n\n      instance.set(name, value);\n    }\n  });\n\n  return instance;\n};\n\nElementHandler.prototype.getPropertyForNode = function(node) {\n\n  var name = node.name;\n  var nameNs = parseNameNS(name);\n\n  var type = this.type,\n      model = this.model,\n      descriptor = getModdleDescriptor(type);\n\n  var propertyName = nameNs.name,\n      property = descriptor.propertiesByName[propertyName];\n\n  // search for properties by name first\n\n  if (property && !property.isAttr) {\n\n    const serializationType = getSerializationType(property);\n\n    if (serializationType) {\n      const elementTypeName = node.attributes[serializationType];\n\n      // type is optional, if it does not exists the\n      // default type is assumed\n      if (elementTypeName) {\n\n        // convert the prefix used to the mapped form, but also\n        // take possible type prefixes from XML\n        // into account, i.e.: xsi:type=\"t{ActualType}\",\n        const normalizedTypeName = normalizeTypeName(elementTypeName, node.ns, model);\n\n        const elementType = model.getType(normalizedTypeName);\n\n        return assign({}, property, {\n          effectiveType: getModdleDescriptor(elementType).name\n        });\n      }\n    }\n\n    // search for properties by name first\n    return property;\n  }\n\n  var pkg = model.getPackage(nameNs.prefix);\n\n  if (pkg) {\n    const elementTypeName = aliasToName(nameNs, pkg);\n    const elementType = model.getType(elementTypeName);\n\n    // search for collection members later\n    property = find(descriptor.properties, function(p) {\n      return !p.isVirtual && !p.isReference && !p.isAttribute && elementType.hasType(p.type);\n    });\n\n    if (property) {\n      return assign({}, property, {\n        effectiveType: getModdleDescriptor(elementType).name\n      });\n    }\n  } else {\n\n    // parse unknown element (maybe extension)\n    property = find(descriptor.properties, function(p) {\n      return !p.isReference && !p.isAttribute && p.type === 'Element';\n    });\n\n    if (property) {\n      return property;\n    }\n  }\n\n  throw error('unrecognized element <' + nameNs.name + '>');\n};\n\nElementHandler.prototype.toString = function() {\n  return 'ElementDescriptor[' + getModdleDescriptor(this.type).name + ']';\n};\n\nElementHandler.prototype.valueHandler = function(propertyDesc, element) {\n  return new ValueHandler(propertyDesc, element);\n};\n\nElementHandler.prototype.referenceHandler = function(propertyDesc) {\n  return new ReferenceHandler(propertyDesc, this.context);\n};\n\nElementHandler.prototype.handler = function(type) {\n  if (type === 'Element') {\n    return new GenericElementHandler(this.model, type, this.context);\n  } else {\n    return new ElementHandler(this.model, type, this.context);\n  }\n};\n\n/**\n * Handle the child element parsing\n *\n * @param  {Element} node the xml node\n */\nElementHandler.prototype.handleChild = function(node) {\n  var propertyDesc, type, element, childHandler;\n\n  propertyDesc = this.getPropertyForNode(node);\n  element = this.element;\n\n  type = propertyDesc.effectiveType || propertyDesc.type;\n\n  if (isSimpleType(type)) {\n    return this.valueHandler(propertyDesc, element);\n  }\n\n  if (propertyDesc.isReference) {\n    childHandler = this.referenceHandler(propertyDesc).handleNode(node);\n  } else {\n    childHandler = this.handler(type).handleNode(node);\n  }\n\n  var newElement = childHandler.element;\n\n  // child handles may decide to skip elements\n  // by not returning anything\n  if (newElement !== undefined) {\n\n    if (propertyDesc.isMany) {\n      element.get(propertyDesc.name).push(newElement);\n    } else {\n      element.set(propertyDesc.name, newElement);\n    }\n\n    if (propertyDesc.isReference) {\n      assign(newElement, {\n        element: element\n      });\n\n      this.context.addReference(newElement);\n    } else {\n\n      // establish child -> parent relationship\n      newElement.$parent = element;\n    }\n  }\n\n  return childHandler;\n};\n\n/**\n * An element handler that performs special validation\n * to ensure the node it gets initialized with matches\n * the handlers type (namespace wise).\n *\n * @param {Moddle} model\n * @param {String} typeName\n * @param {Context} context\n */\nfunction RootElementHandler(model, typeName, context) {\n  ElementHandler.call(this, model, typeName, context);\n}\n\nRootElementHandler.prototype = Object.create(ElementHandler.prototype);\n\nRootElementHandler.prototype.createElement = function(node) {\n\n  var name = node.name,\n      nameNs = parseNameNS(name),\n      model = this.model,\n      type = this.type,\n      pkg = model.getPackage(nameNs.prefix),\n      typeName = pkg && aliasToName(nameNs, pkg) || name;\n\n  // verify the correct namespace if we parse\n  // the first element in the handler tree\n  //\n  // this ensures we don't mistakenly import wrong namespace elements\n  if (!type.hasType(typeName)) {\n    throw error('unexpected element <' + node.originalName + '>');\n  }\n\n  return ElementHandler.prototype.createElement.call(this, node);\n};\n\n\nfunction GenericElementHandler(model, typeName, context) {\n  this.model = model;\n  this.context = context;\n}\n\nGenericElementHandler.prototype = Object.create(BaseElementHandler.prototype);\n\nGenericElementHandler.prototype.createElement = function(node) {\n\n  var name = node.name,\n      ns = parseNameNS(name),\n      prefix = ns.prefix,\n      uri = node.ns[prefix + '$uri'],\n      attributes = node.attributes;\n\n  return this.model.createAny(name, uri, attributes);\n};\n\nGenericElementHandler.prototype.handleChild = function(node) {\n\n  var handler = new GenericElementHandler(this.model, 'Element', this.context).handleNode(node),\n      element = this.element;\n\n  var newElement = handler.element,\n      children;\n\n  if (newElement !== undefined) {\n    children = element.$children = element.$children || [];\n    children.push(newElement);\n\n    // establish child -> parent relationship\n    newElement.$parent = element;\n  }\n\n  return handler;\n};\n\nGenericElementHandler.prototype.handleEnd = function() {\n  if (this.body) {\n    this.element.$body = this.body;\n  }\n};\n\n/**\n * A reader for a meta-model\n *\n * @param {Object} options\n * @param {Model} options.model used to read xml files\n * @param {Boolean} options.lax whether to make parse errors warnings\n */\nfunction Reader(options) {\n\n  if (options instanceof Moddle) {\n    options = {\n      model: options\n    };\n  }\n\n  assign(this, { lax: false }, options);\n}\n\n/**\n * The fromXML result.\n *\n * @typedef {Object} ParseResult\n *\n * @property {ModdleElement} rootElement\n * @property {Array<Object>} references\n * @property {Array<Error>} warnings\n * @property {Object} elementsById - a mapping containing each ID -> ModdleElement\n */\n\n/**\n * The fromXML result.\n *\n * @typedef {Error} ParseError\n *\n * @property {Array<Error>} warnings\n */\n\n/**\n * Parse the given XML into a moddle document tree.\n *\n * @param {String} xml\n * @param {ElementHandler|Object} options or rootHandler\n *\n * @returns {Promise<ParseResult, ParseError>}\n */\nReader.prototype.fromXML = function(xml, options, done) {\n\n  var rootHandler = options.rootHandler;\n\n  if (options instanceof ElementHandler) {\n\n    // root handler passed via (xml, { rootHandler: ElementHandler }, ...)\n    rootHandler = options;\n    options = {};\n  } else {\n    if (typeof options === 'string') {\n\n      // rootHandler passed via (xml, 'someString', ...)\n      rootHandler = this.handler(options);\n      options = {};\n    } else if (typeof rootHandler === 'string') {\n\n      // rootHandler passed via (xml, { rootHandler: 'someString' }, ...)\n      rootHandler = this.handler(rootHandler);\n    }\n  }\n\n  var model = this.model,\n      lax = this.lax;\n\n  var context = new Context(assign({}, options, { rootHandler: rootHandler })),\n      parser = new Parser({ proxy: true }),\n      stack = createStack();\n\n  rootHandler.context = context;\n\n  // push root handler\n  stack.push(rootHandler);\n\n\n  /**\n   * Handle error.\n   *\n   * @param  {Error} err\n   * @param  {Function} getContext\n   * @param  {boolean} lax\n   *\n   * @return {boolean} true if handled\n   */\n  function handleError(err, getContext, lax) {\n\n    var ctx = getContext();\n\n    var line = ctx.line,\n        column = ctx.column,\n        data = ctx.data;\n\n    // we receive the full context data here,\n    // for elements trim down the information\n    // to the tag name, only\n    if (data.charAt(0) === '<' && data.indexOf(' ') !== -1) {\n      data = data.slice(0, data.indexOf(' ')) + '>';\n    }\n\n    var message =\n      'unparsable content ' + (data ? data + ' ' : '') + 'detected\\n\\t' +\n        'line: ' + line + '\\n\\t' +\n        'column: ' + column + '\\n\\t' +\n        'nested error: ' + err.message;\n\n    if (lax) {\n      context.addWarning({\n        message: message,\n        error: err\n      });\n\n      return true;\n    } else {\n      throw error(message);\n    }\n  }\n\n  function handleWarning(err, getContext) {\n\n    // just like handling errors in <lax=true> mode\n    return handleError(err, getContext, true);\n  }\n\n  /**\n   * Resolve collected references on parse end.\n   */\n  function resolveReferences() {\n\n    var elementsById = context.elementsById;\n    var references = context.references;\n\n    var i, r;\n\n    for (i = 0; (r = references[i]); i++) {\n      var element = r.element;\n      var reference = elementsById[r.id];\n      var property = getModdleDescriptor(element).propertiesByName[r.property];\n\n      if (!reference) {\n        context.addWarning({\n          message: 'unresolved reference <' + r.id + '>',\n          element: r.element,\n          property: r.property,\n          value: r.id\n        });\n      }\n\n      if (property.isMany) {\n        var collection = element.get(property.name),\n            idx = collection.indexOf(r);\n\n        // we replace an existing place holder (idx != -1) or\n        // append to the collection instead\n        if (idx === -1) {\n          idx = collection.length;\n        }\n\n        if (!reference) {\n\n          // remove unresolvable reference\n          collection.splice(idx, 1);\n        } else {\n\n          // add or update reference in collection\n          collection[idx] = reference;\n        }\n      } else {\n        element.set(property.name, reference);\n      }\n    }\n  }\n\n  function handleClose() {\n    stack.pop().handleEnd();\n  }\n\n  var PREAMBLE_START_PATTERN = /^<\\?xml /i;\n\n  var ENCODING_PATTERN = / encoding=\"([^\"]+)\"/i;\n\n  var UTF_8_PATTERN = /^utf-8$/i;\n\n  function handleQuestion(question) {\n\n    if (!PREAMBLE_START_PATTERN.test(question)) {\n      return;\n    }\n\n    var match = ENCODING_PATTERN.exec(question);\n    var encoding = match && match[1];\n\n    if (!encoding || UTF_8_PATTERN.test(encoding)) {\n      return;\n    }\n\n    context.addWarning({\n      message:\n        'unsupported document encoding <' + encoding + '>, ' +\n        'falling back to UTF-8'\n    });\n  }\n\n  function handleOpen(node, getContext) {\n    var handler = stack.peek();\n\n    try {\n      stack.push(handler.handleNode(node));\n    } catch (err) {\n\n      if (handleError(err, getContext, lax)) {\n        stack.push(new NoopHandler());\n      }\n    }\n  }\n\n  function handleCData(text, getContext) {\n\n    try {\n      stack.peek().handleText(text);\n    } catch (err) {\n      handleWarning(err, getContext);\n    }\n  }\n\n  function handleText(text, getContext) {\n\n    // strip whitespace only nodes, i.e. before\n    // <!CDATA[ ... ]> sections and in between tags\n\n    if (!text.trim()) {\n      return;\n    }\n\n    handleCData(text, getContext);\n  }\n\n  var uriMap = model.getPackages().reduce(function(uriMap, p) {\n    uriMap[p.uri] = p.prefix;\n\n    return uriMap;\n  }, Object.entries(DEFAULT_NS_MAP).reduce(function(map, [ prefix, url ]) {\n    map[url] = prefix;\n\n    return map;\n  }, model.config && model.config.nsMap || {}));\n\n  parser\n    .ns(uriMap)\n    .on('openTag', function(obj, decodeStr, selfClosing, getContext) {\n\n      // gracefully handle unparsable attributes (attrs=false)\n      var attrs = obj.attrs || {};\n\n      var decodedAttrs = Object.keys(attrs).reduce(function(d, key) {\n        var value = decodeStr(attrs[key]);\n\n        d[key] = value;\n\n        return d;\n      }, {});\n\n      var node = {\n        name: obj.name,\n        originalName: obj.originalName,\n        attributes: decodedAttrs,\n        ns: obj.ns\n      };\n\n      handleOpen(node, getContext);\n    })\n    .on('question', handleQuestion)\n    .on('closeTag', handleClose)\n    .on('cdata', handleCData)\n    .on('text', function(text, decodeEntities, getContext) {\n      handleText(decodeEntities(text), getContext);\n    })\n    .on('error', handleError)\n    .on('warn', handleWarning);\n\n  // async XML parsing to make sure the execution environment\n  // (node or brower) is kept responsive and that certain optimization\n  // strategies can kick in.\n  return new Promise(function(resolve, reject) {\n\n    var err;\n\n    try {\n      parser.parse(xml);\n\n      resolveReferences();\n    } catch (e) {\n      err = e;\n    }\n\n    var rootElement = rootHandler.element;\n\n    if (!err && !rootElement) {\n      err = error('failed to parse document as <' + rootHandler.type.$descriptor.name + '>');\n    }\n\n    var warnings = context.warnings;\n    var references = context.references;\n    var elementsById = context.elementsById;\n\n    if (err) {\n      err.warnings = warnings;\n\n      return reject(err);\n    } else {\n      return resolve({\n        rootElement: rootElement,\n        elementsById: elementsById,\n        references: references,\n        warnings: warnings\n      });\n    }\n  });\n};\n\nReader.prototype.handler = function(name) {\n  return new RootElementHandler(this.model, name);\n};\n\n\n// helpers //////////////////////////\n\nfunction createStack() {\n  var stack = [];\n\n  Object.defineProperty(stack, 'peek', {\n    value: function() {\n      return this[this.length - 1];\n    }\n  });\n\n  return stack;\n}\n\nvar XML_PREAMBLE = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n';\n\nvar ESCAPE_ATTR_CHARS = /<|>|'|\"|&|\\n\\r|\\n/g;\nvar ESCAPE_CHARS = /<|>|&/g;\n\n\nfunction Namespaces(parent) {\n\n  this.prefixMap = {};\n  this.uriMap = {};\n  this.used = {};\n\n  this.wellknown = [];\n  this.custom = [];\n  this.parent = parent;\n\n  this.defaultPrefixMap = parent && parent.defaultPrefixMap || {};\n}\n\nNamespaces.prototype.mapDefaultPrefixes = function(defaultPrefixMap) {\n  this.defaultPrefixMap = defaultPrefixMap;\n};\n\nNamespaces.prototype.defaultUriByPrefix = function(prefix) {\n  return this.defaultPrefixMap[prefix];\n};\n\nNamespaces.prototype.byUri = function(uri) {\n  return this.uriMap[uri] || (\n    this.parent && this.parent.byUri(uri)\n  );\n};\n\nNamespaces.prototype.add = function(ns, isWellknown) {\n\n  this.uriMap[ns.uri] = ns;\n\n  if (isWellknown) {\n    this.wellknown.push(ns);\n  } else {\n    this.custom.push(ns);\n  }\n\n  this.mapPrefix(ns.prefix, ns.uri);\n};\n\nNamespaces.prototype.uriByPrefix = function(prefix) {\n  return this.prefixMap[prefix || 'xmlns'] || (\n    this.parent && this.parent.uriByPrefix(prefix)\n  );\n};\n\nNamespaces.prototype.mapPrefix = function(prefix, uri) {\n  this.prefixMap[prefix || 'xmlns'] = uri;\n};\n\nNamespaces.prototype.getNSKey = function(ns) {\n  return (ns.prefix !== undefined) ? (ns.uri + '|' + ns.prefix) : ns.uri;\n};\n\nNamespaces.prototype.logUsed = function(ns) {\n\n  var uri = ns.uri;\n  var nsKey = this.getNSKey(ns);\n\n  this.used[nsKey] = this.byUri(uri);\n\n  // Inform parent recursively about the usage of this NS\n  if (this.parent) {\n    this.parent.logUsed(ns);\n  }\n};\n\nNamespaces.prototype.getUsed = function(ns) {\n\n  var allNs = [].concat(this.wellknown, this.custom);\n\n  return allNs.filter(ns => {\n    var nsKey = this.getNSKey(ns);\n\n    return this.used[nsKey];\n  });\n};\n\n\nfunction lower(string) {\n  return string.charAt(0).toLowerCase() + string.slice(1);\n}\n\nfunction nameToAlias(name, pkg) {\n  if (hasLowerCaseAlias(pkg)) {\n    return lower(name);\n  } else {\n    return name;\n  }\n}\n\nfunction inherits(ctor, superCtor) {\n  ctor.super_ = superCtor;\n  ctor.prototype = Object.create(superCtor.prototype, {\n    constructor: {\n      value: ctor,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n}\n\nfunction nsName(ns) {\n  if (isString(ns)) {\n    return ns;\n  } else {\n    return (ns.prefix ? ns.prefix + ':' : '') + ns.localName;\n  }\n}\n\nfunction getNsAttrs(namespaces) {\n\n  return namespaces.getUsed().filter(function(ns) {\n\n    // do not serialize built in <xml> namespace\n    return ns.prefix !== 'xml';\n  }).map(function(ns) {\n    var name = 'xmlns' + (ns.prefix ? ':' + ns.prefix : '');\n    return { name: name, value: ns.uri };\n  });\n\n}\n\nfunction getElementNs(ns, descriptor) {\n  if (descriptor.isGeneric) {\n    return assign({ localName: descriptor.ns.localName }, ns);\n  } else {\n    return assign({ localName: nameToAlias(descriptor.ns.localName, descriptor.$pkg) }, ns);\n  }\n}\n\nfunction getPropertyNs(ns, descriptor) {\n  return assign({ localName: descriptor.ns.localName }, ns);\n}\n\nfunction getSerializableProperties(element) {\n  var descriptor = element.$descriptor;\n\n  return filter(descriptor.properties, function(p) {\n    var name = p.name;\n\n    if (p.isVirtual) {\n      return false;\n    }\n\n    // do not serialize defaults\n    if (!has(element, name)) {\n      return false;\n    }\n\n    var value = element[name];\n\n    // do not serialize default equals\n    if (value === p.default) {\n      return false;\n    }\n\n    // do not serialize null properties\n    if (value === null) {\n      return false;\n    }\n\n    return p.isMany ? value.length : true;\n  });\n}\n\nvar ESCAPE_ATTR_MAP = {\n  '\\n': '#10',\n  '\\n\\r': '#10',\n  '\"': '#34',\n  '\\'': '#39',\n  '<': '#60',\n  '>': '#62',\n  '&': '#38'\n};\n\nvar ESCAPE_MAP = {\n  '<': 'lt',\n  '>': 'gt',\n  '&': 'amp'\n};\n\nfunction escape(str, charPattern, replaceMap) {\n\n  // ensure we are handling strings here\n  str = isString(str) ? str : '' + str;\n\n  return str.replace(charPattern, function(s) {\n    return '&' + replaceMap[s] + ';';\n  });\n}\n\n/**\n * Escape a string attribute to not contain any bad values (line breaks, '\"', ...)\n *\n * @param {String} str the string to escape\n * @return {String} the escaped string\n */\nfunction escapeAttr(str) {\n  return escape(str, ESCAPE_ATTR_CHARS, ESCAPE_ATTR_MAP);\n}\n\nfunction escapeBody(str) {\n  return escape(str, ESCAPE_CHARS, ESCAPE_MAP);\n}\n\nfunction filterAttributes(props) {\n  return filter(props, function(p) { return p.isAttr; });\n}\n\nfunction filterContained(props) {\n  return filter(props, function(p) { return !p.isAttr; });\n}\n\n\nfunction ReferenceSerializer(tagName) {\n  this.tagName = tagName;\n}\n\nReferenceSerializer.prototype.build = function(element) {\n  this.element = element;\n  return this;\n};\n\nReferenceSerializer.prototype.serializeTo = function(writer) {\n  writer\n    .appendIndent()\n    .append('<' + this.tagName + '>' + this.element.id + '</' + this.tagName + '>')\n    .appendNewLine();\n};\n\nfunction BodySerializer() {}\n\nBodySerializer.prototype.serializeValue =\nBodySerializer.prototype.serializeTo = function(writer) {\n  writer.append(\n    this.escape\n      ? escapeBody(this.value)\n      : this.value\n  );\n};\n\nBodySerializer.prototype.build = function(prop, value) {\n  this.value = value;\n\n  if (prop.type === 'String' && value.search(ESCAPE_CHARS) !== -1) {\n    this.escape = true;\n  }\n\n  return this;\n};\n\nfunction ValueSerializer(tagName) {\n  this.tagName = tagName;\n}\n\ninherits(ValueSerializer, BodySerializer);\n\nValueSerializer.prototype.serializeTo = function(writer) {\n\n  writer\n    .appendIndent()\n    .append('<' + this.tagName + '>');\n\n  this.serializeValue(writer);\n\n  writer\n    .append('</' + this.tagName + '>')\n    .appendNewLine();\n};\n\nfunction ElementSerializer(parent, propertyDescriptor) {\n  this.body = [];\n  this.attrs = [];\n\n  this.parent = parent;\n  this.propertyDescriptor = propertyDescriptor;\n}\n\nElementSerializer.prototype.build = function(element) {\n  this.element = element;\n\n  var elementDescriptor = element.$descriptor,\n      propertyDescriptor = this.propertyDescriptor;\n\n  var otherAttrs,\n      properties;\n\n  var isGeneric = elementDescriptor.isGeneric;\n\n  if (isGeneric) {\n    otherAttrs = this.parseGenericNsAttributes(element);\n  } else {\n    otherAttrs = this.parseNsAttributes(element);\n  }\n\n  if (propertyDescriptor) {\n    this.ns = this.nsPropertyTagName(propertyDescriptor);\n  } else {\n    this.ns = this.nsTagName(elementDescriptor);\n  }\n\n  // compute tag name\n  this.tagName = this.addTagName(this.ns);\n\n  if (isGeneric) {\n    this.parseGenericContainments(element);\n  } else {\n    properties = getSerializableProperties(element);\n\n    this.parseAttributes(filterAttributes(properties));\n    this.parseContainments(filterContained(properties));\n  }\n\n  this.parseGenericAttributes(element, otherAttrs);\n\n  return this;\n};\n\nElementSerializer.prototype.nsTagName = function(descriptor) {\n  var effectiveNs = this.logNamespaceUsed(descriptor.ns);\n  return getElementNs(effectiveNs, descriptor);\n};\n\nElementSerializer.prototype.nsPropertyTagName = function(descriptor) {\n  var effectiveNs = this.logNamespaceUsed(descriptor.ns);\n  return getPropertyNs(effectiveNs, descriptor);\n};\n\nElementSerializer.prototype.isLocalNs = function(ns) {\n  return ns.uri === this.ns.uri;\n};\n\n/**\n * Get the actual ns attribute name for the given element.\n *\n * @param {Object} element\n * @param {Boolean} [element.inherited=false]\n *\n * @return {Object} nsName\n */\nElementSerializer.prototype.nsAttributeName = function(element) {\n\n  var ns;\n\n  if (isString(element)) {\n    ns = parseNameNS(element);\n  } else {\n    ns = element.ns;\n  }\n\n  // return just local name for inherited attributes\n  if (element.inherited) {\n    return { localName: ns.localName };\n  }\n\n  // parse + log effective ns\n  var effectiveNs = this.logNamespaceUsed(ns);\n\n  // LOG ACTUAL namespace use\n  this.getNamespaces().logUsed(effectiveNs);\n\n  // strip prefix if same namespace like parent\n  if (this.isLocalNs(effectiveNs)) {\n    return { localName: ns.localName };\n  } else {\n    return assign({ localName: ns.localName }, effectiveNs);\n  }\n};\n\nElementSerializer.prototype.parseGenericNsAttributes = function(element) {\n\n  return Object.entries(element).filter(\n    ([ key, value ]) => !key.startsWith('$') && this.parseNsAttribute(element, key, value)\n  ).map(\n    ([ key, value ]) => ({ name: key, value: value })\n  );\n};\n\nElementSerializer.prototype.parseGenericContainments = function(element) {\n  var body = element.$body;\n\n  if (body) {\n    this.body.push(new BodySerializer().build({ type: 'String' }, body));\n  }\n\n  var children = element.$children;\n\n  if (children) {\n    forEach(children, child => {\n      this.body.push(new ElementSerializer(this).build(child));\n    });\n  }\n};\n\nElementSerializer.prototype.parseNsAttribute = function(element, name, value) {\n  var model = element.$model;\n\n  var nameNs = parseNameNS(name);\n\n  var ns;\n\n  // parse xmlns:foo=\"http://foo.bar\"\n  if (nameNs.prefix === 'xmlns') {\n    ns = { prefix: nameNs.localName, uri: value };\n  }\n\n  // parse xmlns=\"http://foo.bar\"\n  if (!nameNs.prefix && nameNs.localName === 'xmlns') {\n    ns = { uri: value };\n  }\n\n  if (!ns) {\n    return {\n      name: name,\n      value: value\n    };\n  }\n\n  if (model && model.getPackage(value)) {\n\n    // register well known namespace\n    this.logNamespace(ns, true, true);\n  } else {\n\n    // log custom namespace directly as used\n    var actualNs = this.logNamespaceUsed(ns, true);\n\n    this.getNamespaces().logUsed(actualNs);\n  }\n};\n\n\n/**\n * Parse namespaces and return a list of left over generic attributes\n *\n * @param  {Object} element\n * @return {Array<Object>}\n */\nElementSerializer.prototype.parseNsAttributes = function(element) {\n  var self = this;\n\n  var genericAttrs = element.$attrs;\n\n  var attributes = [];\n\n  // parse namespace attributes first\n  // and log them. push non namespace attributes to a list\n  // and process them later\n  forEach(genericAttrs, function(value, name) {\n\n    var nonNsAttr = self.parseNsAttribute(element, name, value);\n\n    if (nonNsAttr) {\n      attributes.push(nonNsAttr);\n    }\n  });\n\n  return attributes;\n};\n\nElementSerializer.prototype.parseGenericAttributes = function(element, attributes) {\n\n  var self = this;\n\n  forEach(attributes, function(attr) {\n\n    try {\n      self.addAttribute(self.nsAttributeName(attr.name), attr.value);\n    } catch (e) {\n\n      // eslint-disable-next-line no-undef\n      typeof console !== 'undefined' && console.warn(\n        `missing namespace information for <${\n          attr.name\n        }=${ attr.value }> on`, element, e\n      );\n    }\n  });\n};\n\nElementSerializer.prototype.parseContainments = function(properties) {\n\n  var self = this,\n      body = this.body,\n      element = this.element;\n\n  forEach(properties, function(p) {\n    var value = element.get(p.name),\n        isReference = p.isReference,\n        isMany = p.isMany;\n\n    if (!isMany) {\n      value = [ value ];\n    }\n\n    if (p.isBody) {\n      body.push(new BodySerializer().build(p, value[0]));\n    } else if (isSimpleType(p.type)) {\n      forEach(value, function(v) {\n        body.push(new ValueSerializer(self.addTagName(self.nsPropertyTagName(p))).build(p, v));\n      });\n    } else if (isReference) {\n      forEach(value, function(v) {\n        body.push(new ReferenceSerializer(self.addTagName(self.nsPropertyTagName(p))).build(v));\n      });\n    } else {\n\n      // allow serialization via type\n      // rather than element name\n      var serialization = getSerialization(p);\n\n      forEach(value, function(v) {\n        var serializer;\n\n        if (serialization) {\n          if (serialization === SERIALIZE_PROPERTY) {\n            serializer = new ElementSerializer(self, p);\n          } else {\n            serializer = new TypeSerializer(self, p, serialization);\n          }\n        } else {\n          serializer = new ElementSerializer(self);\n        }\n\n        body.push(serializer.build(v));\n      });\n    }\n  });\n};\n\nElementSerializer.prototype.getNamespaces = function(local) {\n\n  var namespaces = this.namespaces,\n      parent = this.parent,\n      parentNamespaces;\n\n  if (!namespaces) {\n    parentNamespaces = parent && parent.getNamespaces();\n\n    if (local || !parentNamespaces) {\n      this.namespaces = namespaces = new Namespaces(parentNamespaces);\n    } else {\n      namespaces = parentNamespaces;\n    }\n  }\n\n  return namespaces;\n};\n\nElementSerializer.prototype.logNamespace = function(ns, wellknown, local) {\n  var namespaces = this.getNamespaces(local);\n\n  var nsUri = ns.uri,\n      nsPrefix = ns.prefix;\n\n  var existing = namespaces.byUri(nsUri);\n\n  if (!existing || local) {\n    namespaces.add(ns, wellknown);\n  }\n\n  namespaces.mapPrefix(nsPrefix, nsUri);\n\n  return ns;\n};\n\nElementSerializer.prototype.logNamespaceUsed = function(ns, local) {\n  var namespaces = this.getNamespaces(local);\n\n  // ns may be\n  //\n  //   * prefix only\n  //   * prefix:uri\n  //   * localName only\n\n  var prefix = ns.prefix,\n      uri = ns.uri,\n      newPrefix, idx,\n      wellknownUri;\n\n  // handle anonymous namespaces (elementForm=unqualified), cf. #23\n  if (!prefix && !uri) {\n    return { localName: ns.localName };\n  }\n\n  wellknownUri = namespaces.defaultUriByPrefix(prefix);\n\n  uri = uri || wellknownUri || namespaces.uriByPrefix(prefix);\n\n  if (!uri) {\n    throw new Error('no namespace uri given for prefix <' + prefix + '>');\n  }\n\n  ns = namespaces.byUri(uri);\n\n  // register new default prefix <xmlns> in local scope\n  if (!ns && !prefix) {\n    ns = this.logNamespace({ uri }, wellknownUri === uri, true);\n  }\n\n  if (!ns) {\n    newPrefix = prefix;\n    idx = 1;\n\n    // find a prefix that is not mapped yet\n    while (namespaces.uriByPrefix(newPrefix)) {\n      newPrefix = prefix + '_' + idx++;\n    }\n\n    ns = this.logNamespace({ prefix: newPrefix, uri: uri }, wellknownUri === uri);\n  }\n\n  if (prefix) {\n    namespaces.mapPrefix(prefix, uri);\n  }\n\n  return ns;\n};\n\nElementSerializer.prototype.parseAttributes = function(properties) {\n  var self = this,\n      element = this.element;\n\n  forEach(properties, function(p) {\n\n    var value = element.get(p.name);\n\n    if (p.isReference) {\n\n      if (!p.isMany) {\n        value = value.id;\n      } else {\n        var values = [];\n        forEach(value, function(v) {\n          values.push(v.id);\n        });\n\n        // IDREFS is a whitespace-separated list of references.\n        value = values.join(' ');\n      }\n\n    }\n\n    self.addAttribute(self.nsAttributeName(p), value);\n  });\n};\n\nElementSerializer.prototype.addTagName = function(nsTagName) {\n  var actualNs = this.logNamespaceUsed(nsTagName);\n\n  this.getNamespaces().logUsed(actualNs);\n\n  return nsName(nsTagName);\n};\n\nElementSerializer.prototype.addAttribute = function(name, value) {\n  var attrs = this.attrs;\n\n  if (isString(value)) {\n    value = escapeAttr(value);\n  }\n\n  // de-duplicate attributes\n  // https://github.com/bpmn-io/moddle-xml/issues/66\n  var idx = findIndex(attrs, function(element) {\n    return (\n      element.name.localName === name.localName &&\n      element.name.uri === name.uri &&\n      element.name.prefix === name.prefix\n    );\n  });\n\n  var attr = { name: name, value: value };\n\n  if (idx !== -1) {\n    attrs.splice(idx, 1, attr);\n  } else {\n    attrs.push(attr);\n  }\n};\n\nElementSerializer.prototype.serializeAttributes = function(writer) {\n  var attrs = this.attrs,\n      namespaces = this.namespaces;\n\n  if (namespaces) {\n    attrs = getNsAttrs(namespaces).concat(attrs);\n  }\n\n  forEach(attrs, function(a) {\n    writer\n      .append(' ')\n      .append(nsName(a.name)).append('=\"').append(a.value).append('\"');\n  });\n};\n\nElementSerializer.prototype.serializeTo = function(writer) {\n  var firstBody = this.body[0],\n      indent = firstBody && firstBody.constructor !== BodySerializer;\n\n  writer\n    .appendIndent()\n    .append('<' + this.tagName);\n\n  this.serializeAttributes(writer);\n\n  writer.append(firstBody ? '>' : ' />');\n\n  if (firstBody) {\n\n    if (indent) {\n      writer\n        .appendNewLine()\n        .indent();\n    }\n\n    forEach(this.body, function(b) {\n      b.serializeTo(writer);\n    });\n\n    if (indent) {\n      writer\n        .unindent()\n        .appendIndent();\n    }\n\n    writer.append('</' + this.tagName + '>');\n  }\n\n  writer.appendNewLine();\n};\n\n/**\n * A serializer for types that handles serialization of data types\n */\nfunction TypeSerializer(parent, propertyDescriptor, serialization) {\n  ElementSerializer.call(this, parent, propertyDescriptor);\n\n  this.serialization = serialization;\n}\n\ninherits(TypeSerializer, ElementSerializer);\n\nTypeSerializer.prototype.parseNsAttributes = function(element) {\n\n  // extracted attributes with serialization attribute\n  // <type=typeName> stripped; it may be later\n  var attributes = ElementSerializer.prototype.parseNsAttributes.call(this, element).filter(\n    attr => attr.name !== this.serialization\n  );\n\n  var descriptor = element.$descriptor;\n\n  // only serialize <type=typeName> if necessary\n  if (descriptor.name === this.propertyDescriptor.type) {\n    return attributes;\n  }\n\n  var typeNs = this.typeNs = this.nsTagName(descriptor);\n  this.getNamespaces().logUsed(this.typeNs);\n\n  // add xsi:type attribute to represent the elements\n  // actual type\n\n  var pkg = element.$model.getPackage(typeNs.uri),\n      typePrefix = (pkg.xml && pkg.xml.typePrefix) || '';\n\n  this.addAttribute(\n    this.nsAttributeName(this.serialization),\n    (typeNs.prefix ? typeNs.prefix + ':' : '') + typePrefix + descriptor.ns.localName\n  );\n\n  return attributes;\n};\n\nTypeSerializer.prototype.isLocalNs = function(ns) {\n  return ns.uri === (this.typeNs || this.ns).uri;\n};\n\nfunction SavingWriter() {\n  this.value = '';\n\n  this.write = function(str) {\n    this.value += str;\n  };\n}\n\nfunction FormatingWriter(out, format) {\n\n  var indent = [ '' ];\n\n  this.append = function(str) {\n    out.write(str);\n\n    return this;\n  };\n\n  this.appendNewLine = function() {\n    if (format) {\n      out.write('\\n');\n    }\n\n    return this;\n  };\n\n  this.appendIndent = function() {\n    if (format) {\n      out.write(indent.join('  '));\n    }\n\n    return this;\n  };\n\n  this.indent = function() {\n    indent.push('');\n    return this;\n  };\n\n  this.unindent = function() {\n    indent.pop();\n    return this;\n  };\n}\n\n/**\n * A writer for meta-model backed document trees\n *\n * @param {Object} options output options to pass into the writer\n */\nfunction Writer(options) {\n\n  options = assign({ format: false, preamble: true }, options || {});\n\n  function toXML(tree, writer) {\n    var internalWriter = writer || new SavingWriter();\n    var formatingWriter = new FormatingWriter(internalWriter, options.format);\n\n    if (options.preamble) {\n      formatingWriter.append(XML_PREAMBLE);\n    }\n\n    var serializer = new ElementSerializer();\n\n    var model = tree.$model;\n\n    serializer.getNamespaces().mapDefaultPrefixes(getDefaultPrefixMappings(model));\n\n    serializer.build(tree).serializeTo(formatingWriter);\n\n    if (!writer) {\n      return internalWriter.value;\n    }\n  }\n\n  return {\n    toXML: toXML\n  };\n}\n\n\n// helpers ///////////\n\n/**\n * @param {Moddle} model\n *\n * @return { Record<string, string> } map from prefix to URI\n */\nfunction getDefaultPrefixMappings(model) {\n\n  const nsMap = model.config && model.config.nsMap || {};\n\n  const prefixMap = {};\n\n  // { prefix -> uri }\n  for (const prefix in DEFAULT_NS_MAP) {\n    prefixMap[prefix] = DEFAULT_NS_MAP[prefix];\n  }\n\n  // { uri -> prefix }\n  for (const uri in nsMap) {\n    const prefix = nsMap[uri];\n\n    prefixMap[prefix] = uri;\n  }\n\n  for (const pkg of model.getPackages()) {\n    prefixMap[pkg.prefix] = pkg.uri;\n  }\n\n  return prefixMap;\n}\n\nexport { Reader, Writer };\n//# sourceMappingURL=index.js.map\n","import { isString, assign } from 'min-dash';\nimport { Moddle } from 'moddle';\nimport { Reader, Writer } from 'moddle-xml';\n\n/**\n * A sub class of {@link Moddle} with support for import and export of BPMN 2.0 xml files.\n *\n * @class BpmnModdle\n * @extends Moddle\n *\n * @param {Object|Array} packages to use for instantiating the model\n * @param {Object} [options] additional options to pass over\n */\nfunction BpmnModdle(packages, options) {\n  Moddle.call(this, packages, options);\n}\n\nBpmnModdle.prototype = Object.create(Moddle.prototype);\n\n/**\n * The fromXML result.\n *\n * @typedef {Object} ParseResult\n *\n * @property {ModdleElement} rootElement\n * @property {Array<Object>} references\n * @property {Array<Error>} warnings\n * @property {Object} elementsById - a mapping containing each ID -> ModdleElement\n */\n\n/**\n * The fromXML error.\n *\n * @typedef {Error} ParseError\n *\n * @property {Array<Error>} warnings\n */\n\n/**\n * Instantiates a BPMN model tree from a given xml string.\n *\n * @param {String}   xmlStr\n * @param {String}   [typeName='bpmn:Definitions'] name of the root element\n * @param {Object}   [options]  options to pass to the underlying reader\n *\n * @returns {Promise<ParseResult, ParseError>}\n */\nBpmnModdle.prototype.fromXML = function(xmlStr, typeName, options) {\n\n  if (!isString(typeName)) {\n    options = typeName;\n    typeName = 'bpmn:Definitions';\n  }\n\n  var reader = new Reader(assign({ model: this, lax: true }, options));\n  var rootHandler = reader.handler(typeName);\n\n  return reader.fromXML(xmlStr, rootHandler);\n};\n\n\n/**\n * The toXML result.\n *\n * @typedef {Object} SerializationResult\n *\n * @property {String} xml\n */\n\n/**\n * Serializes a BPMN 2.0 object tree to XML.\n *\n * @param {String}   element    the root element, typically an instance of `bpmn:Definitions`\n * @param {Object}   [options]  to pass to the underlying writer\n *\n * @returns {Promise<SerializationResult, Error>}\n */\nBpmnModdle.prototype.toXML = function(element, options) {\n\n  var writer = new Writer(options);\n\n  return new Promise(function(resolve, reject) {\n    try {\n      var result = writer.toXML(element);\n\n      return resolve({\n        xml: result\n      });\n    } catch (err) {\n      return reject(err);\n    }\n  });\n};\n\nvar name$5 = \"BPMN20\";\nvar uri$5 = \"http://www.omg.org/spec/BPMN/20100524/MODEL\";\nvar prefix$5 = \"bpmn\";\nvar associations$5 = [\n];\nvar types$5 = [\n\t{\n\t\tname: \"Interface\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"operations\",\n\t\t\t\ttype: \"Operation\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"implementationRef\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Operation\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"inMessageRef\",\n\t\t\t\ttype: \"Message\",\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outMessageRef\",\n\t\t\t\ttype: \"Message\",\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"errorRef\",\n\t\t\t\ttype: \"Error\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"implementationRef\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"EndPoint\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"Auditing\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"GlobalTask\",\n\t\tsuperClass: [\n\t\t\t\"CallableElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"resources\",\n\t\t\t\ttype: \"ResourceRole\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Monitoring\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"Performer\",\n\t\tsuperClass: [\n\t\t\t\"ResourceRole\"\n\t\t]\n\t},\n\t{\n\t\tname: \"Process\",\n\t\tsuperClass: [\n\t\t\t\"FlowElementsContainer\",\n\t\t\t\"CallableElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"processType\",\n\t\t\t\ttype: \"ProcessType\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isClosed\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"auditing\",\n\t\t\t\ttype: \"Auditing\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"monitoring\",\n\t\t\t\ttype: \"Monitoring\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"properties\",\n\t\t\t\ttype: \"Property\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"laneSets\",\n\t\t\t\tisMany: true,\n\t\t\t\treplaces: \"FlowElementsContainer#laneSets\",\n\t\t\t\ttype: \"LaneSet\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"flowElements\",\n\t\t\t\tisMany: true,\n\t\t\t\treplaces: \"FlowElementsContainer#flowElements\",\n\t\t\t\ttype: \"FlowElement\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"artifacts\",\n\t\t\t\ttype: \"Artifact\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"resources\",\n\t\t\t\ttype: \"ResourceRole\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"correlationSubscriptions\",\n\t\t\t\ttype: \"CorrelationSubscription\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"supports\",\n\t\t\t\ttype: \"Process\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"definitionalCollaborationRef\",\n\t\t\t\ttype: \"Collaboration\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isExecutable\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"LaneSet\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"lanes\",\n\t\t\t\ttype: \"Lane\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Lane\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"partitionElementRef\",\n\t\t\t\ttype: \"BaseElement\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"partitionElement\",\n\t\t\t\ttype: \"BaseElement\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"flowNodeRef\",\n\t\t\t\ttype: \"FlowNode\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"childLaneSet\",\n\t\t\t\ttype: \"LaneSet\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"GlobalManualTask\",\n\t\tsuperClass: [\n\t\t\t\"GlobalTask\"\n\t\t]\n\t},\n\t{\n\t\tname: \"ManualTask\",\n\t\tsuperClass: [\n\t\t\t\"Task\"\n\t\t]\n\t},\n\t{\n\t\tname: \"UserTask\",\n\t\tsuperClass: [\n\t\t\t\"Task\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"renderings\",\n\t\t\t\ttype: \"Rendering\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"implementation\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Rendering\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"HumanPerformer\",\n\t\tsuperClass: [\n\t\t\t\"Performer\"\n\t\t]\n\t},\n\t{\n\t\tname: \"PotentialOwner\",\n\t\tsuperClass: [\n\t\t\t\"HumanPerformer\"\n\t\t]\n\t},\n\t{\n\t\tname: \"GlobalUserTask\",\n\t\tsuperClass: [\n\t\t\t\"GlobalTask\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"implementation\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"renderings\",\n\t\t\t\ttype: \"Rendering\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Gateway\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"FlowNode\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"gatewayDirection\",\n\t\t\t\ttype: \"GatewayDirection\",\n\t\t\t\t\"default\": \"Unspecified\",\n\t\t\t\tisAttr: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"EventBasedGateway\",\n\t\tsuperClass: [\n\t\t\t\"Gateway\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"instantiate\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"eventGatewayType\",\n\t\t\t\ttype: \"EventBasedGatewayType\",\n\t\t\t\tisAttr: true,\n\t\t\t\t\"default\": \"Exclusive\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ComplexGateway\",\n\t\tsuperClass: [\n\t\t\t\"Gateway\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"activationCondition\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"default\",\n\t\t\t\ttype: \"SequenceFlow\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ExclusiveGateway\",\n\t\tsuperClass: [\n\t\t\t\"Gateway\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"default\",\n\t\t\t\ttype: \"SequenceFlow\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"InclusiveGateway\",\n\t\tsuperClass: [\n\t\t\t\"Gateway\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"default\",\n\t\t\t\ttype: \"SequenceFlow\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ParallelGateway\",\n\t\tsuperClass: [\n\t\t\t\"Gateway\"\n\t\t]\n\t},\n\t{\n\t\tname: \"RootElement\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"Relationship\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"type\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"direction\",\n\t\t\t\ttype: \"RelationshipDirection\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"source\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true,\n\t\t\t\ttype: \"Element\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"target\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true,\n\t\t\t\ttype: \"Element\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"BaseElement\",\n\t\tisAbstract: true,\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"id\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\",\n\t\t\t\tisId: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"documentation\",\n\t\t\t\ttype: \"Documentation\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"extensionDefinitions\",\n\t\t\t\ttype: \"ExtensionDefinition\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"extensionElements\",\n\t\t\t\ttype: \"ExtensionElements\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Extension\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"mustUnderstand\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"definition\",\n\t\t\t\ttype: \"ExtensionDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ExtensionDefinition\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"extensionAttributeDefinitions\",\n\t\t\t\ttype: \"ExtensionAttributeDefinition\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ExtensionAttributeDefinition\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"type\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isReference\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"extensionDefinition\",\n\t\t\t\ttype: \"ExtensionDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ExtensionElements\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"valueRef\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true,\n\t\t\t\ttype: \"Element\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"values\",\n\t\t\t\ttype: \"Element\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"extensionAttributeDefinition\",\n\t\t\t\ttype: \"ExtensionAttributeDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Documentation\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"text\",\n\t\t\t\ttype: \"String\",\n\t\t\t\tisBody: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"textFormat\",\n\t\t\t\t\"default\": \"text/plain\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Event\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"FlowNode\",\n\t\t\t\"InteractionNode\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"properties\",\n\t\t\t\ttype: \"Property\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"IntermediateCatchEvent\",\n\t\tsuperClass: [\n\t\t\t\"CatchEvent\"\n\t\t]\n\t},\n\t{\n\t\tname: \"IntermediateThrowEvent\",\n\t\tsuperClass: [\n\t\t\t\"ThrowEvent\"\n\t\t]\n\t},\n\t{\n\t\tname: \"EndEvent\",\n\t\tsuperClass: [\n\t\t\t\"ThrowEvent\"\n\t\t]\n\t},\n\t{\n\t\tname: \"StartEvent\",\n\t\tsuperClass: [\n\t\t\t\"CatchEvent\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"isInterrupting\",\n\t\t\t\t\"default\": true,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ThrowEvent\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"Event\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"dataInputs\",\n\t\t\t\ttype: \"DataInput\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"dataInputAssociations\",\n\t\t\t\ttype: \"DataInputAssociation\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"inputSet\",\n\t\t\t\ttype: \"InputSet\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"eventDefinitions\",\n\t\t\t\ttype: \"EventDefinition\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"eventDefinitionRef\",\n\t\t\t\ttype: \"EventDefinition\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"CatchEvent\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"Event\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"parallelMultiple\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\",\n\t\t\t\t\"default\": false\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"dataOutputs\",\n\t\t\t\ttype: \"DataOutput\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"dataOutputAssociations\",\n\t\t\t\ttype: \"DataOutputAssociation\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outputSet\",\n\t\t\t\ttype: \"OutputSet\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"eventDefinitions\",\n\t\t\t\ttype: \"EventDefinition\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"eventDefinitionRef\",\n\t\t\t\ttype: \"EventDefinition\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"BoundaryEvent\",\n\t\tsuperClass: [\n\t\t\t\"CatchEvent\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"cancelActivity\",\n\t\t\t\t\"default\": true,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"attachedToRef\",\n\t\t\t\ttype: \"Activity\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"EventDefinition\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"CancelEventDefinition\",\n\t\tsuperClass: [\n\t\t\t\"EventDefinition\"\n\t\t]\n\t},\n\t{\n\t\tname: \"ErrorEventDefinition\",\n\t\tsuperClass: [\n\t\t\t\"EventDefinition\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"errorRef\",\n\t\t\t\ttype: \"Error\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"TerminateEventDefinition\",\n\t\tsuperClass: [\n\t\t\t\"EventDefinition\"\n\t\t]\n\t},\n\t{\n\t\tname: \"EscalationEventDefinition\",\n\t\tsuperClass: [\n\t\t\t\"EventDefinition\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"escalationRef\",\n\t\t\t\ttype: \"Escalation\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Escalation\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"structureRef\",\n\t\t\t\ttype: \"ItemDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"escalationCode\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t],\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"CompensateEventDefinition\",\n\t\tsuperClass: [\n\t\t\t\"EventDefinition\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"waitForCompletion\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\",\n\t\t\t\t\"default\": true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"activityRef\",\n\t\t\t\ttype: \"Activity\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"TimerEventDefinition\",\n\t\tsuperClass: [\n\t\t\t\"EventDefinition\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"timeDate\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"timeCycle\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"timeDuration\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"LinkEventDefinition\",\n\t\tsuperClass: [\n\t\t\t\"EventDefinition\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"target\",\n\t\t\t\ttype: \"LinkEventDefinition\",\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"source\",\n\t\t\t\ttype: \"LinkEventDefinition\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"MessageEventDefinition\",\n\t\tsuperClass: [\n\t\t\t\"EventDefinition\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"messageRef\",\n\t\t\t\ttype: \"Message\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"operationRef\",\n\t\t\t\ttype: \"Operation\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ConditionalEventDefinition\",\n\t\tsuperClass: [\n\t\t\t\"EventDefinition\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"condition\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"SignalEventDefinition\",\n\t\tsuperClass: [\n\t\t\t\"EventDefinition\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"signalRef\",\n\t\t\t\ttype: \"Signal\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Signal\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"structureRef\",\n\t\t\t\ttype: \"ItemDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ImplicitThrowEvent\",\n\t\tsuperClass: [\n\t\t\t\"ThrowEvent\"\n\t\t]\n\t},\n\t{\n\t\tname: \"DataState\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ItemAwareElement\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"itemSubjectRef\",\n\t\t\t\ttype: \"ItemDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"dataState\",\n\t\t\t\ttype: \"DataState\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"DataAssociation\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"sourceRef\",\n\t\t\t\ttype: \"ItemAwareElement\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"targetRef\",\n\t\t\t\ttype: \"ItemAwareElement\",\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"transformation\",\n\t\t\t\ttype: \"FormalExpression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"property\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"assignment\",\n\t\t\t\ttype: \"Assignment\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"DataInput\",\n\t\tsuperClass: [\n\t\t\t\"ItemAwareElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isCollection\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"inputSetRef\",\n\t\t\t\ttype: \"InputSet\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"inputSetWithOptional\",\n\t\t\t\ttype: \"InputSet\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"inputSetWithWhileExecuting\",\n\t\t\t\ttype: \"InputSet\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"DataOutput\",\n\t\tsuperClass: [\n\t\t\t\"ItemAwareElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isCollection\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outputSetRef\",\n\t\t\t\ttype: \"OutputSet\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outputSetWithOptional\",\n\t\t\t\ttype: \"OutputSet\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outputSetWithWhileExecuting\",\n\t\t\t\ttype: \"OutputSet\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"InputSet\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"dataInputRefs\",\n\t\t\t\ttype: \"DataInput\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"optionalInputRefs\",\n\t\t\t\ttype: \"DataInput\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"whileExecutingInputRefs\",\n\t\t\t\ttype: \"DataInput\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outputSetRefs\",\n\t\t\t\ttype: \"OutputSet\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"OutputSet\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"dataOutputRefs\",\n\t\t\t\ttype: \"DataOutput\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"inputSetRefs\",\n\t\t\t\ttype: \"InputSet\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"optionalOutputRefs\",\n\t\t\t\ttype: \"DataOutput\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"whileExecutingOutputRefs\",\n\t\t\t\ttype: \"DataOutput\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Property\",\n\t\tsuperClass: [\n\t\t\t\"ItemAwareElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"DataInputAssociation\",\n\t\tsuperClass: [\n\t\t\t\"DataAssociation\"\n\t\t]\n\t},\n\t{\n\t\tname: \"DataOutputAssociation\",\n\t\tsuperClass: [\n\t\t\t\"DataAssociation\"\n\t\t]\n\t},\n\t{\n\t\tname: \"InputOutputSpecification\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"dataInputs\",\n\t\t\t\ttype: \"DataInput\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"dataOutputs\",\n\t\t\t\ttype: \"DataOutput\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"inputSets\",\n\t\t\t\ttype: \"InputSet\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outputSets\",\n\t\t\t\ttype: \"OutputSet\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"DataObject\",\n\t\tsuperClass: [\n\t\t\t\"FlowElement\",\n\t\t\t\"ItemAwareElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"isCollection\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"InputOutputBinding\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"inputDataRef\",\n\t\t\t\ttype: \"InputSet\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outputDataRef\",\n\t\t\t\ttype: \"OutputSet\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"operationRef\",\n\t\t\t\ttype: \"Operation\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Assignment\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"from\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"to\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"DataStore\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\",\n\t\t\t\"ItemAwareElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"capacity\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Integer\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isUnlimited\",\n\t\t\t\t\"default\": true,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"DataStoreReference\",\n\t\tsuperClass: [\n\t\t\t\"ItemAwareElement\",\n\t\t\t\"FlowElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"dataStoreRef\",\n\t\t\t\ttype: \"DataStore\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"DataObjectReference\",\n\t\tsuperClass: [\n\t\t\t\"ItemAwareElement\",\n\t\t\t\"FlowElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"dataObjectRef\",\n\t\t\t\ttype: \"DataObject\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ConversationLink\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"sourceRef\",\n\t\t\t\ttype: \"InteractionNode\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"targetRef\",\n\t\t\t\ttype: \"InteractionNode\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ConversationAssociation\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"innerConversationNodeRef\",\n\t\t\t\ttype: \"ConversationNode\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outerConversationNodeRef\",\n\t\t\t\ttype: \"ConversationNode\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"CallConversation\",\n\t\tsuperClass: [\n\t\t\t\"ConversationNode\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"calledCollaborationRef\",\n\t\t\t\ttype: \"Collaboration\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"participantAssociations\",\n\t\t\t\ttype: \"ParticipantAssociation\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Conversation\",\n\t\tsuperClass: [\n\t\t\t\"ConversationNode\"\n\t\t]\n\t},\n\t{\n\t\tname: \"SubConversation\",\n\t\tsuperClass: [\n\t\t\t\"ConversationNode\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"conversationNodes\",\n\t\t\t\ttype: \"ConversationNode\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ConversationNode\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"InteractionNode\",\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"participantRef\",\n\t\t\t\ttype: \"Participant\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"messageFlowRefs\",\n\t\t\t\ttype: \"MessageFlow\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"correlationKeys\",\n\t\t\t\ttype: \"CorrelationKey\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"GlobalConversation\",\n\t\tsuperClass: [\n\t\t\t\"Collaboration\"\n\t\t]\n\t},\n\t{\n\t\tname: \"PartnerEntity\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"participantRef\",\n\t\t\t\ttype: \"Participant\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"PartnerRole\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"participantRef\",\n\t\t\t\ttype: \"Participant\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"CorrelationProperty\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"correlationPropertyRetrievalExpression\",\n\t\t\t\ttype: \"CorrelationPropertyRetrievalExpression\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"type\",\n\t\t\t\ttype: \"ItemDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Error\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"structureRef\",\n\t\t\t\ttype: \"ItemDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"errorCode\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"CorrelationKey\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"correlationPropertyRef\",\n\t\t\t\ttype: \"CorrelationProperty\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Expression\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tisAbstract: false,\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"body\",\n\t\t\t\tisBody: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"FormalExpression\",\n\t\tsuperClass: [\n\t\t\t\"Expression\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"language\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"evaluatesToTypeRef\",\n\t\t\t\ttype: \"ItemDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Message\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"itemRef\",\n\t\t\t\ttype: \"ItemDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ItemDefinition\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"itemKind\",\n\t\t\t\ttype: \"ItemKind\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"structureRef\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isCollection\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"import\",\n\t\t\t\ttype: \"Import\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"FlowElement\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"auditing\",\n\t\t\t\ttype: \"Auditing\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"monitoring\",\n\t\t\t\ttype: \"Monitoring\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"categoryValueRef\",\n\t\t\t\ttype: \"CategoryValue\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"SequenceFlow\",\n\t\tsuperClass: [\n\t\t\t\"FlowElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"isImmediate\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"conditionExpression\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"sourceRef\",\n\t\t\t\ttype: \"FlowNode\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"targetRef\",\n\t\t\t\ttype: \"FlowNode\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"FlowElementsContainer\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"laneSets\",\n\t\t\t\ttype: \"LaneSet\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"flowElements\",\n\t\t\t\ttype: \"FlowElement\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"CallableElement\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"ioSpecification\",\n\t\t\t\ttype: \"InputOutputSpecification\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"property\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"supportedInterfaceRef\",\n\t\t\t\ttype: \"Interface\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"ioBinding\",\n\t\t\t\ttype: \"InputOutputBinding\",\n\t\t\t\tisMany: true,\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"property\"\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"FlowNode\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"FlowElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"incoming\",\n\t\t\t\ttype: \"SequenceFlow\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outgoing\",\n\t\t\t\ttype: \"SequenceFlow\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"lanes\",\n\t\t\t\ttype: \"Lane\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"CorrelationPropertyRetrievalExpression\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"messagePath\",\n\t\t\t\ttype: \"FormalExpression\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"messageRef\",\n\t\t\t\ttype: \"Message\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"CorrelationPropertyBinding\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"dataPath\",\n\t\t\t\ttype: \"FormalExpression\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"correlationPropertyRef\",\n\t\t\t\ttype: \"CorrelationProperty\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Resource\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"resourceParameters\",\n\t\t\t\ttype: \"ResourceParameter\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ResourceParameter\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isRequired\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"type\",\n\t\t\t\ttype: \"ItemDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"CorrelationSubscription\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"correlationKeyRef\",\n\t\t\t\ttype: \"CorrelationKey\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"correlationPropertyBinding\",\n\t\t\t\ttype: \"CorrelationPropertyBinding\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"MessageFlow\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"sourceRef\",\n\t\t\t\ttype: \"InteractionNode\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"targetRef\",\n\t\t\t\ttype: \"InteractionNode\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"messageRef\",\n\t\t\t\ttype: \"Message\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"MessageFlowAssociation\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"innerMessageFlowRef\",\n\t\t\t\ttype: \"MessageFlow\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outerMessageFlowRef\",\n\t\t\t\ttype: \"MessageFlow\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"InteractionNode\",\n\t\tisAbstract: true,\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"incomingConversationLinks\",\n\t\t\t\ttype: \"ConversationLink\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outgoingConversationLinks\",\n\t\t\t\ttype: \"ConversationLink\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Participant\",\n\t\tsuperClass: [\n\t\t\t\"InteractionNode\",\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"interfaceRef\",\n\t\t\t\ttype: \"Interface\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"participantMultiplicity\",\n\t\t\t\ttype: \"ParticipantMultiplicity\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"endPointRefs\",\n\t\t\t\ttype: \"EndPoint\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"processRef\",\n\t\t\t\ttype: \"Process\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ParticipantAssociation\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"innerParticipantRef\",\n\t\t\t\ttype: \"Participant\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outerParticipantRef\",\n\t\t\t\ttype: \"Participant\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ParticipantMultiplicity\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"minimum\",\n\t\t\t\t\"default\": 0,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Integer\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"maximum\",\n\t\t\t\t\"default\": 1,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Integer\"\n\t\t\t}\n\t\t],\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"Collaboration\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isClosed\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"participants\",\n\t\t\t\ttype: \"Participant\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"messageFlows\",\n\t\t\t\ttype: \"MessageFlow\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"artifacts\",\n\t\t\t\ttype: \"Artifact\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"conversations\",\n\t\t\t\ttype: \"ConversationNode\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"conversationAssociations\",\n\t\t\t\ttype: \"ConversationAssociation\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"participantAssociations\",\n\t\t\t\ttype: \"ParticipantAssociation\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"messageFlowAssociations\",\n\t\t\t\ttype: \"MessageFlowAssociation\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"correlationKeys\",\n\t\t\t\ttype: \"CorrelationKey\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"choreographyRef\",\n\t\t\t\ttype: \"Choreography\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"conversationLinks\",\n\t\t\t\ttype: \"ConversationLink\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ChoreographyActivity\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"FlowNode\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"participantRef\",\n\t\t\t\ttype: \"Participant\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"initiatingParticipantRef\",\n\t\t\t\ttype: \"Participant\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"correlationKeys\",\n\t\t\t\ttype: \"CorrelationKey\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"loopType\",\n\t\t\t\ttype: \"ChoreographyLoopType\",\n\t\t\t\t\"default\": \"None\",\n\t\t\t\tisAttr: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"CallChoreography\",\n\t\tsuperClass: [\n\t\t\t\"ChoreographyActivity\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"calledChoreographyRef\",\n\t\t\t\ttype: \"Choreography\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"participantAssociations\",\n\t\t\t\ttype: \"ParticipantAssociation\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"SubChoreography\",\n\t\tsuperClass: [\n\t\t\t\"ChoreographyActivity\",\n\t\t\t\"FlowElementsContainer\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"artifacts\",\n\t\t\t\ttype: \"Artifact\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ChoreographyTask\",\n\t\tsuperClass: [\n\t\t\t\"ChoreographyActivity\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"messageFlowRef\",\n\t\t\t\ttype: \"MessageFlow\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Choreography\",\n\t\tsuperClass: [\n\t\t\t\"Collaboration\",\n\t\t\t\"FlowElementsContainer\"\n\t\t]\n\t},\n\t{\n\t\tname: \"GlobalChoreographyTask\",\n\t\tsuperClass: [\n\t\t\t\"Choreography\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"initiatingParticipantRef\",\n\t\t\t\ttype: \"Participant\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"TextAnnotation\",\n\t\tsuperClass: [\n\t\t\t\"Artifact\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"text\",\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"textFormat\",\n\t\t\t\t\"default\": \"text/plain\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Group\",\n\t\tsuperClass: [\n\t\t\t\"Artifact\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"categoryValueRef\",\n\t\t\t\ttype: \"CategoryValue\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Association\",\n\t\tsuperClass: [\n\t\t\t\"Artifact\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"associationDirection\",\n\t\t\t\ttype: \"AssociationDirection\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"sourceRef\",\n\t\t\t\ttype: \"BaseElement\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"targetRef\",\n\t\t\t\ttype: \"BaseElement\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Category\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"categoryValue\",\n\t\t\t\ttype: \"CategoryValue\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Artifact\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"CategoryValue\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"categorizedFlowElements\",\n\t\t\t\ttype: \"FlowElement\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"value\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Activity\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"FlowNode\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"isForCompensation\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"default\",\n\t\t\t\ttype: \"SequenceFlow\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"ioSpecification\",\n\t\t\t\ttype: \"InputOutputSpecification\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"property\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"boundaryEventRefs\",\n\t\t\t\ttype: \"BoundaryEvent\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"properties\",\n\t\t\t\ttype: \"Property\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"dataInputAssociations\",\n\t\t\t\ttype: \"DataInputAssociation\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"dataOutputAssociations\",\n\t\t\t\ttype: \"DataOutputAssociation\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"startQuantity\",\n\t\t\t\t\"default\": 1,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Integer\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"resources\",\n\t\t\t\ttype: \"ResourceRole\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"completionQuantity\",\n\t\t\t\t\"default\": 1,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Integer\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"loopCharacteristics\",\n\t\t\t\ttype: \"LoopCharacteristics\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ServiceTask\",\n\t\tsuperClass: [\n\t\t\t\"Task\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"implementation\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"operationRef\",\n\t\t\t\ttype: \"Operation\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"SubProcess\",\n\t\tsuperClass: [\n\t\t\t\"Activity\",\n\t\t\t\"FlowElementsContainer\",\n\t\t\t\"InteractionNode\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"triggeredByEvent\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"artifacts\",\n\t\t\t\ttype: \"Artifact\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"LoopCharacteristics\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"MultiInstanceLoopCharacteristics\",\n\t\tsuperClass: [\n\t\t\t\"LoopCharacteristics\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"isSequential\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"behavior\",\n\t\t\t\ttype: \"MultiInstanceBehavior\",\n\t\t\t\t\"default\": \"All\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"loopCardinality\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"loopDataInputRef\",\n\t\t\t\ttype: \"ItemAwareElement\",\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"loopDataOutputRef\",\n\t\t\t\ttype: \"ItemAwareElement\",\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"inputDataItem\",\n\t\t\t\ttype: \"DataInput\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"property\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outputDataItem\",\n\t\t\t\ttype: \"DataOutput\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"property\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"complexBehaviorDefinition\",\n\t\t\t\ttype: \"ComplexBehaviorDefinition\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"completionCondition\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"oneBehaviorEventRef\",\n\t\t\t\ttype: \"EventDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"noneBehaviorEventRef\",\n\t\t\t\ttype: \"EventDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"StandardLoopCharacteristics\",\n\t\tsuperClass: [\n\t\t\t\"LoopCharacteristics\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"testBefore\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"loopCondition\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"loopMaximum\",\n\t\t\t\ttype: \"Integer\",\n\t\t\t\tisAttr: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"CallActivity\",\n\t\tsuperClass: [\n\t\t\t\"Activity\",\n\t\t\t\"InteractionNode\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"calledElement\",\n\t\t\t\ttype: \"String\",\n\t\t\t\tisAttr: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Task\",\n\t\tsuperClass: [\n\t\t\t\"Activity\",\n\t\t\t\"InteractionNode\"\n\t\t]\n\t},\n\t{\n\t\tname: \"SendTask\",\n\t\tsuperClass: [\n\t\t\t\"Task\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"implementation\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"operationRef\",\n\t\t\t\ttype: \"Operation\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"messageRef\",\n\t\t\t\ttype: \"Message\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ReceiveTask\",\n\t\tsuperClass: [\n\t\t\t\"Task\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"implementation\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"instantiate\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"operationRef\",\n\t\t\t\ttype: \"Operation\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"messageRef\",\n\t\t\t\ttype: \"Message\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ScriptTask\",\n\t\tsuperClass: [\n\t\t\t\"Task\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"scriptFormat\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"script\",\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"BusinessRuleTask\",\n\t\tsuperClass: [\n\t\t\t\"Task\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"implementation\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"AdHocSubProcess\",\n\t\tsuperClass: [\n\t\t\t\"SubProcess\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"completionCondition\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"ordering\",\n\t\t\t\ttype: \"AdHocOrdering\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"cancelRemainingInstances\",\n\t\t\t\t\"default\": true,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Transaction\",\n\t\tsuperClass: [\n\t\t\t\"SubProcess\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"protocol\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"method\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"GlobalScriptTask\",\n\t\tsuperClass: [\n\t\t\t\"GlobalTask\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"scriptLanguage\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"script\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"GlobalBusinessRuleTask\",\n\t\tsuperClass: [\n\t\t\t\"GlobalTask\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"implementation\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ComplexBehaviorDefinition\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"condition\",\n\t\t\t\ttype: \"FormalExpression\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"event\",\n\t\t\t\ttype: \"ImplicitThrowEvent\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ResourceRole\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"resourceRef\",\n\t\t\t\ttype: \"Resource\",\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"resourceParameterBindings\",\n\t\t\t\ttype: \"ResourceParameterBinding\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"resourceAssignmentExpression\",\n\t\t\t\ttype: \"ResourceAssignmentExpression\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ResourceParameterBinding\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"expression\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"parameterRef\",\n\t\t\t\ttype: \"ResourceParameter\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t],\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"ResourceAssignmentExpression\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"expression\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t}\n\t\t],\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"Import\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"importType\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"location\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"namespace\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Definitions\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"targetNamespace\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"expressionLanguage\",\n\t\t\t\t\"default\": \"http://www.w3.org/1999/XPath\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"typeLanguage\",\n\t\t\t\t\"default\": \"http://www.w3.org/2001/XMLSchema\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"imports\",\n\t\t\t\ttype: \"Import\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"extensions\",\n\t\t\t\ttype: \"Extension\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"rootElements\",\n\t\t\t\ttype: \"RootElement\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"diagrams\",\n\t\t\t\tisMany: true,\n\t\t\t\ttype: \"bpmndi:BPMNDiagram\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"exporter\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"relationships\",\n\t\t\t\ttype: \"Relationship\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"exporterVersion\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t}\n];\nvar enumerations$3 = [\n\t{\n\t\tname: \"ProcessType\",\n\t\tliteralValues: [\n\t\t\t{\n\t\t\t\tname: \"None\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Public\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Private\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"GatewayDirection\",\n\t\tliteralValues: [\n\t\t\t{\n\t\t\t\tname: \"Unspecified\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Converging\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Diverging\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Mixed\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"EventBasedGatewayType\",\n\t\tliteralValues: [\n\t\t\t{\n\t\t\t\tname: \"Parallel\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Exclusive\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"RelationshipDirection\",\n\t\tliteralValues: [\n\t\t\t{\n\t\t\t\tname: \"None\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Forward\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Backward\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Both\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ItemKind\",\n\t\tliteralValues: [\n\t\t\t{\n\t\t\t\tname: \"Physical\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Information\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ChoreographyLoopType\",\n\t\tliteralValues: [\n\t\t\t{\n\t\t\t\tname: \"None\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Standard\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"MultiInstanceSequential\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"MultiInstanceParallel\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"AssociationDirection\",\n\t\tliteralValues: [\n\t\t\t{\n\t\t\t\tname: \"None\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"One\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Both\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"MultiInstanceBehavior\",\n\t\tliteralValues: [\n\t\t\t{\n\t\t\t\tname: \"None\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"One\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"All\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Complex\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"AdHocOrdering\",\n\t\tliteralValues: [\n\t\t\t{\n\t\t\t\tname: \"Parallel\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Sequential\"\n\t\t\t}\n\t\t]\n\t}\n];\nvar xml$1 = {\n\ttagAlias: \"lowerCase\",\n\ttypePrefix: \"t\"\n};\nvar BpmnPackage = {\n\tname: name$5,\n\turi: uri$5,\n\tprefix: prefix$5,\n\tassociations: associations$5,\n\ttypes: types$5,\n\tenumerations: enumerations$3,\n\txml: xml$1\n};\n\nvar name$4 = \"BPMNDI\";\nvar uri$4 = \"http://www.omg.org/spec/BPMN/20100524/DI\";\nvar prefix$4 = \"bpmndi\";\nvar types$4 = [\n\t{\n\t\tname: \"BPMNDiagram\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"plane\",\n\t\t\t\ttype: \"BPMNPlane\",\n\t\t\t\tredefines: \"di:Diagram#rootElement\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"labelStyle\",\n\t\t\t\ttype: \"BPMNLabelStyle\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t],\n\t\tsuperClass: [\n\t\t\t\"di:Diagram\"\n\t\t]\n\t},\n\t{\n\t\tname: \"BPMNPlane\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"bpmnElement\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true,\n\t\t\t\ttype: \"bpmn:BaseElement\",\n\t\t\t\tredefines: \"di:DiagramElement#modelElement\"\n\t\t\t}\n\t\t],\n\t\tsuperClass: [\n\t\t\t\"di:Plane\"\n\t\t]\n\t},\n\t{\n\t\tname: \"BPMNShape\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"bpmnElement\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true,\n\t\t\t\ttype: \"bpmn:BaseElement\",\n\t\t\t\tredefines: \"di:DiagramElement#modelElement\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isHorizontal\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isExpanded\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isMarkerVisible\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"label\",\n\t\t\t\ttype: \"BPMNLabel\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isMessageVisible\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"participantBandKind\",\n\t\t\t\ttype: \"ParticipantBandKind\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"choreographyActivityShape\",\n\t\t\t\ttype: \"BPMNShape\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t],\n\t\tsuperClass: [\n\t\t\t\"di:LabeledShape\"\n\t\t]\n\t},\n\t{\n\t\tname: \"BPMNEdge\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"label\",\n\t\t\t\ttype: \"BPMNLabel\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"bpmnElement\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true,\n\t\t\t\ttype: \"bpmn:BaseElement\",\n\t\t\t\tredefines: \"di:DiagramElement#modelElement\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"sourceElement\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true,\n\t\t\t\ttype: \"di:DiagramElement\",\n\t\t\t\tredefines: \"di:Edge#source\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"targetElement\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true,\n\t\t\t\ttype: \"di:DiagramElement\",\n\t\t\t\tredefines: \"di:Edge#target\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"messageVisibleKind\",\n\t\t\t\ttype: \"MessageVisibleKind\",\n\t\t\t\tisAttr: true,\n\t\t\t\t\"default\": \"initiating\"\n\t\t\t}\n\t\t],\n\t\tsuperClass: [\n\t\t\t\"di:LabeledEdge\"\n\t\t]\n\t},\n\t{\n\t\tname: \"BPMNLabel\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"labelStyle\",\n\t\t\t\ttype: \"BPMNLabelStyle\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true,\n\t\t\t\tredefines: \"di:DiagramElement#style\"\n\t\t\t}\n\t\t],\n\t\tsuperClass: [\n\t\t\t\"di:Label\"\n\t\t]\n\t},\n\t{\n\t\tname: \"BPMNLabelStyle\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"font\",\n\t\t\t\ttype: \"dc:Font\"\n\t\t\t}\n\t\t],\n\t\tsuperClass: [\n\t\t\t\"di:Style\"\n\t\t]\n\t}\n];\nvar enumerations$2 = [\n\t{\n\t\tname: \"ParticipantBandKind\",\n\t\tliteralValues: [\n\t\t\t{\n\t\t\t\tname: \"top_initiating\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"middle_initiating\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"bottom_initiating\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"top_non_initiating\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"middle_non_initiating\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"bottom_non_initiating\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"MessageVisibleKind\",\n\t\tliteralValues: [\n\t\t\t{\n\t\t\t\tname: \"initiating\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"non_initiating\"\n\t\t\t}\n\t\t]\n\t}\n];\nvar associations$4 = [\n];\nvar BpmnDiPackage = {\n\tname: name$4,\n\turi: uri$4,\n\tprefix: prefix$4,\n\ttypes: types$4,\n\tenumerations: enumerations$2,\n\tassociations: associations$4\n};\n\nvar name$3 = \"DC\";\nvar uri$3 = \"http://www.omg.org/spec/DD/20100524/DC\";\nvar prefix$3 = \"dc\";\nvar types$3 = [\n\t{\n\t\tname: \"Boolean\"\n\t},\n\t{\n\t\tname: \"Integer\"\n\t},\n\t{\n\t\tname: \"Real\"\n\t},\n\t{\n\t\tname: \"String\"\n\t},\n\t{\n\t\tname: \"Font\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\ttype: \"String\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"size\",\n\t\t\t\ttype: \"Real\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isBold\",\n\t\t\t\ttype: \"Boolean\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isItalic\",\n\t\t\t\ttype: \"Boolean\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isUnderline\",\n\t\t\t\ttype: \"Boolean\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isStrikeThrough\",\n\t\t\t\ttype: \"Boolean\",\n\t\t\t\tisAttr: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Point\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"x\",\n\t\t\t\ttype: \"Real\",\n\t\t\t\t\"default\": \"0\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"y\",\n\t\t\t\ttype: \"Real\",\n\t\t\t\t\"default\": \"0\",\n\t\t\t\tisAttr: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Bounds\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"x\",\n\t\t\t\ttype: \"Real\",\n\t\t\t\t\"default\": \"0\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"y\",\n\t\t\t\ttype: \"Real\",\n\t\t\t\t\"default\": \"0\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"width\",\n\t\t\t\ttype: \"Real\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"height\",\n\t\t\t\ttype: \"Real\",\n\t\t\t\tisAttr: true\n\t\t\t}\n\t\t]\n\t}\n];\nvar associations$3 = [\n];\nvar DcPackage = {\n\tname: name$3,\n\turi: uri$3,\n\tprefix: prefix$3,\n\ttypes: types$3,\n\tassociations: associations$3\n};\n\nvar name$2 = \"DI\";\nvar uri$2 = \"http://www.omg.org/spec/DD/20100524/DI\";\nvar prefix$2 = \"di\";\nvar types$2 = [\n\t{\n\t\tname: \"DiagramElement\",\n\t\tisAbstract: true,\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"id\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisId: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"extension\",\n\t\t\t\ttype: \"Extension\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"owningDiagram\",\n\t\t\t\ttype: \"Diagram\",\n\t\t\t\tisReadOnly: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"owningElement\",\n\t\t\t\ttype: \"DiagramElement\",\n\t\t\t\tisReadOnly: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"modelElement\",\n\t\t\t\tisReadOnly: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true,\n\t\t\t\ttype: \"Element\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"style\",\n\t\t\t\ttype: \"Style\",\n\t\t\t\tisReadOnly: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"ownedElement\",\n\t\t\t\ttype: \"DiagramElement\",\n\t\t\t\tisReadOnly: true,\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Node\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"DiagramElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"Edge\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"DiagramElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"source\",\n\t\t\t\ttype: \"DiagramElement\",\n\t\t\t\tisReadOnly: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"target\",\n\t\t\t\ttype: \"DiagramElement\",\n\t\t\t\tisReadOnly: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"waypoint\",\n\t\t\t\tisUnique: false,\n\t\t\t\tisMany: true,\n\t\t\t\ttype: \"dc:Point\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Diagram\",\n\t\tisAbstract: true,\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"id\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisId: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"rootElement\",\n\t\t\t\ttype: \"DiagramElement\",\n\t\t\t\tisReadOnly: true,\n\t\t\t\tisVirtual: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"documentation\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"resolution\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Real\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"ownedStyle\",\n\t\t\t\ttype: \"Style\",\n\t\t\t\tisReadOnly: true,\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Shape\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"Node\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"bounds\",\n\t\t\t\ttype: \"dc:Bounds\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Plane\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"Node\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"planeElement\",\n\t\t\t\ttype: \"DiagramElement\",\n\t\t\t\tsubsettedProperty: \"DiagramElement-ownedElement\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"LabeledEdge\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"Edge\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"ownedLabel\",\n\t\t\t\ttype: \"Label\",\n\t\t\t\tisReadOnly: true,\n\t\t\t\tsubsettedProperty: \"DiagramElement-ownedElement\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"LabeledShape\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"Shape\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"ownedLabel\",\n\t\t\t\ttype: \"Label\",\n\t\t\t\tisReadOnly: true,\n\t\t\t\tsubsettedProperty: \"DiagramElement-ownedElement\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Label\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"Node\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"bounds\",\n\t\t\t\ttype: \"dc:Bounds\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Style\",\n\t\tisAbstract: true,\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"id\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisId: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Extension\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"values\",\n\t\t\t\tisMany: true,\n\t\t\t\ttype: \"Element\"\n\t\t\t}\n\t\t]\n\t}\n];\nvar associations$2 = [\n];\nvar xml = {\n\ttagAlias: \"lowerCase\"\n};\nvar DiPackage = {\n\tname: name$2,\n\turi: uri$2,\n\tprefix: prefix$2,\n\ttypes: types$2,\n\tassociations: associations$2,\n\txml: xml\n};\n\nvar name$1 = \"bpmn.io colors for BPMN\";\nvar uri$1 = \"http://bpmn.io/schema/bpmn/biocolor/1.0\";\nvar prefix$1 = \"bioc\";\nvar types$1 = [\n\t{\n\t\tname: \"ColoredShape\",\n\t\t\"extends\": [\n\t\t\t\"bpmndi:BPMNShape\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"stroke\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"fill\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ColoredEdge\",\n\t\t\"extends\": [\n\t\t\t\"bpmndi:BPMNEdge\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"stroke\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"fill\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t}\n];\nvar enumerations$1 = [\n];\nvar associations$1 = [\n];\nvar BiocPackage = {\n\tname: name$1,\n\turi: uri$1,\n\tprefix: prefix$1,\n\ttypes: types$1,\n\tenumerations: enumerations$1,\n\tassociations: associations$1\n};\n\nvar name = \"BPMN in Color\";\nvar uri = \"http://www.omg.org/spec/BPMN/non-normative/color/1.0\";\nvar prefix = \"color\";\nvar types = [\n\t{\n\t\tname: \"ColoredLabel\",\n\t\t\"extends\": [\n\t\t\t\"bpmndi:BPMNLabel\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"color\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ColoredShape\",\n\t\t\"extends\": [\n\t\t\t\"bpmndi:BPMNShape\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"background-color\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"border-color\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ColoredEdge\",\n\t\t\"extends\": [\n\t\t\t\"bpmndi:BPMNEdge\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"border-color\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t}\n];\nvar enumerations = [\n];\nvar associations = [\n];\nvar BpmnInColorPackage = {\n\tname: name,\n\turi: uri,\n\tprefix: prefix,\n\ttypes: types,\n\tenumerations: enumerations,\n\tassociations: associations\n};\n\nconst packages = {\n  bpmn: BpmnPackage,\n  bpmndi: BpmnDiPackage,\n  dc: DcPackage,\n  di: DiPackage,\n  bioc: BiocPackage,\n  color: BpmnInColorPackage\n};\n\nfunction SimpleBpmnModdle(additionalPackages, options) {\n  const pks = assign({}, packages, additionalPackages);\n\n  return new BpmnModdle(pks, options);\n}\n\nexport { SimpleBpmnModdle as default };\n//# sourceMappingURL=index.js.map\n","/**\n * Copyright Camunda Services GmbH and/or licensed to Camunda Services GmbH\n * under one or more contributor license agreements. See the NOTICE file\n * distributed with this work for additional information regarding copyright\n * ownership.\n *\n * Camunda licenses this file to you under the MIT; you may not use this file\n * except in compliance with the MIT License.\n */\n\nimport ElementTemplates from '../../ElementTemplates';\nimport EventBus from 'diagram-js/lib/core/EventBus';\n\nimport { getPropertyValue, validateProperty } from '../../util/propertyUtil';\n\nimport { applyConditions } from '../../Condition';\n\nimport BpmnModdle from 'bpmn-moddle';\nimport { is } from 'bpmn-js/lib/util/ModelUtil';\n\nimport zeebeModdle from 'zeebe-bpmn-moddle/resources/zeebe';\n\nimport { Validator } from '../../Validator';\n\nexport default function({ templates = [] }) {\n  const moddle = new BpmnModdle({ zeebe: zeebeModdle });\n\n  const validator = new Validator(moddle).addAll(templates);\n  const validTemplates = validator.getValidTemplates();\n\n  // We use the ElementTemplates Module without the required bpmn-js modules\n  // As we only use it to facilitate template ID and version lookup,\n  // access to commandstack etc. is not required\n  const eventBus = new EventBus();\n  const elementTemplates = new ElementTemplates(null, null, eventBus, null, null);\n\n  elementTemplates.set(validTemplates);\n\n  function check(node, reporter) {\n\n    if (!is(node, 'bpmn:FlowElement')) {\n      return;\n    }\n\n    let template = elementTemplates.get(node);\n\n    const templateId = elementTemplates._getTemplateId(node);\n\n    // Handle missing template\n    if (templateId && !template) {\n      reporter.report(\n        node.id,\n        'Linked element template not found',\n        {\n          name: node.name\n        }\n      );\n      return;\n    }\n\n    if (!template) {\n      return;\n    }\n\n    template = applyConditions(node, template);\n\n    // Check attributes\n    template.properties.forEach((property) => {\n      const value = getPropertyValue(node, property);\n      const error = validateProperty(value, property);\n\n      if (!error) {\n        return;\n      }\n\n      reporter.report(\n        node.id,\n        error,\n        {\n          propertiesPanel: {\n            entryIds: [ getEntryId(property, template) ]\n          },\n          name: node.name\n        }\n      );\n    });\n  }\n\n  return {\n    check\n  };\n\n};\n\n// helpers //////////////////////\n\nfunction getEntryId(property, template) {\n  const index = template.properties\n    .filter(p => p.group === property.group)\n    .indexOf(property);\n\n  const path = [ 'custom-entry', template.id ];\n\n  if (property.group) {\n    path.push(property.group);\n  }\n\n  path.push(index);\n  return path.join('-');\n}\n","/**\n * Copyright Camunda Services GmbH and/or licensed to Camunda Services GmbH\n * under one or more contributor license agreements. See the NOTICE file\n * distributed with this work for additional information regarding copyright\n * ownership.\n *\n * Camunda licenses this file to you under the MIT; you may not use this file\n * except in compliance with the MIT License.\n */\n\nimport ElementTemplates from '../../ElementTemplates';\nimport EventBus from 'diagram-js/lib/core/EventBus';\n\nimport BpmnModdle from 'bpmn-moddle';\nimport { is } from 'bpmn-js/lib/util/ModelUtil';\n\nimport zeebeModdle from 'zeebe-bpmn-moddle/resources/zeebe';\n\nimport { Validator } from '../../Validator';\n\nexport default function({ templates = [] }) {\n  const moddle = new BpmnModdle({ zeebe: zeebeModdle });\n\n  const validator = new Validator(moddle).addAll(templates);\n  const validTemplates = validator.getValidTemplates();\n\n  // We use the ElementTemplates Module without the required bpmn-js modules\n  // As we only use it to facilitate template ID and version lookup,\n  // access to commandstack etc. is not required\n  const eventBus = new EventBus();\n  const elementTemplates = new ElementTemplates(null, null, eventBus, null, null);\n\n  elementTemplates.set(validTemplates);\n\n  function isUpdateAvailable(template) {\n\n    const latestTemplate = elementTemplates.getLatest(template.id, { deprecated: true })[0];\n\n    if (latestTemplate && latestTemplate !== template) {\n      return true;\n    }\n\n    return false;\n  }\n\n  function check(node, reporter) {\n\n    if (is(node, 'bpmn:Definitions')) {\n      elementTemplates.setEngines(getEnginesConfig(node));\n    }\n\n    if (!is(node, 'bpmn:FlowElement')) {\n      return;\n    }\n\n    let template = elementTemplates.get(node);\n\n    if (!template) {\n      return;\n    }\n\n    // Check compatibility\n    if (template.engines) {\n      const incomp = elementTemplates.getIncompatibleEngines(template);\n      Object.keys(incomp).forEach((engine) => {\n        reporter.report(\n          node.id,\n          getIncompatibilityText(engine, incomp[engine], isUpdateAvailable(template)),\n          {\n            name: node.name\n          }\n        );\n      });\n    }\n  }\n\n  return {\n    check\n  };\n\n};\n\n// helpers //////////////////////\n\nfunction getEnginesConfig(definitions) {\n  const engines = {};\n\n  const executionPlatform = definitions.get('modeler:executionPlatform');\n  const executionPlatformVersion = definitions.get('modeler:executionPlatformVersion');\n\n  if (executionPlatform === 'Camunda Cloud' && executionPlatformVersion) {\n    engines.camunda = executionPlatformVersion;\n  }\n\n  return engines;\n}\n\n\nfunction getIncompatibilityText(engine, { actual, required }, updateAvailable) {\n  const message =\n    `Element template incompatible with current <${engine}> environment. ` +\n    `Requires '${engine} ${required}'; found '${actual}'. ` +\n    `${updateAvailable ? 'Update available.' : ''}`;\n\n  return message.trim();\n}\n","/**\n * Copyright Camunda Services GmbH and/or licensed to Camunda Services GmbH\n * under one or more contributor license agreements. See the NOTICE file\n * distributed with this work for additional information regarding copyright\n * ownership.\n *\n * Camunda licenses this file to you under the MIT; you may not use this file\n * except in compliance with the MIT License.\n */\n\nimport StaticResolver from 'bpmnlint/lib/resolver/static-resolver';\n\nimport validate from './rules/element-templates-validate';\nimport compatibility from './rules/element-templates-compatibility';\n\nexport const ElementTemplateLinterPlugin = function(templates) {\n  return {\n    config: {\n      rules: {\n        'element-templates/validate': [ 'error', { templates } ],\n        'element-templates/compatibility': [ 'warn', { templates } ]\n      }\n    },\n    resolver: new StaticResolver({\n      'rule:bpmnlint-plugin-element-templates/validate': validate,\n      'rule:bpmnlint-plugin-element-templates/compatibility': compatibility\n    })\n  };\n};\n"],"names":["shouldCastToFeel","property","feel","getFeelValue","includes","type","ALWAYS_CAST_TO_FEEL","binding","toFeelExpression","value","startsWith","toString","TEMPLATE_ID_ATTR","TEMPLATE_VERSION_ATTR","TEMPLATE_ICON_ATTR","getTemplateId","element","businessObject","getBusinessObject","get","getTemplateVersion","getTemplateIcon","findExtension","extensionElements","is","find","findZeebeProperty","zeebeProperties","name","findInputParameter","ioMapping","parameters","parameter","target","findOutputParameter","source","findTaskHeader","taskHeaders","headers","header","key","findMessage","eventDefinitions","length","getDefaultValue","undefined","generatedValue","uuid","findExtensions","types","getExtensionElements","filter","isAny","findCamundaInOut","matcher","isInOut","findCamundaProperty","camundaProperties","inputOutput","scriptFormat","definition","findCamundaErrorEventDefinition","errorRef","errorEventDefinitions","error","sourceExpression","variables","local","packageVersion","process","ElementTemplates","constructor","commandStack","eventBus","modeling","injector","config","_commandStack","_eventBus","_injector","_modeling","_templatesById","_templates","_engines","_coerceEngines","engines","on","event","set","id","version","templates","isUndefined","isString","_getTemplateId","_getTemplateVersion","getDefault","getAll","template","isDefault","_getTemplateVerions","includeDeprecated","getLatest","options","latest","forEach","isCompatible","_fire","getEngines","setEngines","elementTemplates","reduce","validEngines","engine","coercedVersion","coerce","isSemverValid","console","Error","raw","Object","keys","getIncompatibleEngines","localEngines","templateEngines","result","_","has","isSemverCompatible","actual","required","includeLatestOnly","deprecated","templatesById","getVersions","versions","values","isNil","flatten","map","isObject","appliesTo","applyTemplate","newTemplate","action","payload","oldTemplate","context","execute","fire","removeTemplate","newElement","unlinkTemplate","$inject","DefaultElementTemplates","templateElementFactory","_templateElementFactory","createElement","create","SUPPORTED_SCHEMA_VERSION","getTemplateSchemaVersion","MORPHABLE_TYPES","Validator","moddle","_validTemplates","_errors","_moddle","addAll","isArray","_logError","add","err","_validateTemplate","push","schemaVersion","$schema","getSchemaVersion","semverCompare","elementTypeError","_validateElementType","schemaValidationResult","validateAgainstSchema","errors","schemaErrors","valid","filteredSchemaErrors","message","enginesError","_validateEngines","rangeStr","isSemverRangeValid","elementType","_isType","sourceType","_canMorph","baseType","moddleType","getType","getElementDescriptor","allTypesByName","targetType","getErrors","getValidTemplates","schemaUri","re","match","instancePath","keyword","SUPPORTED_SCHEMA_PACKAGE","getTemplateSchemaPackage","BaseValidator","schema","isSchemaValid","ElementTemplatesLoader","_loadTemplates","_elementTemplates","isFunction","loadTemplates","reload","_templateErrors","setTemplates","validator","validTemplates","TemplatesLoader","properties","parent","factory","$parent","nextId","prefix","ids","Ids","nextPrefixed","getRoot","filterElementsByType","objectList","list","findRootElementsByType","referencedType","root","findRootElementById","elements","createInputParameter","bpmnFactory","createOutputParameter","createTaskHeader","createTaskDefinition","attrs","createZeebeProperty","createCalledElement","shouldUpdate","optional","ensureExtension","extension","PROPERTY_TYPE","ZEBBE_PROPERTY_TYPE","ZEBBE_INPUT_TYPE","ZEEBE_OUTPUT_TYPE","ZEEBE_PROPERTY_TYPE","ZEEBE_TASK_DEFINITION_TYPE_TYPE","ZEEBE_TASK_DEFINITION","ZEEBE_TASK_HEADER_TYPE","MESSAGE_PROPERTY_TYPE","MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE","ZEEBE_CALLED_ELEMENT","ZEEBE_LINKED_RESOURCE_PROPERTY","EXTENSION_BINDING_TYPES","TASK_DEFINITION_TYPES","IO_BINDING_TYPES","MESSAGE_BINDING_TYPES","PROPERTY_BINDING_TYPES","getTaskDefinitionPropertyName","removeRootElement","rootElement","canvas","bpmnjs","getRootElement","definitions","getDefinitions","rootElements","newRootElements","e","updateModdleProperties","removeMessage","bo","getReferringElement","messageRef","ChangeElementTemplateHandler","bpmnReplace","_bpmnFactory","_bpmnReplace","preExecute","_updateZeebeModelerTemplate","_updateZeebeModelerTemplateIcon","_updateElementType","_updateProperties","_updateZeebeTaskDefinition","_updateZeebeInputOutputParameterProperties","_updateZeebeTaskHeaderProperties","_updateZeebePropertyProperties","_updateMessage","_updateCalledElement","_updateLinkedResources","_getOrCreateExtensionElements","newId","newVersion","updateProperties","newIcon","icon","newIconContents","contents","newProperties","newProperty","newBinding","newBindingType","propertiesToRemove","oldProperty","oldBinding","oldBindingType","moddleElement","findOldProperty","newBindingName","newPropertyValue","changedElement","shouldKeepValue","taskDefinition","without","propertyName","oldProperties","oldInputs","slice","oldOutputs","inputOrOutput","findBusinessObject","newInputOrOutput","remove","inputParameters","inputParameter","outputParameters","outputParameter","oldHeaders","oldHeader","newHeader","oldZeebeProperties","oldZeebeProperty","zeebeProperty","_updateMessageProperties","_updateMessageZeebeSubscriptionProperties","_updateZeebeModelerTemplateOnReferencedElement","hasMessageProperties","removedProperties","_getMessage","removedProperty","_getOrCreateMessage","messageExtensionElements","zeebeSubscription","_getSubscription","propertiesToSet","newSubscription","_createMessage","calledElement","newType","shouldUpdateElementType","replacement","eventDefinition","eventDefinitionType","replacedElement","replaceElement","newLinkedResources","linkedResources","unusedLinkedResources","unusedResourceProperties","newLinkedResource","oldLinkedResource","linkName","linkedResource","unusedResourceProperty","bindingType","input","output","oldBindingName","oldPropertyName","newPropertyName","currentValue","getPropertyValue","choices","some","choice","propertyChanged","oldPropertyValue","bindingName","bindingProperty","array","item","index","indexOf","splice","p","oldType","getEventDefinitionType","$type","RemoveElementTemplateHandler","elementFactory","elementRegistry","replace","moddleCopy","_elementFactory","_elementRegistry","_canvas","_replace","_moddleCopy","_removeTemplate","_removeRootTemplate","_getEventDefinitionType","newBusinessObject","_createNewBusinessObject","createElementsBehavior","isPlane","shapeId","getShapeIdFromPlane","shape","setRootElement","findRoot","newRoot","oldRoot","moveElements","children","x","y","newBo","label","getLabel","_copyProperties","_copyExtensionElements","categoryValueRef","setLabel","copy","propertyCopy","copyProperty","newExtensionElements","extensionElement","MultiCommandHandler","command","cmd","ElementTemplatesCommands","registerHandler","hints","applyDefaultTemplate","connection","commandContext","__init__","elementTemplateCommands","ElementTemplateCommands","PropertyBindingProvider","TaskDefinitionTypeBindingProvider","InputBindingProvider","OutputBindingProvider","TaskHeaderBindingProvider","ZeebePropertiesProvider","MessagePropertyBindingProvider","MessageZeebeSubscriptionBindingProvider","subscription","CalledElementBindingProvider","ensureNoPropagation","LinkedResourcePropertyBindingProvider","PRIMITIVE_MODDLE_TYPES","scope","rawValue","getRawPropertyValue","getBooleanPropertyValue","defaultValue","unknownBindingError","NO_OP","setPropertyValue","propertyValue","commands","propertyDescriptor","$descriptor","propertiesByName","propertyType","parseInt","isNaN","oldTaskDefinition","newTaskDefinition","oldZeebeInputParameter","newZeebeInputParameter","oldZeebeOutputParameter","newZeebeOutputParameter","oldTaskHeader","newTaskHeader","newZeebeProperty","commandsToExecute","validateProperty","translate","defaultTranslate","constraints","maxLength","minLength","notEmpty","isEmpty","isFeel","pattern","matchesPattern","trim","string","RegExp","test","replacements","applyConditions","elementTemplate","filteredProperties","isPropertyAllowed","isConditionMet","condition","allMatch","conditions","every","isSimpleConditionMet","equals","oneOf","isActive","relatedCondition","getValue","hasProperty","propertyId","isEventSubProcess","obj","prototype","hasOwnProperty","call","TemplateElementFactory","_providers","TaskDefinitionBindingProvider","_createShape","_setModelerTemplate","hasIcon","_setModelerTemplateIcon","_applyProperties","createShape","_ensureExtensionElements","processedProperties","_applyProperty","dependentProperties","findDependentProperties","_bindProperty","bindingProvider","dependentProperty","findProperyById","ConditionalBehavior","CommandInterceptor","_saveConditionalState","postExecute","_applyConditions","_ensureConditional","oldTemplateWithConditions","isMetaUpdate","newTemplateWithConditions","hasDifferentPropertyBindings","changeContext","sourceTemplate","targetTemplate","hasNewProperties","hasRemovedProperties","targetProp","sourceProp","compareProps","getMissingProperties","findPropertyWithBinding","areBindingsEqual","prop1","prop2","normalizeReplacer","sort","binding1","binding2","normalizeBinding","a","b","JSON","stringify","ReplaceBehavior","postExecuted","oldShape","oldBo","newShape","modelerTemplate","modelerTemplateVersion","shouldUnlinkEvent","allowed","UpdateTemplatePropertiesOrder","_updatePropertiesOrder","templateProperties","_updateZeebePropertiesOrder","_updateInputOrder","_updateOutputOrder","_updateTaskHeadersOrder","findIndex","propertyToFind","prop","newPropertiesOrder","sortProperties","arrayEquals","newInputOrder","newOutputOrder","newHeadersOrder","objectEquals","idx","aIndex","bIndex","ReferencedElementBehavior","_handlePropertiesUpdate","_handleReplacement","_handleRemoval","referencedRootElement","descriptor","copyElement","canHaveReferencedElement","_addMessage","isLabel","GeneratedValueBehavior","generatedProps","CalledElementBehavior","_ensureNoPropagation","elementTemplatesReplaceBehavior","elementTemplatesConditionalBehavior","elementTemplatesGeneratedValueBehavior","elementTemplatesReferencedElementBehavior","elementTemplatesUpdatePropertiesOrderBehavior","UpdatePropertiesOrderBehavior","elementTemplatesCalledElementBehavior","__depends__","commandsModule","behaviorModule","createModule","elementTemplatesLoader","getVersionOrDateFromTemplate","metadata","created","toDateString","updated","timestamp","date","Date","year","getFullYear","month","withLeadingZeros","String","getMonth","day","getDate","hours","getHours","minutes","getMinutes","leftPad","character","createElementTemplatesGroup","props","defaultGetTemplateId","ElementTemplatesGroup","entries","open","setOpen","useLayoutState","empty","toggleOpen","_jsxs","class","classnames","onClick","_jsx","title","TemplateGroupButtons","SectionToggle","entry","component","Component","_createElement","HeaderButton","ArrowIcon","useService","templateState","getTemplateState","SelectEntryTemplate","AppliedTemplate","UnknownTemplate","DeprecatedTemplate","IncompatibleTemplate","OutdatedTemplate","selectTemplate","CreateIcon","menuItems","RemoveTemplate","DropdownButton","NotFoundText","separator","newerTemplate","compatible","UpdateAvailableText","cls","text","templateVersion","DeprecationWarning","documentationRef","_Fragment","href","DocumentationIcon","width","height","viewBox","fill","xmlns","fillRule","clipRule","d","IncompatibleText","templateId","latestTemplate","TemplateProps","TemplateName","TemplateVersion","TemplateDescription","TextEntry","content","description","r","t","o","n","i","DOMParser","parseFromString","document","implementation","createHTMLDocument","style","cssText","setAttribute","body","appendChild","contentWindow","write","close","l","getElementsByTagName","s","firstChild","nodeName","toLowerCase","removeChild","lastChild","textContent","nodeValue","NODE_TYPE_TEXT","NODE_TYPE_ELEMENT","ALLOWED_NODES","ALLOWED_ATTRIBUTES","ALLOWED_URI_PATTERN","ATTR_WHITESPACE_PATTERN","FORM_ELEMENT","sanitizeHTML","html","doc","normalize","sanitizeNode","XMLSerializer","serializeToString","node","nodeType","lcTag","tagName","attributes","attribute","lcName","removeAttribute","isValidAttribute","getAttribute","childNodes","PropertyTooltip","tooltip","Markup","markup","usePropertyAccessors","directSet","useCallback","propertySetter","directGet","propertyGetter","isFeelEnabled","setIsFeelEnabled","useState","feelEnabled","handleFeelToggle","fromFeelExpression","Number","setValue","propertyValidator","groupByGroupId","groupBy","findCustomGroup","groups","g","isExternalProperty","PropertyDescription","TextAreaProperty","editable","language","placeholder","debounce","TextAreaEntry","monospace","autoResize","validate","disabled","StringProperty","TextFieldEntry","useServiceIfAvailable","service","fallback","resolved","withVariableContext","bpmnElement","setVariables","variableResolver","getVariablesForElement","useEffect","extractVariables","variable","info","origin","join","callback","off","withTooltipContainer","tooltipContainer","useMemo","propertiesPanel","feelTooltipContainer","FeelEntry","BaseFeelEntry","FeelTextAreaEntry","BaseFeelTextAreaEntry","FeelEntryWithVariableContext","FeelTextAreaEntryWithVariableContext","FeelProperty","TextFieldComponent","FeelTextAreaProperty","TextAreaComponent","DropdownProperty","getOptions","dropdownOptions","SelectEntry","BooleanProperty","FeelCheckboxEntry","CheckboxEntry","NumberProperty","FeelNumberEntry","NumberFieldEntry","isNumber","defaultValidator","CustomProperties","propertyGroups","groupedProperties","defaultProps","groupId","group","addCustomGroup","openByDefault","customPropertiesGroup","Group","shouldOpen","createCustomEntry","getDefaultType","isEdited","isFeelEntryEdited","isNumberFieldEntryEdited","isCheckboxEntryEdited","isSelectEntryEdited","isTextFieldEntryEdited","isTextAreaEntryEdited","ReferenceSelectEntry","autoFocusEntry","prevOptions","usePrevious","domQuery","focusableInput","select","getEventDefinition","eventType","isMessageSupported","getMessageEventDefinition","getMessage","messageEventDefinition","getSignalEventDefinition","EMPTY_OPTION","CREATE_NEW_OPTION","MessageProps","MessageRef","messages","filteredMessages","withoutTemplatedMessages","sortByName","ReferenceSelect","sortBy","LOWER_PRIORITY","ALWAYS_VISIBLE_GROUPS","ElementTemplatesPropertiesProvider","registerProvider","getGroups","updateMessageGroup","_shouldShowTemplateProperties","templatesGroup","addGroupsAfter","templateSpecificGroups","concat","getVisibleGroups","messageGroup","findGroup","overrideGenericEntries","oldEntries","newEntries","oldEntry","newEntry","idOrIds","groupsToAdd","Array","acc","unshift","entriesVisible","translateModule","elementTemplatesPropertiesProvider","coreModule","propertiesProviderModule","handleLegacyScopes","scopes","scopesAsArray","scopeName","assign","parameterValue","parameterDefinition","createCamundaProperty","createCamundaIn","createCamundaInOutAttrs","createCamundaInWithBusinessKey","businessKey","createCamundaOut","createCamundaExecutionListener","implementationType","script","createCamundaFieldInjection","DEFAULT_PROPS","expression","createCamundaErrorEventDefinition","errorEventDefinition","createError","bindingErrorRef","CAMUNDA_SERVICE_TASK_LIKE","_updateCamundaModelerTemplate","_updateTaskType","_updateCamundaExecutionListenerProperties","_updateCamundaFieldProperties","_updateCamundaInOutProperties","_updateCamundaInputOutputParameterProperties","_updateCamundaPropertyProperties","_updateCamundaErrorEventDefinitionProperties","newScopeTemplate","_updateScopeProperties","oldErrorEventDefinitions","oldEventDefinition","findOldBusinessObject","newError","newEventDefinition","oldExecutionListeners","newExecutionListeners","oldFields","oldField","newCamundaFieldInjection","oldInsAndOuts","oldInOurOut","newInOrOut","oldInputOrOutput","oldCamundaProperties","oldCamundaProperty","newCamundaProperty","_updateConditionExpression","conditionExpression","camundaServiceTaskLikeProperty","scopeElement","findOldScopeElement","oldScopeTemplate","findOldScopeTemplate","isRootElementScope","oldBusinessObject","newBindingRef","oldBindingRef","scopeTemplate","errorEventDefinitionBinding","findErrorEventDefinitionBinding","scopeId","templateErrorId","_createBlankBusinessObject","CAMUNDA_ERROR_EVENT_DEFINITION_TYPE","CAMUNDA_EXECUTION_LISTENER_TYPE","CAMUNDA_FIELD_TYPE","CAMUNDA_IN_BUSINESS_KEY_TYPE","CAMUNDA_IN_TYPE","CAMUNDA_INPUT_PARAMETER_TYPE","CAMUNDA_OUT_TYPE","CAMUNDA_OUTPUT_PARAMETER_TYPE","CAMUNDA_PROPERTY_TYPE","IN_OUT_BINDING_TYPES","getScopeBusinessObject","camundaFields","camundaField","camundaProperty","camundaInOut","oldCamundaErrorEventDefinition","newCamundaErrorEventDefinition","oldCamundaFields","newCamundaFields","oldCamundaInputParameter","newCamundaInputParameter","oldCamundaOutputParameter","newCamundaOutputParameter","oldCamundaInOut","newCamundaInOut","isEmptyString","ErrorProperties","errorGroup","originalItem","items","removeEntry","Expression","getErrorLabel","suffix","endsWith","errorCode","InputProperties","inputGroup","LocalVariableAssignment","Description","addInputParameter","removeInputParameter","ToggleSwitchEntry","switcherLabel","updatedBusinessObject","update","createExtensionElements","createInputOutput","SPACE_REGEX","containsSpace","OutputProperties","ProcessVariableAssignment","AssignToProcessVariable","addOutputParameter","removeOutputParameter","ALWAYS_DISPLAYED_GROUPS","createInputGroup","createOutputGroup","createErrorGroup","filterWithEntriesVisible","ListGroup","CamundaPlatformPropertiesProviderModule","Base","$model","fromCharCode","ENTITY_PATTERN","ENTITY_MAPPING","k","toUpperCase","replaceEntities","z","decodeEntities","hasLowerCaseAlias","pkg","xml","tagAlias","DEFAULT_NS_MAP","SERIALIZE_PROPERTY","getSerialization","serialize","getSerializationType","BpmnModdle","packages","Moddle","fromXML","xmlStr","typeName","reader","Reader","model","lax","rootHandler","handler","toXML","writer","Writer","Promise","resolve","reject","zeebe","zeebeModdle","EventBus","check","reporter","report","entryIds","getEntryId","path","isUpdateAvailable","getEnginesConfig","incomp","getIncompatibilityText","executionPlatform","executionPlatformVersion","camunda","updateAvailable","ElementTemplateLinterPlugin","rules","resolver","StaticResolver","compatibility"],"mappings":"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;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","x_google_ignoreList":[44,84,85,86,87]}